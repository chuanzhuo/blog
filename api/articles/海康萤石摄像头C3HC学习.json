{"title":"海康萤石摄像头C3HC学习","slug":"海康萤石摄像头C3HC学习","date":"2023-10-13T12:55:48.000Z","updated":"2023-10-15T01:59:16.946Z","comments":true,"path":"api/articles/海康萤石摄像头C3HC学习.json","excerpt":" [Figure] CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现    https://www.cnblogs.com/yier-G/p/16632842.htmlCVE-2021-36260漏洞复现    https://blog.csdn.net/qq_50854662/article/details/128700889    复现源代码：https://github.com/Cuerz/CVE-2021-36260","covers":null,"content":"<img data-src=''>\nCVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现\n    https://www.cnblogs.com/yier-G/p/16632842.html\nCVE-2021-36260漏洞复现\n    https://blog.csdn.net/qq_50854662/article/details/128700889\n    复现源代码：https://github.com/Cuerz/CVE-2021-36260\n\n <span id=\"more\"></span>\n<h1 id=\"确定摄像头所在的IP地址段\"><a href=\"#确定摄像头所在的IP地址段\" class=\"headerlink\" title=\"确定摄像头所在的IP地址段\"></a>确定摄像头所在的IP地址段</h1><p>网线连接到同一个路由器下，查看到路由器里面的DHCP客户端给摄像头分配了IP：192.168.2.218</p>\n<h1 id=\"CVE-2017-7921\"><a href=\"#CVE-2017-7921\" class=\"headerlink\" title=\"CVE-2017-7921\"></a>CVE-2017-7921</h1><p><a href=\"http://192.168.2.218/Security/users?auth=YWRtaW46MTEK\">http://192.168.2.218/Security/users?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;Security&#x2F;users</p>\n<p><a href=\"http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK\">http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK</a><br>    Access Error: 404 – Not Found<br>    Can’t locate document: &#x2F;onvif-http&#x2F;snapshot</p>\n<p><a href=\"http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;System&#x2F;configurationFile</p>\n<h1 id=\"CVE-2021-36260\"><a href=\"#CVE-2021-36260\" class=\"headerlink\" title=\"CVE-2021-36260\"></a>CVE-2021-36260</h1><p>Put result</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document Error: Not Found<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Access Error: 404 -- Not Found<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Can&#x27;t open document: /mnt/mmc01/webPage/bic/ssoService/v1/applyCT<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<p>RTSP 弱密码</p>\n<h4 id=\"主码流\"><a href=\"#主码流\" class=\"headerlink\" title=\"主码流\"></a>主码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;h264&#x2F;ch1&#x2F;main&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;MPEG-4&#x2F;ch1&#x2F;main&#x2F;av_stream</p>\n<h4 id=\"子码流\"><a href=\"#子码流\" class=\"headerlink\" title=\"子码流\"></a>子码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;mpeg4&#x2F;ch1&#x2F;sub&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;h264&#x2F;ch1&#x2F;sub&#x2F;av_stream</p>\n<h1 id=\"杂七杂八的随笔\"><a href=\"#杂七杂八的随笔\" class=\"headerlink\" title=\"杂七杂八的随笔\"></a>杂七杂八的随笔</h1><p>多个海康摄像头 桥接<br>求大佬解答：<br>当面积很大的情况下（比如多个足球场），多个网络WIFI摄像头通过互相之间的桥接的方式，串成特定的网络拓扑；然后通过某个摄像头联网（局域网）来让手机（或电脑）可以查看所有这些WIFI网络摄像头的画面（或者连接到nvr）<br>有这种方案吗？或者技术上是怎么实现的？</p>\n<p>开启设备的AP热点<br>（AP的SSID为EZVIZ_XXXXXXXXX，其中XXXXXXXXX为设备序列号；<br>AP的默认密码为EZVIZ_YYYYYY，其中YYYYYY为设备的验证码）</p>\n<p>用1接1的链接方式，将第一个摄像头（已接入WIFI互联网）的开启热点adhoc，<br>第二个摄像头链接第一个摄像头的热点，（组成小火车厢相连接的结构），通过第一个摄像头的网络连接到互联网，也开启热点Adhoc。<br>第三个摄像头链接到第二个摄像头的热点，以此类推<br>20231007 确定了方案图纸，等待拍照获取序列号和验证码<br>    - 抓包<br>    - 社会工程</p>\n<ol>\n<li>大华 DahuaLoginBypass<br>Chrome extension that uses vulnerability CVE-2021-33044 to log in to Dahua IP cameras and VTH&#x2F;VTO (video intercom) devices without authentication.</li>\n</ol>\n<p>For other device types (NVR&#x2F;DVR&#x2F;XVR, etc), there exists CVE-2021-33045 which cannot be exploited with an ordinary web browser.</p>\n<p>These vulnerabilities are likely to be fixed in firmware released after Sept 2021.<br><a href=\"https://github.com/bp2008/DahuaLoginBypass\">https://github.com/bp2008/DahuaLoginBypass</a></p>\n<ol start=\"2\">\n<li>海康威视摄像头密码找回非重置</li>\n</ol>\n<p>Hikvision IPC config preview tool<br>Requirements:</p>\n<ul>\n<li>Firmware must be 5.4.4 or lower.</li>\n<li>LAN access to camera</li>\n</ul>\n<p>Instructions</p>\n<ul>\n<li>Open the following URL in your browser:<br><a href=\"http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK</a><br>You can find out IP using SADP Tool</li>\n<li>Submit ‘configurationFile’ using the form below</li>\n</ul>\n<p><a href=\"https://github.com/WormChickenWizard/hikvision-decrypter\">https://github.com/WormChickenWizard/hikvision-decrypter</a></p>\n<p>One you obtain the configuration file, simply load it into the program, decrypt it, and save it.Then you can use a hex editor to search for the passwords. At some point, I would like to implement the ability to read and edit the database from inside of the program.</p>\n<p>Reference：<br><a href=\"https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/\">https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/</a></p>\n<p>C3HC如何查看摄像头admin密码？<br>海康C3HC, 第一次或着重置后连接，会有修改admin为新密码的步骤：修改密码<br>请将默认加密密码修改为新的加密密码，默认密码为设备验证码（6位大写字母），你可以在设备标签上找到它。<br>新密码：<br>修改后，请牢记你的新密码，若密码丢失，将不能被找回，需重置设备恢复初始值，确定要修改？</p>\n<ol start=\"3\">\n<li>思路：找海康摄像头漏洞，针对漏洞进行分析和利用<br> CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现<br>     <a href=\"https://www.cnblogs.com/yier-G/p/16632842.html\">https://www.cnblogs.com/yier-G/p/16632842.html</a><br><br> CVE-2017-7921复现（解密文件）<br>     <a href=\"https://blog.csdn.net/qq_41617034/article/details/117521734\">https://blog.csdn.net/qq_41617034/article/details/117521734</a><br><br> 海康摄像头CVE-2021-36260漏洞复现<br>     <a href=\"https://blog.csdn.net/qq_50854662/article/details/128700889\">https://blog.csdn.net/qq_50854662/article/details/128700889</a><br>     复现源代码：<a href=\"https://github.com/Cuerz/CVE-2021-36260\">https://github.com/Cuerz/CVE-2021-36260</a></li>\n</ol>\n<p>肯定能找到漏洞复现；可是我无法连接到摄像头的网络，导致无法通信的尴尬！？</p>\n<p>疑问：<br>    1. 激活摄像头以后，热点的密码就变为激活密码了吗？<br>    2. 用网线连接后，可否找到IP？<br>    3. C3HC是否有这个漏洞？可否下载configurationFile；</p>\n<p>思路2，问问个人卖家；这样专业的实践知识有时Google很难及时收录。</p>\n<p>得到确认：WIFI和AP热点模式是不可能同时开启的！<br>20231011 C3HC大概率有这两个漏洞：<br>    搜索: C3HC 固件升级; 搜索结构还在固件版本V5.3.2 build 200312</p>\n<p>如何解绑定手机号<br>    拆下flash，上编程器，修改序列号和验证码即可<br>    具体视频：9号-10号，看了视频，丢失了链接<br>    萤石云摄像头固件修改，更换SN解绑手机，解邦教程<br>    <a href=\"https://tieba.baidu.com/p/8197423399\">https://tieba.baidu.com/p/8197423399</a></p>\n<p>海康威视CVE-2017-7921的一次实战利用<br><a href=\"https://cn-sec.com/archives/1788403.html\">https://cn-sec.com/archives/1788403.html</a></p>\n","more":"<h1 id=\"确定摄像头所在的IP地址段\"><a href=\"#确定摄像头所在的IP地址段\" class=\"headerlink\" title=\"确定摄像头所在的IP地址段\"></a>确定摄像头所在的IP地址段</h1><p>网线连接到同一个路由器下，查看到路由器里面的DHCP客户端给摄像头分配了IP：192.168.2.218</p>\n<h1 id=\"CVE-2017-7921\"><a href=\"#CVE-2017-7921\" class=\"headerlink\" title=\"CVE-2017-7921\"></a>CVE-2017-7921</h1><p><a href=\"http://192.168.2.218/Security/users?auth=YWRtaW46MTEK\">http://192.168.2.218/Security/users?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;Security&#x2F;users</p>\n<p><a href=\"http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK\">http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK</a><br>    Access Error: 404 – Not Found<br>    Can’t locate document: &#x2F;onvif-http&#x2F;snapshot</p>\n<p><a href=\"http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;System&#x2F;configurationFile</p>\n<h1 id=\"CVE-2021-36260\"><a href=\"#CVE-2021-36260\" class=\"headerlink\" title=\"CVE-2021-36260\"></a>CVE-2021-36260</h1><p>Put result</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document Error: Not Found<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Access Error: 404 -- Not Found<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Can&#x27;t open document: /mnt/mmc01/webPage/bic/ssoService/v1/applyCT<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<p>RTSP 弱密码</p>\n<h4 id=\"主码流\"><a href=\"#主码流\" class=\"headerlink\" title=\"主码流\"></a>主码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;h264&#x2F;ch1&#x2F;main&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;MPEG-4&#x2F;ch1&#x2F;main&#x2F;av_stream</p>\n<h4 id=\"子码流\"><a href=\"#子码流\" class=\"headerlink\" title=\"子码流\"></a>子码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;mpeg4&#x2F;ch1&#x2F;sub&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;h264&#x2F;ch1&#x2F;sub&#x2F;av_stream</p>\n<h1 id=\"杂七杂八的随笔\"><a href=\"#杂七杂八的随笔\" class=\"headerlink\" title=\"杂七杂八的随笔\"></a>杂七杂八的随笔</h1><p>多个海康摄像头 桥接<br>求大佬解答：<br>当面积很大的情况下（比如多个足球场），多个网络WIFI摄像头通过互相之间的桥接的方式，串成特定的网络拓扑；然后通过某个摄像头联网（局域网）来让手机（或电脑）可以查看所有这些WIFI网络摄像头的画面（或者连接到nvr）<br>有这种方案吗？或者技术上是怎么实现的？</p>\n<p>开启设备的AP热点<br>（AP的SSID为EZVIZ_XXXXXXXXX，其中XXXXXXXXX为设备序列号；<br>AP的默认密码为EZVIZ_YYYYYY，其中YYYYYY为设备的验证码）</p>\n<p>用1接1的链接方式，将第一个摄像头（已接入WIFI互联网）的开启热点adhoc，<br>第二个摄像头链接第一个摄像头的热点，（组成小火车厢相连接的结构），通过第一个摄像头的网络连接到互联网，也开启热点Adhoc。<br>第三个摄像头链接到第二个摄像头的热点，以此类推<br>20231007 确定了方案图纸，等待拍照获取序列号和验证码<br>    - 抓包<br>    - 社会工程</p>\n<ol>\n<li>大华 DahuaLoginBypass<br>Chrome extension that uses vulnerability CVE-2021-33044 to log in to Dahua IP cameras and VTH&#x2F;VTO (video intercom) devices without authentication.</li>\n</ol>\n<p>For other device types (NVR&#x2F;DVR&#x2F;XVR, etc), there exists CVE-2021-33045 which cannot be exploited with an ordinary web browser.</p>\n<p>These vulnerabilities are likely to be fixed in firmware released after Sept 2021.<br><a href=\"https://github.com/bp2008/DahuaLoginBypass\">https://github.com/bp2008/DahuaLoginBypass</a></p>\n<ol start=\"2\">\n<li>海康威视摄像头密码找回非重置</li>\n</ol>\n<p>Hikvision IPC config preview tool<br>Requirements:</p>\n<ul>\n<li>Firmware must be 5.4.4 or lower.</li>\n<li>LAN access to camera</li>\n</ul>\n<p>Instructions</p>\n<ul>\n<li>Open the following URL in your browser:<br><a href=\"http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK</a><br>You can find out IP using SADP Tool</li>\n<li>Submit ‘configurationFile’ using the form below</li>\n</ul>\n<p><a href=\"https://github.com/WormChickenWizard/hikvision-decrypter\">https://github.com/WormChickenWizard/hikvision-decrypter</a></p>\n<p>One you obtain the configuration file, simply load it into the program, decrypt it, and save it.Then you can use a hex editor to search for the passwords. At some point, I would like to implement the ability to read and edit the database from inside of the program.</p>\n<p>Reference：<br><a href=\"https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/\">https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/</a></p>\n<p>C3HC如何查看摄像头admin密码？<br>海康C3HC, 第一次或着重置后连接，会有修改admin为新密码的步骤：修改密码<br>请将默认加密密码修改为新的加密密码，默认密码为设备验证码（6位大写字母），你可以在设备标签上找到它。<br>新密码：<br>修改后，请牢记你的新密码，若密码丢失，将不能被找回，需重置设备恢复初始值，确定要修改？</p>\n<ol start=\"3\">\n<li>思路：找海康摄像头漏洞，针对漏洞进行分析和利用<br> CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现<br>     <a href=\"https://www.cnblogs.com/yier-G/p/16632842.html\">https://www.cnblogs.com/yier-G/p/16632842.html</a><br><br> CVE-2017-7921复现（解密文件）<br>     <a href=\"https://blog.csdn.net/qq_41617034/article/details/117521734\">https://blog.csdn.net/qq_41617034/article/details/117521734</a><br><br> 海康摄像头CVE-2021-36260漏洞复现<br>     <a href=\"https://blog.csdn.net/qq_50854662/article/details/128700889\">https://blog.csdn.net/qq_50854662/article/details/128700889</a><br>     复现源代码：<a href=\"https://github.com/Cuerz/CVE-2021-36260\">https://github.com/Cuerz/CVE-2021-36260</a></li>\n</ol>\n<p>肯定能找到漏洞复现；可是我无法连接到摄像头的网络，导致无法通信的尴尬！？</p>\n<p>疑问：<br>    1. 激活摄像头以后，热点的密码就变为激活密码了吗？<br>    2. 用网线连接后，可否找到IP？<br>    3. C3HC是否有这个漏洞？可否下载configurationFile；</p>\n<p>思路2，问问个人卖家；这样专业的实践知识有时Google很难及时收录。</p>\n<p>得到确认：WIFI和AP热点模式是不可能同时开启的！<br>20231011 C3HC大概率有这两个漏洞：<br>    搜索: C3HC 固件升级; 搜索结构还在固件版本V5.3.2 build 200312</p>\n<p>如何解绑定手机号<br>    拆下flash，上编程器，修改序列号和验证码即可<br>    具体视频：9号-10号，看了视频，丢失了链接<br>    萤石云摄像头固件修改，更换SN解绑手机，解邦教程<br>    <a href=\"https://tieba.baidu.com/p/8197423399\">https://tieba.baidu.com/p/8197423399</a></p>\n<p>海康威视CVE-2017-7921的一次实战利用<br><a href=\"https://cn-sec.com/archives/1788403.html\">https://cn-sec.com/archives/1788403.html</a></p>","categories":[{"name":"摄像头","path":"api/categories/摄像头.json"}],"tags":[{"name":"摄像头","path":"api/tags/摄像头.json"}]}