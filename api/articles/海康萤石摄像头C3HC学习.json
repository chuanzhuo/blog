{"title":"海康萤石摄像头C3HC学习","slug":"海康萤石摄像头C3HC学习","date":"2023-10-13T12:55:48.000Z","updated":"2025-08-14T13:37:45.620Z","comments":true,"path":"api/articles/海康萤石摄像头C3HC学习.json","excerpt":"网络摄像头从硬件到软件     [20240619翻车救护中, 25q八针脚的芯片被廉价编程器硬件弄伤两只脚后又被在我焊到主板的过程中彻底弄断，飞线失败，放弃救助该芯片；采购同信号芯片替换中…]","covers":["https://img.carlzeng.com:3/i/2024/06/11/6667aaea75943.png","https://img.carlzeng.com:3/i/2024/06/12/6668e2957b0b1.png","https://img.carlzeng.com:3/i/2024/06/12/6668e4a727364.png","https://img.carlzeng.com:3/i/2024/06/12/6668e61be6b20.png","https://img.carlzeng.com:3/i/2024/06/12/6668e6ff1f474.png","https://img.carlzeng.com:3/i/2024/06/12/6668e8ccdcc1b.png","https://img.carlzeng.com:3/i/2024/06/12/6669135d8ce1e.png","https://img.carlzeng.com:3/i/2024/06/12/6669605a26ffa.png","https://img.carlzeng.com:3/i/2024/06/12/66691df4cfb4e.png","https://img.carlzeng.com:3/i/2024/06/13/666adcd9ed26a.png","https://img.carlzeng.com:3/i/2025/08/13/689bf9f595d68.jpg","https://img.carlzeng.com:3/i/2025/08/13/689bfa2c05dac.jpg","https://img.carlzeng.com:3/i/2025/08/13/689bfa17dede6.jpg","https://img.carlzeng.com:3/i/2025/08/13/689bfa9205b10.png","https://img.carlzeng.com:3/i/2025/08/14/689da388021e3.png"],"content":"<p>网络摄像头从硬件到软件     [20240619翻车救护中, 25q八针脚的芯片被廉价编程器硬件弄伤两只脚后又被在我焊到主板的过程中彻底弄断，飞线失败，放弃救助该芯片；采购同信号芯片替换中…]</p>\n <span id=\"more\"></span>\n\n<p>2024年6月11 新增章节：<a href=\"#Flash%E8%8A%AF%E7%89%87%E9%97%AA%E5%AD%98%E5%86%85%E5%AE%B9%E7%BC%96%E8%BE%91\">Flash芯片闪存内容编辑</a></p>\n<p>CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现<br>    <a href=\"https://www.cnblogs.com/yier-G/p/16632842.html\">https://www.cnblogs.com/yier-G/p/16632842.html</a><br>CVE-2021-36260漏洞复现<br>    <a href=\"https://blog.csdn.net/qq_50854662/article/details/128700889\">https://blog.csdn.net/qq_50854662/article/details/128700889</a><br>    复现源代码：<a href=\"https://github.com/Cuerz/CVE-2021-36260\">https://github.com/Cuerz/CVE-2021-36260</a></p>\n<h1 id=\"确定摄像头所在的IP地址段\"><a href=\"#确定摄像头所在的IP地址段\" class=\"headerlink\" title=\"确定摄像头所在的IP地址段\"></a>确定摄像头所在的IP地址段</h1><p>网线连接到同一个路由器下，查看到路由器里面的DHCP客户端给摄像头分配了IP：192.168.2.218</p>\n<h1 id=\"CVE-2017-7921\"><a href=\"#CVE-2017-7921\" class=\"headerlink\" title=\"CVE-2017-7921\"></a>CVE-2017-7921</h1><p><a href=\"http://192.168.2.218/Security/users?auth=YWRtaW46MTEK\">http://192.168.2.218/Security/users?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;Security&#x2F;users</p>\n<p><a href=\"http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK\">http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK</a><br>    Access Error: 404 – Not Found<br>    Can’t locate document: &#x2F;onvif-http&#x2F;snapshot</p>\n<p><a href=\"http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;System&#x2F;configurationFile</p>\n<h1 id=\"CVE-2021-36260\"><a href=\"#CVE-2021-36260\" class=\"headerlink\" title=\"CVE-2021-36260\"></a>CVE-2021-36260</h1><p>Put result</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document Error: Not Found<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Access Error: 404 -- Not Found<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Can&#x27;t open document: /mnt/mmc01/webPage/bic/ssoService/v1/applyCT<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<p>RTSP 弱密码</p>\n<h4 id=\"主码流\"><a href=\"#主码流\" class=\"headerlink\" title=\"主码流\"></a>主码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;h264&#x2F;ch1&#x2F;main&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;MPEG-4&#x2F;ch1&#x2F;main&#x2F;av_stream</p>\n<h4 id=\"子码流\"><a href=\"#子码流\" class=\"headerlink\" title=\"子码流\"></a>子码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;mpeg4&#x2F;ch1&#x2F;sub&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;h264&#x2F;ch1&#x2F;sub&#x2F;av_stream</p>\n<h1 id=\"杂七杂八的随笔\"><a href=\"#杂七杂八的随笔\" class=\"headerlink\" title=\"杂七杂八的随笔\"></a>杂七杂八的随笔</h1><p>多个海康摄像头 桥接<br>求大佬解答：<br>当面积很大的情况下（比如多个足球场），多个网络WIFI摄像头通过互相之间的桥接的方式，串成特定的网络拓扑；然后通过某个摄像头联网（局域网）来让手机（或电脑）可以查看所有这些WIFI网络摄像头的画面（或者连接到nvr）<br>有这种方案吗？或者技术上是怎么实现的？</p>\n<p>开启设备的AP热点<br>（AP的SSID为EZVIZ_XXXXXXXXX，其中XXXXXXXXX为设备序列号；<br>AP的默认密码为EZVIZ_YYYYYY，其中YYYYYY为设备的验证码）</p>\n<p>用1接1的链接方式，将第一个摄像头（已接入WIFI互联网）的开启热点adhoc，<br>第二个摄像头链接第一个摄像头的热点，（组成小火车厢相连接的结构），通过第一个摄像头的网络连接到互联网，也开启热点Adhoc。<br>第三个摄像头链接到第二个摄像头的热点，以此类推<br>20231007 确定了方案图纸，等待拍照获取序列号和验证码<br>    - 抓包<br>    - 社会工程</p>\n<ol>\n<li>大华 DahuaLoginBypass<br>Chrome extension that uses vulnerability CVE-2021-33044 to log in to Dahua IP cameras and VTH&#x2F;VTO (video intercom) devices without authentication.</li>\n</ol>\n<p>For other device types (NVR&#x2F;DVR&#x2F;XVR, etc), there exists CVE-2021-33045 which cannot be exploited with an ordinary web browser.</p>\n<p>These vulnerabilities are likely to be fixed in firmware released after Sept 2021.<br><a href=\"https://github.com/bp2008/DahuaLoginBypass\">https://github.com/bp2008/DahuaLoginBypass</a></p>\n<ol start=\"2\">\n<li>海康威视摄像头密码找回非重置</li>\n</ol>\n<p>Hikvision IPC config preview tool<br>Requirements:</p>\n<ul>\n<li>Firmware must be 5.4.4 or lower.</li>\n<li>LAN access to camera</li>\n</ul>\n<p>Instructions</p>\n<ul>\n<li>Open the following URL in your browser:<br><a href=\"http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK</a><br>You can find out IP using SADP Tool</li>\n<li>Submit ‘configurationFile’ using the form below</li>\n</ul>\n<p><a href=\"https://github.com/WormChickenWizard/hikvision-decrypter\">https://github.com/WormChickenWizard/hikvision-decrypter</a></p>\n<p>One you obtain the configuration file, simply load it into the program, decrypt it, and save it.Then you can use a hex editor to search for the passwords. At some point, I would like to implement the ability to read and edit the database from inside of the program.</p>\n<p>Reference：<br><a href=\"https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/\">https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/</a></p>\n<p>C3HC如何查看摄像头admin密码？<br>海康C3HC, 第一次或着重置后连接，会有修改admin为新密码的步骤：修改密码<br>请将默认加密密码修改为新的加密密码，默认密码为设备验证码（6位大写字母），你可以在设备标签上找到它。<br>新密码：<br>修改后，请牢记你的新密码，若密码丢失，将不能被找回，需重置设备恢复初始值，确定要修改？</p>\n<ol start=\"3\">\n<li>思路：找海康摄像头漏洞，针对漏洞进行分析和利用<br> CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现<br>     <a href=\"https://www.cnblogs.com/yier-G/p/16632842.html\">https://www.cnblogs.com/yier-G/p/16632842.html</a><br><br> CVE-2017-7921复现（解密文件）<br>     <a href=\"https://blog.csdn.net/qq_41617034/article/details/117521734\">https://blog.csdn.net/qq_41617034/article/details/117521734</a><br><br> 海康摄像头CVE-2021-36260漏洞复现<br>     <a href=\"https://blog.csdn.net/qq_50854662/article/details/128700889\">https://blog.csdn.net/qq_50854662/article/details/128700889</a><br>     复现源代码：<a href=\"https://github.com/Cuerz/CVE-2021-36260\">https://github.com/Cuerz/CVE-2021-36260</a></li>\n</ol>\n<p>肯定能找到漏洞复现；可是我无法连接到摄像头的网络，导致无法通信的尴尬！？</p>\n<p>疑问：<br>    1. 激活摄像头以后，热点的密码就变为激活密码了吗？<br>        2. 用网线连接后，可否找到IP？<br>        3. C3HC是否有这个漏洞？可否下载configurationFile；</p>\n<p>思路2，问问个人卖家；这样专业的实践知识有时Google很难及时收录。</p>\n<p>得到确认：WIFI和AP热点模式是不可能同时开启的！<br>20231011 C3HC大概率有这两个漏洞：<br>    搜索: C3HC 固件升级; 搜索结构还在固件版本V5.3.2 build 200312</p>\n<p>如何解绑定手机号<br>    拆下flash，上编程器，修改序列号和验证码即可<br>    具体视频：9号-10号，看了视频，丢失了链接<br>    萤石云摄像头固件修改，更换SN解绑手机，解邦教程<br>    <a href=\"https://tieba.baidu.com/p/8197423399\">https://tieba.baidu.com/p/8197423399</a></p>\n<p>海康威视CVE-2017-7921的一次实战利用<br><a href=\"https://cn-sec.com/archives/1788403.html\">https://cn-sec.com/archives/1788403.html</a></p>\n<h1 id=\"Flash芯片闪存内容编辑\"><a href=\"#Flash芯片闪存内容编辑\" class=\"headerlink\" title=\"Flash芯片闪存内容编辑\"></a>Flash芯片闪存内容编辑</h1><p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/11/6667aaea75943.png\" alt=\"image-20240611093951945\"></p>\n<ol>\n<li><p>把flash芯片（型号 XMC 250H128CH10）取下来，上编程器（使用了CH341A编程器），读取到flash芯片中的固件文件</p>\n<ol>\n<li>在此之前涉及到简易编程器采购，从拆解的摄像头主板上焊下flash芯片，芯片圆点位置（正极）对应烧录座的1号针脚，</li>\n<li>以及2425_CH341A土豪金24&#x2F;25编程器软件的驱动安装等；具体步骤搜索本站文章：PVE安装Windows7 》 运行CH341A编程器</li>\n</ol>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e2957b0b1.png\" alt=\"image-20240612074934788\"></p>\n</li>\n<li><p><a href=\"https://hexed.it/\">Hex Edit在线打开</a>提取到的二进制bin文件，进一步编辑序列号和验证码</p>\n<ol>\n<li><p>查找到三处序列号（一共9位ascii码字母数字组合，i.e. J1772）</p>\n<p>位置：00060040，00F40DC0，00FB0F20</p>\n<ol>\n<li>Note：该Bin文件中的这些序列号是转化为十六进制格式的ASCII码来保存的</li>\n</ol>\n</li>\n<li><p>查找到一处验证码（一共6位ascii码大写字母, i.e. UXT***）</p>\n<p>位置：00060010</p>\n</li>\n<li><p>修改到同型号全新的或拆机的序列号后保持导出，准备写入到flash芯片中</p>\n</li>\n</ol>\n</li>\n<li><p>把新的bin文件，通过编程器写入到flash芯片中</p>\n<ol>\n<li>加载新的bin文件后，点击”自动”；先是现实：正在擦除中…</li>\n<li>自动跳转到：正在编程中…</li>\n<li>如果正确识别到芯片的情况，自动操作时出现超时 错误等，可以尝试手动操作，如:擦除—查空—编程—效验，一步步操作解决</li>\n</ol>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e4a727364.png\" alt=\"image-20240612075825125\"></p>\n<p>擦除—查空—编程—效验：  擦除成功提示如下：</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e61be6b20.png\" alt=\"image-20240612080437829\"></p>\n<p>查空成功提示如下：</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e6ff1f474.png\" alt=\"image-20240612080825294\"></p>\n<p>编程超时错误提示如下：</p>\n<p>这时在写入到10%（花费2分45秒左右）时提示超时失败</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e8ccdcc1b.png\" alt=\"image-20240612081607165\"></p>\n<p>不管换了两台机器（Win7虚拟机 和Win10的PC机），移除或使用USB延长线，只要用这个软件：“CH341A编程器”都会在写入过程中报超时错误</p>\n<p>最后花了3小时，才验证出这样的经验。切换到Neo Programmer 2.2.10 (2021&#x2F;10&#x2F;15)版本可以正常写入！</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6669135d8ce1e.png\" alt=\"image-20240612111744193\"></p>\n<p>编程成功提示如下：</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6669605a26ffa.png\" alt=\"image-20240612164615621\"></p>\n</li>\n<li><p>焊接安装XMC25Q128闪存芯片到摄像头的主板上。</p>\n</li>\n<li><p>开机测试，萤石APP绑定新账号</p>\n</li>\n</ol>\n<p>NeoProgrammer V2.2.0.10</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/66691df4cfb4e.png\" alt=\"image-20240612120258664\"></p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/13/666adcd9ed26a.png\" alt=\"image-20240613194943391\"></p>\n<p>![image-20240613204904232](&#x2F;Users&#x2F;carlzeng&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20240613204904232.png)</p>\n<h1 id=\"Ingram\"><a href=\"#Ingram\" class=\"headerlink\" title=\"Ingram\"></a>Ingram</h1><p>网络摄像头漏洞扫描工具 | Webcam vulnerability scanning tool</p>\n<p>项目地址: <a href=\"https://github.com/jorhelp/Ingram/tree/master\">https://github.com/jorhelp/Ingram/tree/master</a></p>\n<p>主要针对网络摄像头的漏洞扫描框架，目前已集成海康、大华、宇视、dlink等常见设备</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p><strong>请在 Linux 或 Mac 系统使用，确保安装了3.8及以上版本的Python，尽量不要使用3.11，因为对许多包的兼容不是很好</strong></p>\n<ul>\n<li>克隆该仓库:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/jorhelp/Ingram.git</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>进入项目目录，创建一个虚拟环境，并激活该环境：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd Ingram</span><br><span class=\"line\">pip3 install virtualenv</span><br><span class=\"line\">python3 -m virtualenv venv</span><br><span class=\"line\">source venv/bin/activate</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>安装依赖:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip3 install -r requirements.txt</span><br></pre></td></tr></table></figure>\n\n<p>至此安装完毕！</p>\n<h2 id=\"运行\"><a href=\"#运行\" class=\"headerlink\" title=\"运行\"></a>运行</h2><ul>\n<li>由于是在虚拟环境中配置，所以，每次运行之前，请先激活虚拟环境：<code>source venv/bin/activate</code></li>\n<li>你需要准备一个目标文件，比如 targets.txt，里面保存着你要扫描的 IP 地址，每行一个目标，具体格式如下：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 你可以使用井号(#)来进行注释</span><br><span class=\"line\"></span><br><span class=\"line\"># 单个的 IP 地址</span><br><span class=\"line\">192.168.0.1</span><br><span class=\"line\"></span><br><span class=\"line\"># IP 地址以及要扫描的端口</span><br><span class=\"line\">192.168.0.2:80</span><br><span class=\"line\"></span><br><span class=\"line\"># 带 &#x27;/&#x27; 的IP段</span><br><span class=\"line\">192.168.0.0/16</span><br><span class=\"line\"></span><br><span class=\"line\"># 带 &#x27;-&#x27; 的IP段</span><br><span class=\"line\">192.168.0.0-192.168.255.255</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>有了目标文件之后就可直接运行:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 run_ingram.py -i 你要扫描的文件 -o 输出文件夹</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>端口： 如果target.txt文件中指定了目标的端口，比如: 192.168.6.6:8000，那么会扫描该目标的8000端口</li>\n</ul>\n<p>否则的话，默认只扫描常见端口(定义在 <code>Ingram/config.py</code> 中)，若要批量扫描其他端口，需自行指定，例如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 run_ingram.py -i 你要扫描的文件 -o 输出文件夹 -p 80 81 8000</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>默认并发数目为 300，可以根据机器配置及网速通过 <code>-t</code> 参数来自行调控：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 run_ingram.py -i 你要扫描的文件 -o 输出文件夹 -t 500</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>支持中断恢复，不过并不会实时记录当前运行状态，而是间隔一定时间，所以并不能准确恢复到上次的运行状态。如果扫描因为网络或异常而中断，可以通过重复执行上次的扫描命令来继续扫描</li>\n<li>所有参数：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">optional arguments:</span><br><span class=\"line\">  -h, --help            show this help message and exit</span><br><span class=\"line\">  -i IN_FILE, --in_file IN_FILE</span><br><span class=\"line\">                        the targets will be scan</span><br><span class=\"line\">  -o OUT_DIR, --out_dir OUT_DIR</span><br><span class=\"line\">                        the dir where results will be saved</span><br><span class=\"line\">  -p PORTS [PORTS ...], --ports PORTS [PORTS ...]</span><br><span class=\"line\">                        the port(s) to detect</span><br><span class=\"line\">  -t TH_NUM, --th_num TH_NUM</span><br><span class=\"line\">                        the processes num</span><br><span class=\"line\">  -T TIMEOUT, --timeout TIMEOUT</span><br><span class=\"line\">                        requests timeout</span><br><span class=\"line\">  -D, --disable_snapshot</span><br><span class=\"line\">                        disable snapshot</span><br><span class=\"line\">  --debug</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"端口扫描器\"><a href=\"#端口扫描器\" class=\"headerlink\" title=\"端口扫描器\"></a>端口扫描器</h2><ul>\n<li>我们可以利用强大的端口扫描器来获取活动主机，进而缩小 Ingram 的扫描范围，提高运行速度，具体做法是将端口扫描器的结果文件整理成 <code>ip:port</code> 的格式，并作为 Ingram 的输入</li>\n<li>这里以 masscan 为例简单演示一下（masscan 的详细用法这里不再赘述），首先用 masscan 扫描 80 或 8000-8008 端口存活的主机：<code>masscan -p80,8000-8008 -iL 目标文件 -oL 结果文件 --rate 8000</code></li>\n<li>masscan 运行完之后，将结果文件整理一下：<code>grep &#39;open&#39; 结果文件 | awk &#39;&#123;printf&quot;%s:%s\\n&quot;, $4, $3&#125;&#39; &gt; targets.txt</code></li>\n<li>之后对这些主机进行扫描：<code>python run_ingram.py -i targets.txt -o out</code></li>\n</ul>\n<h2 id=\"实测\"><a href=\"#实测\" class=\"headerlink\" title=\"实测\"></a>实测</h2><p>扫描测试ip段有发现摄像头: </p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bf9f595d68.jpg\" alt=\"1201755007382_.pic\"></p>\n<p>运行:</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bfa2c05dac.jpg\" alt=\"591755004786_.pic\"></p>\n<p>操作运行步骤: </p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bfa17dede6.jpg\" alt=\"671755005220_.pic\"></p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bfa9205b10.png\" alt=\"image-20250813103808493\"></p>\n<h2 id=\"配置Ingram字典文件\"><a href=\"#配置Ingram字典文件\" class=\"headerlink\" title=\"配置Ingram字典文件\"></a>配置Ingram字典文件</h2><p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/14/689da388021e3.png\" alt=\"image-20250814165117197\"></p>\n<h1 id=\"海康摄像头通过Web插件进行预览播放和控制\"><a href=\"#海康摄像头通过Web插件进行预览播放和控制\" class=\"headerlink\" title=\"海康摄像头通过Web插件进行预览播放和控制\"></a>海康摄像头通过Web插件进行预览播放和控制</h1><p>必需使用<strong>IE浏览器</strong>; 安装插件后, 才能查看实时的海康摄像头或DVR画面;</p>\n<p>插件文件名: WebComponents.exe</p>\n<p>大小: 1.78MB</p>\n<p>可能不同的固件使用不同的版本, 搜索官网上是</p>\n<p>WebComponentsDownload<br>V3.0.8.23 |4.55MB |2023&#x2F;02&#x2F;08</p>\n<p><a href=\"https://www.hikvision.com/en/support/tools/hitools/cl07322df9f57a1ee1/\">https://www.hikvision.com/en/support/tools/hitools/cl07322df9f57a1ee1/</a></p>\n<p>平台还有其他的工具 如:</p>\n<p>VSPlayer_mac64Download</p>\n<p>V2.0.2.3 |38.75MB |2025&#x2F;01&#x2F;03</p>\n<p>VSPlayer plays the streams or recordings from Hikvision encoding devices in various formats, including H.264, Smart264, H.265, Smart265, SVAC, and MPEG4.</p>\n","more":"<p>2024年6月11 新增章节：<a href=\"#Flash%E8%8A%AF%E7%89%87%E9%97%AA%E5%AD%98%E5%86%85%E5%AE%B9%E7%BC%96%E8%BE%91\">Flash芯片闪存内容编辑</a></p>\n<p>CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现<br>    <a href=\"https://www.cnblogs.com/yier-G/p/16632842.html\">https://www.cnblogs.com/yier-G/p/16632842.html</a><br>CVE-2021-36260漏洞复现<br>    <a href=\"https://blog.csdn.net/qq_50854662/article/details/128700889\">https://blog.csdn.net/qq_50854662/article/details/128700889</a><br>    复现源代码：<a href=\"https://github.com/Cuerz/CVE-2021-36260\">https://github.com/Cuerz/CVE-2021-36260</a></p>\n<h1 id=\"确定摄像头所在的IP地址段\"><a href=\"#确定摄像头所在的IP地址段\" class=\"headerlink\" title=\"确定摄像头所在的IP地址段\"></a>确定摄像头所在的IP地址段</h1><p>网线连接到同一个路由器下，查看到路由器里面的DHCP客户端给摄像头分配了IP：192.168.2.218</p>\n<h1 id=\"CVE-2017-7921\"><a href=\"#CVE-2017-7921\" class=\"headerlink\" title=\"CVE-2017-7921\"></a>CVE-2017-7921</h1><p><a href=\"http://192.168.2.218/Security/users?auth=YWRtaW46MTEK\">http://192.168.2.218/Security/users?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;Security&#x2F;users</p>\n<p><a href=\"http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK\">http://192.168.2.218/onvif-http/snapshot?auth=YWRtaW46MTEK</a><br>    Access Error: 404 – Not Found<br>    Can’t locate document: &#x2F;onvif-http&#x2F;snapshot</p>\n<p><a href=\"http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.2.218/System/configurationFile?auth=YWRtaW46MTEK</a><br>    Access Error: 405 – Method Not Allowed<br>    Requested method GET not supported for URL: &#x2F;System&#x2F;configurationFile</p>\n<h1 id=\"CVE-2021-36260\"><a href=\"#CVE-2021-36260\" class=\"headerlink\" title=\"CVE-2021-36260\"></a>CVE-2021-36260</h1><p>Put result</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document Error: Not Found<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Access Error: 404 -- Not Found<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Can&#x27;t open document: /mnt/mmc01/webPage/bic/ssoService/v1/applyCT<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<p>RTSP 弱密码</p>\n<h4 id=\"主码流\"><a href=\"#主码流\" class=\"headerlink\" title=\"主码流\"></a>主码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;h264&#x2F;ch1&#x2F;main&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP:554&#x2F;MPEG-4&#x2F;ch1&#x2F;main&#x2F;av_stream</p>\n<h4 id=\"子码流\"><a href=\"#子码流\" class=\"headerlink\" title=\"子码流\"></a>子码流</h4><p>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;mpeg4&#x2F;ch1&#x2F;sub&#x2F;av_stream<br>rtsp:&#x2F;&#x2F;admin:12345@IP&#x2F;h264&#x2F;ch1&#x2F;sub&#x2F;av_stream</p>\n<h1 id=\"杂七杂八的随笔\"><a href=\"#杂七杂八的随笔\" class=\"headerlink\" title=\"杂七杂八的随笔\"></a>杂七杂八的随笔</h1><p>多个海康摄像头 桥接<br>求大佬解答：<br>当面积很大的情况下（比如多个足球场），多个网络WIFI摄像头通过互相之间的桥接的方式，串成特定的网络拓扑；然后通过某个摄像头联网（局域网）来让手机（或电脑）可以查看所有这些WIFI网络摄像头的画面（或者连接到nvr）<br>有这种方案吗？或者技术上是怎么实现的？</p>\n<p>开启设备的AP热点<br>（AP的SSID为EZVIZ_XXXXXXXXX，其中XXXXXXXXX为设备序列号；<br>AP的默认密码为EZVIZ_YYYYYY，其中YYYYYY为设备的验证码）</p>\n<p>用1接1的链接方式，将第一个摄像头（已接入WIFI互联网）的开启热点adhoc，<br>第二个摄像头链接第一个摄像头的热点，（组成小火车厢相连接的结构），通过第一个摄像头的网络连接到互联网，也开启热点Adhoc。<br>第三个摄像头链接到第二个摄像头的热点，以此类推<br>20231007 确定了方案图纸，等待拍照获取序列号和验证码<br>    - 抓包<br>    - 社会工程</p>\n<ol>\n<li>大华 DahuaLoginBypass<br>Chrome extension that uses vulnerability CVE-2021-33044 to log in to Dahua IP cameras and VTH&#x2F;VTO (video intercom) devices without authentication.</li>\n</ol>\n<p>For other device types (NVR&#x2F;DVR&#x2F;XVR, etc), there exists CVE-2021-33045 which cannot be exploited with an ordinary web browser.</p>\n<p>These vulnerabilities are likely to be fixed in firmware released after Sept 2021.<br><a href=\"https://github.com/bp2008/DahuaLoginBypass\">https://github.com/bp2008/DahuaLoginBypass</a></p>\n<ol start=\"2\">\n<li>海康威视摄像头密码找回非重置</li>\n</ol>\n<p>Hikvision IPC config preview tool<br>Requirements:</p>\n<ul>\n<li>Firmware must be 5.4.4 or lower.</li>\n<li>LAN access to camera</li>\n</ul>\n<p>Instructions</p>\n<ul>\n<li>Open the following URL in your browser:<br><a href=\"http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK\">http://192.168.0.64/System/configurationFile?auth=YWRtaW46MTEK</a><br>You can find out IP using SADP Tool</li>\n<li>Submit ‘configurationFile’ using the form below</li>\n</ul>\n<p><a href=\"https://github.com/WormChickenWizard/hikvision-decrypter\">https://github.com/WormChickenWizard/hikvision-decrypter</a></p>\n<p>One you obtain the configuration file, simply load it into the program, decrypt it, and save it.Then you can use a hex editor to search for the passwords. At some point, I would like to implement the ability to read and edit the database from inside of the program.</p>\n<p>Reference：<br><a href=\"https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/\">https://ipcamtalk.com/threads/hikvision-backdoor-ip-camera.46486/</a></p>\n<p>C3HC如何查看摄像头admin密码？<br>海康C3HC, 第一次或着重置后连接，会有修改admin为新密码的步骤：修改密码<br>请将默认加密密码修改为新的加密密码，默认密码为设备验证码（6位大写字母），你可以在设备标签上找到它。<br>新密码：<br>修改后，请牢记你的新密码，若密码丢失，将不能被找回，需重置设备恢复初始值，确定要修改？</p>\n<ol start=\"3\">\n<li>思路：找海康摄像头漏洞，针对漏洞进行分析和利用<br> CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现<br>     <a href=\"https://www.cnblogs.com/yier-G/p/16632842.html\">https://www.cnblogs.com/yier-G/p/16632842.html</a><br><br> CVE-2017-7921复现（解密文件）<br>     <a href=\"https://blog.csdn.net/qq_41617034/article/details/117521734\">https://blog.csdn.net/qq_41617034/article/details/117521734</a><br><br> 海康摄像头CVE-2021-36260漏洞复现<br>     <a href=\"https://blog.csdn.net/qq_50854662/article/details/128700889\">https://blog.csdn.net/qq_50854662/article/details/128700889</a><br>     复现源代码：<a href=\"https://github.com/Cuerz/CVE-2021-36260\">https://github.com/Cuerz/CVE-2021-36260</a></li>\n</ol>\n<p>肯定能找到漏洞复现；可是我无法连接到摄像头的网络，导致无法通信的尴尬！？</p>\n<p>疑问：<br>    1. 激活摄像头以后，热点的密码就变为激活密码了吗？<br>        2. 用网线连接后，可否找到IP？<br>        3. C3HC是否有这个漏洞？可否下载configurationFile；</p>\n<p>思路2，问问个人卖家；这样专业的实践知识有时Google很难及时收录。</p>\n<p>得到确认：WIFI和AP热点模式是不可能同时开启的！<br>20231011 C3HC大概率有这两个漏洞：<br>    搜索: C3HC 固件升级; 搜索结构还在固件版本V5.3.2 build 200312</p>\n<p>如何解绑定手机号<br>    拆下flash，上编程器，修改序列号和验证码即可<br>    具体视频：9号-10号，看了视频，丢失了链接<br>    萤石云摄像头固件修改，更换SN解绑手机，解邦教程<br>    <a href=\"https://tieba.baidu.com/p/8197423399\">https://tieba.baidu.com/p/8197423399</a></p>\n<p>海康威视CVE-2017-7921的一次实战利用<br><a href=\"https://cn-sec.com/archives/1788403.html\">https://cn-sec.com/archives/1788403.html</a></p>\n<h1 id=\"Flash芯片闪存内容编辑\"><a href=\"#Flash芯片闪存内容编辑\" class=\"headerlink\" title=\"Flash芯片闪存内容编辑\"></a>Flash芯片闪存内容编辑</h1><p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/11/6667aaea75943.png\" alt=\"image-20240611093951945\"></p>\n<ol>\n<li><p>把flash芯片（型号 XMC 250H128CH10）取下来，上编程器（使用了CH341A编程器），读取到flash芯片中的固件文件</p>\n<ol>\n<li>在此之前涉及到简易编程器采购，从拆解的摄像头主板上焊下flash芯片，芯片圆点位置（正极）对应烧录座的1号针脚，</li>\n<li>以及2425_CH341A土豪金24&#x2F;25编程器软件的驱动安装等；具体步骤搜索本站文章：PVE安装Windows7 》 运行CH341A编程器</li>\n</ol>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e2957b0b1.png\" alt=\"image-20240612074934788\"></p>\n</li>\n<li><p><a href=\"https://hexed.it/\">Hex Edit在线打开</a>提取到的二进制bin文件，进一步编辑序列号和验证码</p>\n<ol>\n<li><p>查找到三处序列号（一共9位ascii码字母数字组合，i.e. J1772）</p>\n<p>位置：00060040，00F40DC0，00FB0F20</p>\n<ol>\n<li>Note：该Bin文件中的这些序列号是转化为十六进制格式的ASCII码来保存的</li>\n</ol>\n</li>\n<li><p>查找到一处验证码（一共6位ascii码大写字母, i.e. UXT***）</p>\n<p>位置：00060010</p>\n</li>\n<li><p>修改到同型号全新的或拆机的序列号后保持导出，准备写入到flash芯片中</p>\n</li>\n</ol>\n</li>\n<li><p>把新的bin文件，通过编程器写入到flash芯片中</p>\n<ol>\n<li>加载新的bin文件后，点击”自动”；先是现实：正在擦除中…</li>\n<li>自动跳转到：正在编程中…</li>\n<li>如果正确识别到芯片的情况，自动操作时出现超时 错误等，可以尝试手动操作，如:擦除—查空—编程—效验，一步步操作解决</li>\n</ol>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e4a727364.png\" alt=\"image-20240612075825125\"></p>\n<p>擦除—查空—编程—效验：  擦除成功提示如下：</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e61be6b20.png\" alt=\"image-20240612080437829\"></p>\n<p>查空成功提示如下：</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e6ff1f474.png\" alt=\"image-20240612080825294\"></p>\n<p>编程超时错误提示如下：</p>\n<p>这时在写入到10%（花费2分45秒左右）时提示超时失败</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6668e8ccdcc1b.png\" alt=\"image-20240612081607165\"></p>\n<p>不管换了两台机器（Win7虚拟机 和Win10的PC机），移除或使用USB延长线，只要用这个软件：“CH341A编程器”都会在写入过程中报超时错误</p>\n<p>最后花了3小时，才验证出这样的经验。切换到Neo Programmer 2.2.10 (2021&#x2F;10&#x2F;15)版本可以正常写入！</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6669135d8ce1e.png\" alt=\"image-20240612111744193\"></p>\n<p>编程成功提示如下：</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/6669605a26ffa.png\" alt=\"image-20240612164615621\"></p>\n</li>\n<li><p>焊接安装XMC25Q128闪存芯片到摄像头的主板上。</p>\n</li>\n<li><p>开机测试，萤石APP绑定新账号</p>\n</li>\n</ol>\n<p>NeoProgrammer V2.2.0.10</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/12/66691df4cfb4e.png\" alt=\"image-20240612120258664\"></p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/06/13/666adcd9ed26a.png\" alt=\"image-20240613194943391\"></p>\n<p>![image-20240613204904232](&#x2F;Users&#x2F;carlzeng&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20240613204904232.png)</p>\n<h1 id=\"Ingram\"><a href=\"#Ingram\" class=\"headerlink\" title=\"Ingram\"></a>Ingram</h1><p>网络摄像头漏洞扫描工具 | Webcam vulnerability scanning tool</p>\n<p>项目地址: <a href=\"https://github.com/jorhelp/Ingram/tree/master\">https://github.com/jorhelp/Ingram/tree/master</a></p>\n<p>主要针对网络摄像头的漏洞扫描框架，目前已集成海康、大华、宇视、dlink等常见设备</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p><strong>请在 Linux 或 Mac 系统使用，确保安装了3.8及以上版本的Python，尽量不要使用3.11，因为对许多包的兼容不是很好</strong></p>\n<ul>\n<li>克隆该仓库:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/jorhelp/Ingram.git</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>进入项目目录，创建一个虚拟环境，并激活该环境：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd Ingram</span><br><span class=\"line\">pip3 install virtualenv</span><br><span class=\"line\">python3 -m virtualenv venv</span><br><span class=\"line\">source venv/bin/activate</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>安装依赖:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip3 install -r requirements.txt</span><br></pre></td></tr></table></figure>\n\n<p>至此安装完毕！</p>\n<h2 id=\"运行\"><a href=\"#运行\" class=\"headerlink\" title=\"运行\"></a>运行</h2><ul>\n<li>由于是在虚拟环境中配置，所以，每次运行之前，请先激活虚拟环境：<code>source venv/bin/activate</code></li>\n<li>你需要准备一个目标文件，比如 targets.txt，里面保存着你要扫描的 IP 地址，每行一个目标，具体格式如下：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 你可以使用井号(#)来进行注释</span><br><span class=\"line\"></span><br><span class=\"line\"># 单个的 IP 地址</span><br><span class=\"line\">192.168.0.1</span><br><span class=\"line\"></span><br><span class=\"line\"># IP 地址以及要扫描的端口</span><br><span class=\"line\">192.168.0.2:80</span><br><span class=\"line\"></span><br><span class=\"line\"># 带 &#x27;/&#x27; 的IP段</span><br><span class=\"line\">192.168.0.0/16</span><br><span class=\"line\"></span><br><span class=\"line\"># 带 &#x27;-&#x27; 的IP段</span><br><span class=\"line\">192.168.0.0-192.168.255.255</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>有了目标文件之后就可直接运行:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 run_ingram.py -i 你要扫描的文件 -o 输出文件夹</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>端口： 如果target.txt文件中指定了目标的端口，比如: 192.168.6.6:8000，那么会扫描该目标的8000端口</li>\n</ul>\n<p>否则的话，默认只扫描常见端口(定义在 <code>Ingram/config.py</code> 中)，若要批量扫描其他端口，需自行指定，例如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 run_ingram.py -i 你要扫描的文件 -o 输出文件夹 -p 80 81 8000</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>默认并发数目为 300，可以根据机器配置及网速通过 <code>-t</code> 参数来自行调控：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 run_ingram.py -i 你要扫描的文件 -o 输出文件夹 -t 500</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>支持中断恢复，不过并不会实时记录当前运行状态，而是间隔一定时间，所以并不能准确恢复到上次的运行状态。如果扫描因为网络或异常而中断，可以通过重复执行上次的扫描命令来继续扫描</li>\n<li>所有参数：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">optional arguments:</span><br><span class=\"line\">  -h, --help            show this help message and exit</span><br><span class=\"line\">  -i IN_FILE, --in_file IN_FILE</span><br><span class=\"line\">                        the targets will be scan</span><br><span class=\"line\">  -o OUT_DIR, --out_dir OUT_DIR</span><br><span class=\"line\">                        the dir where results will be saved</span><br><span class=\"line\">  -p PORTS [PORTS ...], --ports PORTS [PORTS ...]</span><br><span class=\"line\">                        the port(s) to detect</span><br><span class=\"line\">  -t TH_NUM, --th_num TH_NUM</span><br><span class=\"line\">                        the processes num</span><br><span class=\"line\">  -T TIMEOUT, --timeout TIMEOUT</span><br><span class=\"line\">                        requests timeout</span><br><span class=\"line\">  -D, --disable_snapshot</span><br><span class=\"line\">                        disable snapshot</span><br><span class=\"line\">  --debug</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"端口扫描器\"><a href=\"#端口扫描器\" class=\"headerlink\" title=\"端口扫描器\"></a>端口扫描器</h2><ul>\n<li>我们可以利用强大的端口扫描器来获取活动主机，进而缩小 Ingram 的扫描范围，提高运行速度，具体做法是将端口扫描器的结果文件整理成 <code>ip:port</code> 的格式，并作为 Ingram 的输入</li>\n<li>这里以 masscan 为例简单演示一下（masscan 的详细用法这里不再赘述），首先用 masscan 扫描 80 或 8000-8008 端口存活的主机：<code>masscan -p80,8000-8008 -iL 目标文件 -oL 结果文件 --rate 8000</code></li>\n<li>masscan 运行完之后，将结果文件整理一下：<code>grep &#39;open&#39; 结果文件 | awk &#39;&#123;printf&quot;%s:%s\\n&quot;, $4, $3&#125;&#39; &gt; targets.txt</code></li>\n<li>之后对这些主机进行扫描：<code>python run_ingram.py -i targets.txt -o out</code></li>\n</ul>\n<h2 id=\"实测\"><a href=\"#实测\" class=\"headerlink\" title=\"实测\"></a>实测</h2><p>扫描测试ip段有发现摄像头: </p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bf9f595d68.jpg\" alt=\"1201755007382_.pic\"></p>\n<p>运行:</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bfa2c05dac.jpg\" alt=\"591755004786_.pic\"></p>\n<p>操作运行步骤: </p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bfa17dede6.jpg\" alt=\"671755005220_.pic\"></p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/13/689bfa9205b10.png\" alt=\"image-20250813103808493\"></p>\n<h2 id=\"配置Ingram字典文件\"><a href=\"#配置Ingram字典文件\" class=\"headerlink\" title=\"配置Ingram字典文件\"></a>配置Ingram字典文件</h2><p><img data-src=\"https://img.carlzeng.com:3/i/2025/08/14/689da388021e3.png\" alt=\"image-20250814165117197\"></p>\n<h1 id=\"海康摄像头通过Web插件进行预览播放和控制\"><a href=\"#海康摄像头通过Web插件进行预览播放和控制\" class=\"headerlink\" title=\"海康摄像头通过Web插件进行预览播放和控制\"></a>海康摄像头通过Web插件进行预览播放和控制</h1><p>必需使用<strong>IE浏览器</strong>; 安装插件后, 才能查看实时的海康摄像头或DVR画面;</p>\n<p>插件文件名: WebComponents.exe</p>\n<p>大小: 1.78MB</p>\n<p>可能不同的固件使用不同的版本, 搜索官网上是</p>\n<p>WebComponentsDownload<br>V3.0.8.23 |4.55MB |2023&#x2F;02&#x2F;08</p>\n<p><a href=\"https://www.hikvision.com/en/support/tools/hitools/cl07322df9f57a1ee1/\">https://www.hikvision.com/en/support/tools/hitools/cl07322df9f57a1ee1/</a></p>\n<p>平台还有其他的工具 如:</p>\n<p>VSPlayer_mac64Download</p>\n<p>V2.0.2.3 |38.75MB |2025&#x2F;01&#x2F;03</p>\n<p>VSPlayer plays the streams or recordings from Hikvision encoding devices in various formats, including H.264, Smart264, H.265, Smart265, SVAC, and MPEG4.</p>","categories":[{"name":"摄像头","path":"api/categories/摄像头.json"}],"tags":[{"name":"摄像头","path":"api/tags/摄像头.json"}]}