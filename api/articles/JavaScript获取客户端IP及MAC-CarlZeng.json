{"title":"JavaScript获取客户端IP及MAC-CarlZeng","slug":"JavaScript获取客户端IP及MAC-CarlZeng","date":"2008-11-27T06:59:00.000Z","updated":"2023-10-02T02:27:28.934Z","comments":true,"path":"api/articles/JavaScript获取客户端IP及MAC-CarlZeng.json","excerpt":"1WMI Scripting HTML239102122232425263536 37核心就是调用了两个系统自带的ActiveX进行交互.有空可以试一下。","covers":null,"content":"<p>1WMI Scripting HTML239102122232425263536 37核心就是调用了两个系统自带的ActiveX进行交互.有空可以试一下。</p>\n<!-- more -->\n<p>1<HTML><HEAD><TITLE>WMI Scripting HTML</TITLE><br>2<META http-equiv=Content-Type content=\"text/html; charset=gb2312\"><br>3<SCRIPT language=JScript event=\"OnCompleted(hResult,pErrorObject, pAsyncContext)\" for=foo><br>4document.forms[0].txtMACAddr.value=unescape(MACAddr);<br>5document.forms[0].txtIPAddr.value=unescape(IPAddr);<br>6document.forms[0].txtDNSName.value=unescape(sDNSName);<br>7//document.formbar.submit();<br>8</SCRIPT><br>9<br>10<SCRIPT language=JScript event=OnObjectReady(objObject,objAsyncContext) for=foo><br>11if(objObject.IPEnabled != null && objObject.IPEnabled != \"undefined\" && objObject.IPEnabled == true)<br>12{<br>13if(objObject.MACAddress != null && objObject.MACAddress != \"undefined\")<br>14MACAddr = objObject.MACAddress;<br>15if(objObject.IPEnabled && objObject.IPAddress(0) != null && objObject.IPAddress(0) != \"undefined\")<br>16IPAddr = objObject.IPAddress(0);<br>17if(objObject.DNSHostName != null && objObject.DNSHostName != \"undefined\")<br>18sDNSName = objObject.DNSHostName;<br>19}<br>20</SCRIPT><br>21<br>22<META content=\"MSHTML 6.00.2800.1106\" name=GENERATOR></HEAD><br>23<BODY><br>24<OBJECT id=locator classid=CLSID:76A64158-CB41-11D1-8B02-00600806D9B6 VIEWASTEXT></OBJECT><br>25<OBJECT id=foo classid=CLSID:75718C9A-F029-11d1-A1AC-00C04FB6C223></OBJECT><br>26<SCRIPT language=JScript><br>27var service = locator.ConnectServer();<br>28var MACAddr ;<br>29var IPAddr ;<br>30var DomainAddr;<br>31var sDNSName;<br>32service.Security_.ImpersonationLevel=3;<br>33service.InstancesOfAsync(foo, 'Win32_NetworkAdapterConfiguration');<br>34</SCRIPT><br>35<br>36<FORM id=formfoo name=formbar action=NICPost.asp method=post><INPUT value=00:05:5D:0E:C7:FA name=txtMACAddr> <INPUT value=192.168.0.2 name=txtIPAddr> <INPUT value=typ name=txtDNSName> </FORM></BODY></HTML><br>37<br>核心就是调用了两个系统自带的ActiveX进行交互.</p>\n<p>有空可以试一下。</p>\n","more":"<p>1WMI Scripting HTML239102122232425263536 37核心就是调用了两个系统自带的ActiveX进行交互.有空可以试一下。</p>\n<!-- more -->\n<p>1<HTML><HEAD><TITLE>WMI Scripting HTML</TITLE><br>2<META http-equiv=Content-Type content=\"text/html; charset=gb2312\"><br>3<SCRIPT language=JScript event=\"OnCompleted(hResult,pErrorObject, pAsyncContext)\" for=foo><br>4document.forms[0].txtMACAddr.value=unescape(MACAddr);<br>5document.forms[0].txtIPAddr.value=unescape(IPAddr);<br>6document.forms[0].txtDNSName.value=unescape(sDNSName);<br>7//document.formbar.submit();<br>8</SCRIPT><br>9<br>10<SCRIPT language=JScript event=OnObjectReady(objObject,objAsyncContext) for=foo><br>11if(objObject.IPEnabled != null && objObject.IPEnabled != \"undefined\" && objObject.IPEnabled == true)<br>12{<br>13if(objObject.MACAddress != null && objObject.MACAddress != \"undefined\")<br>14MACAddr = objObject.MACAddress;<br>15if(objObject.IPEnabled && objObject.IPAddress(0) != null && objObject.IPAddress(0) != \"undefined\")<br>16IPAddr = objObject.IPAddress(0);<br>17if(objObject.DNSHostName != null && objObject.DNSHostName != \"undefined\")<br>18sDNSName = objObject.DNSHostName;<br>19}<br>20</SCRIPT><br>21<br>22<META content=\"MSHTML 6.00.2800.1106\" name=GENERATOR></HEAD><br>23<BODY><br>24<OBJECT id=locator classid=CLSID:76A64158-CB41-11D1-8B02-00600806D9B6 VIEWASTEXT></OBJECT><br>25<OBJECT id=foo classid=CLSID:75718C9A-F029-11d1-A1AC-00C04FB6C223></OBJECT><br>26<SCRIPT language=JScript><br>27var service = locator.ConnectServer();<br>28var MACAddr ;<br>29var IPAddr ;<br>30var DomainAddr;<br>31var sDNSName;<br>32service.Security_.ImpersonationLevel=3;<br>33service.InstancesOfAsync(foo, 'Win32_NetworkAdapterConfiguration');<br>34</SCRIPT><br>35<br>36<FORM id=formfoo name=formbar action=NICPost.asp method=post><INPUT value=00:05:5D:0E:C7:FA name=txtMACAddr> <INPUT value=192.168.0.2 name=txtIPAddr> <INPUT value=typ name=txtDNSName> </FORM></BODY></HTML><br>37<br>核心就是调用了两个系统自带的ActiveX进行交互.</p>\n<p>有空可以试一下。</p>\n","categories":[],"tags":[]}