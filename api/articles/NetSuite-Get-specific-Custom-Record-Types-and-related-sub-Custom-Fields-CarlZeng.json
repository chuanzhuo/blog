{"title":"NetSuite - Get specific Custom Record Types and related sub Custom Fields","slug":"NetSuite-Get-specific-Custom-Record-Types-and-related-sub-Custom-Fields-CarlZeng","date":"2023-08-16T01:01:00.000Z","updated":"2024-10-25T12:30:51.070Z","comments":true,"path":"api/articles/NetSuite-Get-specific-Custom-Record-Types-and-related-sub-Custom-Fields-CarlZeng.json","excerpt":"NetSuite: Get specific Custom Record Types and related sub Custom Fields","covers":["https://img.carlzeng.com:3/i/2024/05/09/663c8c9f16479.png","https://img.carlzeng.com:3/i/2024/05/18/6648b3ff4f9ec.png"],"content":"<p>NetSuite: Get specific Custom Record Types and related sub Custom Fields</p>\n<span id=\"more\"></span>\n\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/05/09/663c8c9f16479.png\" alt=\"image-20240509164300563\"></p>\n<h1 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h1><p>以前当使用search.create({})来获取数据时，我们需要制定特定的数据返回列；例如：search.createColumn(options)</p>\n<p>而query可以使用 SELECT * FROM 来动态返回所有的数据列（这在有的时候是一个优点），那么如何让search也动态返回所有的数据列呢？</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> CF.ScriptID , <span class=\"operator\">*</span></span><br><span class=\"line\">         <span class=\"keyword\">FROM</span> CustomField CF <span class=\"keyword\">left</span> <span class=\"keyword\">join</span> CustomRecordType <span class=\"keyword\">on</span> CF.recordtype <span class=\"operator\">=</span> CustomRecordType.internalid</span><br><span class=\"line\"> \t\t\t\t <span class=\"keyword\">Where</span> CF.ScriptID <span class=\"keyword\">like</span> <span class=\"built_in\">UPPER</span>(<span class=\"string\">&#x27;%CUSTRECORD_test%&#x27;</span>)</span><br><span class=\"line\"> \t\t\t\t\t# ScriptID这个地方，<span class=\"keyword\">sql</span>系统返回的全部是大写字母，所以检索时也要用大写字母检索</span><br></pre></td></tr></table></figure>\n\n\n\n<p>var arrColFlds &#x3D; query.runSuiteQL({<br>                query: `SELECT CF.ScriptID scriptid<br>                        FROM CustomField CF left join CustomRecordType on CF.RecordType &#x3D; CustomRecordType.internalid Where CustomRecordType.scriptid = ‘CUSTOMRECORD_1’ and CF.ScriptID like ‘CUSTRECORD%’ `<br>            }).asMappedResults();</p>\n<p> 以上这个query就可以返回Record Type为CUSTOMRECORD_1的所有自定义字段。</p>\n<p>如果你需要所有系统中的Custom Record Types</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">    Name,</span><br><span class=\"line\">    ScriptID,</span><br><span class=\"line\">    InternalID,</span><br><span class=\"line\">    Description,</span><br><span class=\"line\">    BUILTIN.DF( Owner ) <span class=\"keyword\">AS</span> Owner,</span><br><span class=\"line\">    AllowQuickSearch,</span><br><span class=\"line\">    AllowInlineEditing,</span><br><span class=\"line\">    AllowAttachments</span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">    CustomRecordType</span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">    Name</span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以它对应的数据库表：CustomRecordType， 而保存自定义字段的数据库表名：CustomField</p>\n<p>如果你需要所有系统中的Custom Fields</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">    Name,</span><br><span class=\"line\">    ScriptID,</span><br><span class=\"line\">    Description,</span><br><span class=\"line\">    FieldType,</span><br><span class=\"line\">    FieldValueType,</span><br><span class=\"line\">    FieldValueTypeRecord,</span><br><span class=\"line\">    BUILTIN.DF( FieldValueTypeRecord ) <span class=\"keyword\">AS</span> FieldValueTypeRecordName,</span><br><span class=\"line\">    IsMandatory,</span><br><span class=\"line\">    IsStored,</span><br><span class=\"line\">    IsShowInList,</span><br><span class=\"line\">    BUILTIN.DF( Owner ) <span class=\"keyword\">AS</span> Owner</span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">    CustomField</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"题外话\"><a href=\"#题外话\" class=\"headerlink\" title=\"题外话\"></a>题外话</h1><p>如果是在Client端，又不想使用query的情况下；可以用ajax访问抓取Record Catalog，速度会比较慢，抓取所有的自定义表和详细的子自定义字段。</p>\n<p>var rcEndpoint &#x3D; ‘&#x2F;app&#x2F;recordscatalog&#x2F;rcendpoint.nl’; var recordTypes; var action &#x3D; ‘getRecordTypes’; var data &#x3D; encodeURI( JSON.stringify( { structureType: ‘FLAT’ } ) ); var url &#x3D; rcEndpoint + ‘?action&#x3D;’ + action + ‘&amp;data&#x3D;’ + data; var xhr &#x3D; new XMLHttpRequest();<br>xhr.open( ‘get’, url, false );<br>xhr.send();</p>\n<p>recordTypes = JSON.parse( xhr.response );<br>console.log( JSON.stringify( recordTypes, null, 5 ) ); var schema &#x3D; [];<br>recordTypes.data.forEach( function( recordType ) {</p>\n<pre><code>console.log( &#39;Loading details for record type &#39; + recordType.id + &#39;...&#39; );    action = &#39;getRecordTypeDetail&#39;;\ndata \\= encodeURI( JSON.stringify( &#123; scriptId: recordType.id, detailType: &#39;SS\\_ANAL&#39; &#125; ) ); var url = rcEndpoint + &#39;?action=&#39; + action + &#39;&amp;data=&#39; + data; var xhr = new XMLHttpRequest();\nxhr.open( &#39;get&#39;, url, false );\nxhr.send();\nrecordDetail \\= JSON.parse( xhr.response );    \nschema.push( recordDetail.data );\n</code></pre>\n<p>});<br>console.log( JSON.stringify( schema, null, 5 ) );</p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>结合上面的两个query，我们可以把两个表join起来，用来查询特定Record Type的自定义字段：</p>\n<p>var arrColFlds &#x3D; query.runSuiteQL({<br>                query: `SELECT CF.ScriptID scriptid<br>                        FROM CustomField CF left join CustomRecordType on CF.RecordType &#x3D; CustomRecordType.internalid Where CustomRecordType.scriptid &#x3D; ‘CUSTOMRECORD_1’ and CF.ScriptID like ‘CUSTRECORD%’ `<br>            }).asMappedResults();</p>\n<h2 id=\"Limitation\"><a href=\"#Limitation\" class=\"headerlink\" title=\"Limitation\"></a>Limitation</h2><p>这样检索，依然无法查询到那些自定义Record Type下的Custom Field被inactive的字段。</p>\n<blockquote>\n<p>目前唯一的办法就是按 select CustomField， 然后order by id以后 然后去猜下一个id的号码，如果猜对UI就是显示出这个custom field 的设置页面，否者报错：You are not allowed to access this custom field.</p>\n</blockquote>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\tCustomField.description,</span><br><span class=\"line\">\tCustomField.externalId,</span><br><span class=\"line\">\tCustomField.fieldType,</span><br><span class=\"line\">\tCustomField.internalId,</span><br><span class=\"line\">\tCustomField.id,</span><br><span class=\"line\">\tCustomField.name,</span><br><span class=\"line\">\tCustomField.lastModifiedDate,</span><br><span class=\"line\">\tCustomField.fieldValueTypeRecord,</span><br><span class=\"line\">\tCustomField.isMandatory,</span><br><span class=\"line\">\tCustomField.owner,</span><br><span class=\"line\">\tCustomField.recordType,</span><br><span class=\"line\">\tCustomField.scriptid,</span><br><span class=\"line\">\tCustomField.isShowInList,</span><br><span class=\"line\">\tCustomField.isStored,</span><br><span class=\"line\">\tCustomField.fieldValueType,</span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">\tCustomField</span><br><span class=\"line\">\t<span class=\"keyword\">order</span> <span class=\"keyword\">by</span> id</span><br><span class=\"line\">#<span class=\"keyword\">WHERE</span> recordType <span class=\"operator\">=</span> <span class=\"number\">835</span></span><br><span class=\"line\">#这个recordType（注意大小写，suitequery对大小写敏感）就是指定了Record Type的internalid数字</span><br></pre></td></tr></table></figure>\n\n\n\n<p>Netsuite Technical Analyst 技术咨询开发服务</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/05/18/6648b3ff4f9ec.png\" alt=\"image-20240518215819699\"></p>\n","more":"<p><img data-src=\"https://img.carlzeng.com:3/i/2024/05/09/663c8c9f16479.png\" alt=\"image-20240509164300563\"></p>\n<h1 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h1><p>以前当使用search.create({})来获取数据时，我们需要制定特定的数据返回列；例如：search.createColumn(options)</p>\n<p>而query可以使用 SELECT * FROM 来动态返回所有的数据列（这在有的时候是一个优点），那么如何让search也动态返回所有的数据列呢？</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> CF.ScriptID , <span class=\"operator\">*</span></span><br><span class=\"line\">         <span class=\"keyword\">FROM</span> CustomField CF <span class=\"keyword\">left</span> <span class=\"keyword\">join</span> CustomRecordType <span class=\"keyword\">on</span> CF.recordtype <span class=\"operator\">=</span> CustomRecordType.internalid</span><br><span class=\"line\"> \t\t\t\t <span class=\"keyword\">Where</span> CF.ScriptID <span class=\"keyword\">like</span> <span class=\"built_in\">UPPER</span>(<span class=\"string\">&#x27;%CUSTRECORD_test%&#x27;</span>)</span><br><span class=\"line\"> \t\t\t\t\t# ScriptID这个地方，<span class=\"keyword\">sql</span>系统返回的全部是大写字母，所以检索时也要用大写字母检索</span><br></pre></td></tr></table></figure>\n\n\n\n<p>var arrColFlds &#x3D; query.runSuiteQL({<br>                query: `SELECT CF.ScriptID scriptid<br>                        FROM CustomField CF left join CustomRecordType on CF.RecordType &#x3D; CustomRecordType.internalid Where CustomRecordType.scriptid = ‘CUSTOMRECORD_1’ and CF.ScriptID like ‘CUSTRECORD%’ `<br>            }).asMappedResults();</p>\n<p> 以上这个query就可以返回Record Type为CUSTOMRECORD_1的所有自定义字段。</p>\n<p>如果你需要所有系统中的Custom Record Types</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">    Name,</span><br><span class=\"line\">    ScriptID,</span><br><span class=\"line\">    InternalID,</span><br><span class=\"line\">    Description,</span><br><span class=\"line\">    BUILTIN.DF( Owner ) <span class=\"keyword\">AS</span> Owner,</span><br><span class=\"line\">    AllowQuickSearch,</span><br><span class=\"line\">    AllowInlineEditing,</span><br><span class=\"line\">    AllowAttachments</span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">    CustomRecordType</span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">    Name</span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以它对应的数据库表：CustomRecordType， 而保存自定义字段的数据库表名：CustomField</p>\n<p>如果你需要所有系统中的Custom Fields</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">    Name,</span><br><span class=\"line\">    ScriptID,</span><br><span class=\"line\">    Description,</span><br><span class=\"line\">    FieldType,</span><br><span class=\"line\">    FieldValueType,</span><br><span class=\"line\">    FieldValueTypeRecord,</span><br><span class=\"line\">    BUILTIN.DF( FieldValueTypeRecord ) <span class=\"keyword\">AS</span> FieldValueTypeRecordName,</span><br><span class=\"line\">    IsMandatory,</span><br><span class=\"line\">    IsStored,</span><br><span class=\"line\">    IsShowInList,</span><br><span class=\"line\">    BUILTIN.DF( Owner ) <span class=\"keyword\">AS</span> Owner</span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">    CustomField</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"题外话\"><a href=\"#题外话\" class=\"headerlink\" title=\"题外话\"></a>题外话</h1><p>如果是在Client端，又不想使用query的情况下；可以用ajax访问抓取Record Catalog，速度会比较慢，抓取所有的自定义表和详细的子自定义字段。</p>\n<p>var rcEndpoint &#x3D; ‘&#x2F;app&#x2F;recordscatalog&#x2F;rcendpoint.nl’; var recordTypes; var action &#x3D; ‘getRecordTypes’; var data &#x3D; encodeURI( JSON.stringify( { structureType: ‘FLAT’ } ) ); var url &#x3D; rcEndpoint + ‘?action&#x3D;’ + action + ‘&amp;data&#x3D;’ + data; var xhr &#x3D; new XMLHttpRequest();<br>xhr.open( ‘get’, url, false );<br>xhr.send();</p>\n<p>recordTypes = JSON.parse( xhr.response );<br>console.log( JSON.stringify( recordTypes, null, 5 ) ); var schema &#x3D; [];<br>recordTypes.data.forEach( function( recordType ) {</p>\n<pre><code>console.log( &#39;Loading details for record type &#39; + recordType.id + &#39;...&#39; );    action = &#39;getRecordTypeDetail&#39;;\ndata \\= encodeURI( JSON.stringify( &#123; scriptId: recordType.id, detailType: &#39;SS\\_ANAL&#39; &#125; ) ); var url = rcEndpoint + &#39;?action=&#39; + action + &#39;&amp;data=&#39; + data; var xhr = new XMLHttpRequest();\nxhr.open( &#39;get&#39;, url, false );\nxhr.send();\nrecordDetail \\= JSON.parse( xhr.response );    \nschema.push( recordDetail.data );\n</code></pre>\n<p>});<br>console.log( JSON.stringify( schema, null, 5 ) );</p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>结合上面的两个query，我们可以把两个表join起来，用来查询特定Record Type的自定义字段：</p>\n<p>var arrColFlds &#x3D; query.runSuiteQL({<br>                query: `SELECT CF.ScriptID scriptid<br>                        FROM CustomField CF left join CustomRecordType on CF.RecordType &#x3D; CustomRecordType.internalid Where CustomRecordType.scriptid &#x3D; ‘CUSTOMRECORD_1’ and CF.ScriptID like ‘CUSTRECORD%’ `<br>            }).asMappedResults();</p>\n<h2 id=\"Limitation\"><a href=\"#Limitation\" class=\"headerlink\" title=\"Limitation\"></a>Limitation</h2><p>这样检索，依然无法查询到那些自定义Record Type下的Custom Field被inactive的字段。</p>\n<blockquote>\n<p>目前唯一的办法就是按 select CustomField， 然后order by id以后 然后去猜下一个id的号码，如果猜对UI就是显示出这个custom field 的设置页面，否者报错：You are not allowed to access this custom field.</p>\n</blockquote>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\tCustomField.description,</span><br><span class=\"line\">\tCustomField.externalId,</span><br><span class=\"line\">\tCustomField.fieldType,</span><br><span class=\"line\">\tCustomField.internalId,</span><br><span class=\"line\">\tCustomField.id,</span><br><span class=\"line\">\tCustomField.name,</span><br><span class=\"line\">\tCustomField.lastModifiedDate,</span><br><span class=\"line\">\tCustomField.fieldValueTypeRecord,</span><br><span class=\"line\">\tCustomField.isMandatory,</span><br><span class=\"line\">\tCustomField.owner,</span><br><span class=\"line\">\tCustomField.recordType,</span><br><span class=\"line\">\tCustomField.scriptid,</span><br><span class=\"line\">\tCustomField.isShowInList,</span><br><span class=\"line\">\tCustomField.isStored,</span><br><span class=\"line\">\tCustomField.fieldValueType,</span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">\tCustomField</span><br><span class=\"line\">\t<span class=\"keyword\">order</span> <span class=\"keyword\">by</span> id</span><br><span class=\"line\">#<span class=\"keyword\">WHERE</span> recordType <span class=\"operator\">=</span> <span class=\"number\">835</span></span><br><span class=\"line\">#这个recordType（注意大小写，suitequery对大小写敏感）就是指定了Record Type的internalid数字</span><br></pre></td></tr></table></figure>\n\n\n\n<p>Netsuite Technical Analyst 技术咨询开发服务</p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/05/18/6648b3ff4f9ec.png\" alt=\"image-20240518215819699\"></p>","categories":[{"name":"NetSuite","path":"api/categories/NetSuite.json"}],"tags":[{"name":"NetSuite","path":"api/tags/NetSuite.json"}]}