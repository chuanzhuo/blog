{"title":"Dockeræ­å»ºè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡","slug":"Dockeræ­å»ºè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡","date":"2023-11-20T08:54:57.000Z","updated":"2023-11-22T12:18:30.916Z","comments":true,"path":"api/articles/Dockeræ­å»ºè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡.json","excerpt":" [Figure] è‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡ dujiaoka","covers":["https://www.evernote.com/shard/s122/sh/28cd0f84-7b75-402b-a78b-0fdbc30e7615/0Vihl8lVbSwR84f1sWlHCWkZdwVZjcmThrHc-x0gAzbTvCrzNM1ztoXh0g/deep/0/image.png"],"content":"<img class=\"lozad\" data-src=\"https://www.evernote.com/shard/s122/sh/28cd0f84-7b75-402b-a78b-0fdbc30e7615/0Vihl8lVbSwR84f1sWlHCWkZdwVZjcmThrHc-x0gAzbTvCrzNM1ztoXh0g/deep/0/image.png\">\nè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡ dujiaoka\n<span id=\"more\"></span>\n\n<h1 id=\"æœ‰ä»€ä¹ˆç”¨\"><a href=\"#æœ‰ä»€ä¹ˆç”¨\" class=\"headerlink\" title=\"æœ‰ä»€ä¹ˆç”¨\"></a>æœ‰ä»€ä¹ˆç”¨</h1><p>è‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡<br>å°è¯•æŒ‰æ•™æå’Œè§†é¢‘æ­å»ºå¤±è´¥äº†ï¼ˆè¯¦è§ç« èŠ‚ï¼šæ­å»ºå¤±è´¥çš„å†å²è®°å½•ï¼‰ï¼Œ<br>é¼“èµ·å‹‡æ°”ï¼Œé‡æ–°é€‰ç”¨æ–°çš„æ–¹æ¡ˆï¼š<a href=\"https://blog.dov.moe/posts/49102/\">https://blog.dov.moe/posts/49102/</a></p>\n<p>ä¸¾ä¸ªğŸŒ°ä¾‹å­ï¼š<a href=\"https://dovshop.net/\">https://dovshop.net/</a></p>\n<h1 id=\"å®ç°æ–¹æ³•\"><a href=\"#å®ç°æ–¹æ³•\" class=\"headerlink\" title=\"å®ç°æ–¹æ³•\"></a>å®ç°æ–¹æ³•</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /www/server/panel/data/compose/dujiaoka/template</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir Shop &amp;&amp; cd Shop</span><br><span class=\"line\">mkdir storage uploads</span><br><span class=\"line\">chmod 777 storage uploads</span><br><span class=\"line\">â—æ³¨æ„æ­¤å¤„æ–‡ä»¶å¤¹æƒé™ä¸€å®šè¦ç»™ï¼</span><br><span class=\"line\"></span><br><span class=\"line\">chmod -R 777 env.conf</span><br><span class=\"line\"># é‡è¦æ­¥éª¤</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  faka:</span><br><span class=\"line\">    image: ghcr.io/apocalypsor/dujiaoka:latest</span><br><span class=\"line\">    # å›½å†…æœåŠ¡å™¨å¯ä»¥ç”¨ hkccr.ccs.tencentyun.com/apocalypsor/dujiaoka:latest</span><br><span class=\"line\">    container_name: faka</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">        # - INSTALL=false</span><br><span class=\"line\">        - INSTALL=true</span><br><span class=\"line\">        # - MODIFY=true</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./env.conf:/dujiaoka/.env</span><br><span class=\"line\">      - ./uploads:/dujiaoka/public/uploads</span><br><span class=\"line\">      - ./storage:/dujiaoka/storage</span><br><span class=\"line\">      - ./start-hook.sh:/dujiaoka/start-hook.sh</span><br><span class=\"line\">      # ç½‘ç«™å›¾æ ‡ 32X32 favicon.ico 4kbï¼Œé»˜è®¤æ¨¡ç‰ˆåªéœ€ç¬¬ä¸€å¤„ï¼Œå…¶ä»–æ¨¡ç‰ˆéœ€è¦ç¬¬äºŒå¤„</span><br><span class=\"line\">\t  - ./favicon.ico:/dujiaoka/public/favicon.ico:ro</span><br><span class=\"line\">\t  - ./favicon.ico:/dujiaoka/public/assets/style/favicon.ico:ro</span><br><span class=\"line\">\t  # é»˜è®¤å•†å“å›¾ç‰‡ 512x512 default.jpg 18kbï¼ˆç½‘ç«™ LOGO å…±äº«æ­¤å›¾ï¼Œä¸åå°è‡ªå®šä¹‰ LOGO å’Œå•†å“å›¾ç‰‡ä¸å†²çªï¼‰</span><br><span class=\"line\">\t  - ./default.png:/dujiaoka/public/assets/common/images/default.jpg:ro</span><br><span class=\"line\">\t  # Luna ä¸»é¢˜ç½‘ç«™èƒŒæ™¯ 1920x1224 background.png 198kb</span><br><span class=\"line\">\t  - ./background.png:/dujiaoka/public/assets/luna/img/background.png:ro</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 4444:80</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\"> </span><br><span class=\"line\">  db:</span><br><span class=\"line\">    image: mariadb:focal</span><br><span class=\"line\">    container_name: faka-data</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - MYSQL_ROOT_PASSWORD=mariadb</span><br><span class=\"line\">      - MYSQL_DATABASE=dujiaoka</span><br><span class=\"line\">      - MYSQL_USER=dujiaoka</span><br><span class=\"line\">      - MYSQL_PASSWORD=dujiaokapassword</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./data:/var/lib/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:alpine</span><br><span class=\"line\">    container_name: faka-redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–è¾‘ .env æ–‡ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">APP_NAME=Carlçš„å°åº—</span><br><span class=\"line\">APP_ENV=local</span><br><span class=\"line\">APP_KEY=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\">APP_DEBUG=false</span><br><span class=\"line\">APP_URL=http://192.168.6.116:4444</span><br><span class=\"line\">#ADMIN_HTTPS=true</span><br><span class=\"line\"></span><br><span class=\"line\">LOG_CHANNEL=stack</span><br><span class=\"line\"></span><br><span class=\"line\"># æ•°æ®åº“é…ç½®</span><br><span class=\"line\">DB_CONNECTION=mysql</span><br><span class=\"line\">DB_HOST=db</span><br><span class=\"line\">DB_PORT=3306</span><br><span class=\"line\">DB_DATABASE=dujiaoka</span><br><span class=\"line\">DB_USERNAME=dujiaoka</span><br><span class=\"line\">DB_PASSWORD=dujiaokapassword</span><br><span class=\"line\"></span><br><span class=\"line\"># redis é…ç½®</span><br><span class=\"line\">REDIS_HOST=redis</span><br><span class=\"line\">REDIS_PASSWORD=</span><br><span class=\"line\">REDIS_PORT=6379</span><br><span class=\"line\"></span><br><span class=\"line\">BROADCAST_DRIVER=log</span><br><span class=\"line\">SESSION_DRIVER=file</span><br><span class=\"line\">SESSION_LIFETIME=120</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># ç¼“å­˜é…ç½®</span><br><span class=\"line\"># file ä¸ºç£ç›˜æ–‡ä»¶  redis ä¸ºå†…å­˜çº§åˆ«</span><br><span class=\"line\"># redis ä¸ºå†…å­˜éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span><br><span class=\"line\">CACHE_DRIVER=redis</span><br><span class=\"line\"></span><br><span class=\"line\"># å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</span><br><span class=\"line\"># sync ä¸ºåŒæ­¥  redis ä¸ºå¼‚æ­¥</span><br><span class=\"line\"># ä½¿ç”¨ redis å¼‚æ­¥éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span><br><span class=\"line\">QUEUE_CONNECTION=redis</span><br><span class=\"line\"></span><br><span class=\"line\"># åå°è¯­è¨€</span><br><span class=\"line\">## zh_CN ç®€ä½“ä¸­æ–‡</span><br><span class=\"line\">## zh_TW ç¹ä½“ä¸­æ–‡</span><br><span class=\"line\">## en    è‹±æ–‡</span><br><span class=\"line\">DUJIAO_ADMIN_LANGUAGE=zh_CN</span><br><span class=\"line\"></span><br><span class=\"line\"># åå°ç™»å½•åœ°å€</span><br><span class=\"line\">ADMIN_ROUTE_PREFIX=/admin</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ç›´æ— æ³•ä¸‹è½½æˆåŠŸâ€¦â€¦<br>ä¿®æ”¹ä½¿ç”¨ï¼šstilleshan&#x2F;dujiaoka</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose+å¦‚ä½•ä½¿ç”¨ä»£ç†æé€Ÿ</span><br><span class=\"line\">\t\thttps://neucrack.com/p/286</span><br><span class=\"line\">\tworkaourndï¼šæ‰‹åŠ¨è®©OpenClashä¸åœåœ¨çº¿ï¼ˆä¸åœ¨çº¿å°±é‡æ–°åˆ·æ–°å–è·å–æœ€æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ç»ˆäºä¸‹è½½æˆåŠŸåï¼Œå¯åŠ¨å¤±è´¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting &quot;/www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico&quot; to rootfs at &quot;/dujiaoka/public/favicon.ico&quot;: mount /www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico:/dujiaoka/public/favicon.ico (via /proc/self/fd/6), flags: 0x5001: not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type</span><br></pre></td></tr></table></figure>\n<p>æ³¨é‡Šæ‰é‚£å‡ ä¸ªè‡ªå®šä¹‰çš„æ–‡ä»¶æ˜ å°„ï¼Œå°±å¥½äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">faka        | The environment file is invalid!</span><br><span class=\"line\">faka        | Failed to parse dotenv file due to unexpected whitespace. Failed at [Carl Shop].</span><br></pre></td></tr></table></figure>\n<p>è¿”å›ä¿®æ”¹æŠŠå‰ååŠ ä¸Šå¼•å·ã€‚</p>\n<p>ä¿®æ”¹äº†ç«¯å£æ˜ å°„å‡º4444åï¼Œé”™è¯¯ï¼š<br>500<br>Server Error</p>\n<p>â—æ³¨æ„ç¯å¢ƒå˜é‡å¦‚æœå†™çš„ä¸å¯¹å¯èƒ½å¯¼è‡´ 500ï¼Œå¯ä»¥å¼€ APP_DEBUG&#x3D;true çœ‹çœ‹å…·ä½“æ˜¯å“ªé‡Œå†™é”™äº†ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   throw new RuntimeException(&#x27;The only supported ciphers are AES-128-CBC and AES-256-CBC with the correct key lengths.&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">è§£å†³åŠæ³•ï¼šä¿®æ”¹APP_KEY=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\">--------------</span><br><span class=\"line\"></span><br><span class=\"line\">file_put_contents(/dujiaoka/.env): failed to open stream: Permission denied</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æœ¬åœ°è®¿é—®æˆåŠŸï¼š<a href=\"http://192.168.6.116:4444/\">http://192.168.6.116:4444</a></p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://hub.docker.com/r/stilleshan/dujiaoka\">https://hub.docker.com/r/stilleshan/dujiaoka</a><br><a href=\"https://hub.docker.com/r/jiangjuhong/dujiaoka\">https://hub.docker.com/r/jiangjuhong/dujiaoka</a></p>\n<hr>\n<hr>\n<h1 id=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"><a href=\"#æ­å»ºå¤±è´¥çš„å†å²è®°å½•\" class=\"headerlink\" title=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"></a>æ­å»ºå¤±è´¥çš„å†å²è®°å½•</h1><p>ç‹¬è§’æ•°å¡<br>å¼€æºå¼ç«™é•¿è‡ªåŠ¨åŒ–å”®è´§è§£å†³æ–¹æ¡ˆã€é«˜æ•ˆã€ç¨³å®šã€å¿«é€Ÿï¼</p>\n<p>å¾’æ‰‹æ­å»ºç‹¬è§’æ•°å‘å¡ç½‘ç«™ ç»è¥è‡ªå·±çš„å°åº—ï¼ - å…­æœˆ 26, 2023<br><a href=\"https://kejilion.blogspot.com/2023/06/blog-post_26.html\">https://kejilion.blogspot.com/2023/06/blog-post_26.html</a></p>\n<p>é…ç½®docker-compose<br><a href=\"https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml\">https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;3.8&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nginx:</span><br><span class=\"line\">    image: nginx:1.22</span><br><span class=\"line\">    container_name: nginx</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 882:80</span><br><span class=\"line\">      - 4444:443      </span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./nginx.conf:/etc/nginx/nginx.conf</span><br><span class=\"line\">      - ./certs:/etc/nginx/certs      </span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  php:</span><br><span class=\"line\">    image: php:7.4.33-fpm</span><br><span class=\"line\">    container_name: php</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  mysql:</span><br><span class=\"line\">    image: mysql:5.7.42</span><br><span class=\"line\">    container_name: mysql</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./mysql:/var/lib/mysql</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - MYSQL_ROOT_PASSWORD=webroot</span><br><span class=\"line\">      - MYSQL_DATABASE=web</span><br><span class=\"line\">      - MYSQL_USER=carlZeng</span><br><span class=\"line\">      - MYSQL_PASSWORD=carlZengYYDS</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:latest</span><br><span class=\"line\">    container_name: redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n<p>ä¿®æ”¹äº†ç‹¬è§’æ•°å¡çš„ç«¯å£</p>\n<p>ç”³è¯·è¯ä¹¦, ä¸‹è½½è¯ä¹¦;</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ç›´æ¥å»NPMä¸­ä¸‹è½½è¯ä¹¦è§£å‹ç¼©åé‡å‘½åæ”¾åˆ°debiançš„ç›®å½•ï¼š</span><br><span class=\"line\">/home/web/certs</span><br><span class=\"line\">    key.pem</span><br><span class=\"line\">    cert.pem</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p>ç»§ç»­é…ç½®nginx.conf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections 1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">    </span><br><span class=\"line\">    client_max_body_size 1000m;  </span><br><span class=\"line\">    #ä¸Šä¼ é™åˆ¶å‚æ•°1Gä»¥å†…æ–‡ä»¶å¯ä¸Šä¼ </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # HTTP server</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name shop.carlzeng.top;</span><br><span class=\"line\"></span><br><span class=\"line\">        # Redirect all HTTP requests to HTTPS</span><br><span class=\"line\">        return 301 https://$host$request_uri;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # HTTPS server</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443 ssl http2;</span><br><span class=\"line\">        server_name shop.carlzeng.top;</span><br><span class=\"line\"></span><br><span class=\"line\">        # http2 on;</span><br><span class=\"line\">            </span><br><span class=\"line\">        ssl_certificate /etc/nginx/certs/cert.pem;</span><br><span class=\"line\">        ssl_certificate_key /etc/nginx/certs/key.pem;</span><br><span class=\"line\"></span><br><span class=\"line\">        root /var/www/html/dujiaoka/public/;</span><br><span class=\"line\">        index index.php;</span><br><span class=\"line\"></span><br><span class=\"line\">        try_files $uri $uri/ /index.php?$query_string;    </span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">        # PHP-FPM configuration</span><br><span class=\"line\">        location ~ \\.php$ &#123;</span><br><span class=\"line\">            fastcgi_pass php:9000;</span><br><span class=\"line\">            fastcgi_index index.php;</span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">            include fastcgi_params;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>cd &#x2F;home&#x2F;web&#x2F;html &amp;&amp; wget <a href=\"https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz\">https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz</a> &amp;&amp; apt install -y tar &amp;&amp; tar -zxvf 2.0.6-antibody.tar.gz &amp;&amp; rm 2.0.6-antibody.tar.gz</p>\n<p>å®‰è£…PHPæ‰©å±•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec php apt update &amp;&amp; docker exec php apt install -y libmariadb-dev-compat libmariadb-dev libzip-dev libmagickwand-dev imagemagick</span><br><span class=\"line\"></span><br><span class=\"line\">å¡æ­»åœ¨è¿™ä¸€æ­¥ï¼Œåˆ†è§£å¦‚ä¸‹ï¼š</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev-compat</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev</span><br><span class=\"line\">    docker exec php apt install -y libzip-dev</span><br><span class=\"line\">    docker exec php apt install -y libmagickwand-dev</span><br><span class=\"line\">        libmagickwand-dev is already the newest version (8:6.9.11.60+dfsg-1.3+deb11u1).</span><br><span class=\"line\">    docker exec php apt install -y imagemagick</span><br><span class=\"line\">        Build process completed successfully</span><br><span class=\"line\">        Installing &#x27;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#x27;</span><br><span class=\"line\">        install ok: channel://pecl.php.net/redis-6.0.2</span><br><span class=\"line\">        configuration option &quot;php_ini&quot; is not set to php.ini location</span><br><span class=\"line\">        You should add &quot;extension=redis.so&quot; to php.ini</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">docker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœç™»å½•æ—¶æŠ¥é”™å†ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œè§£é™¤HTTPSé™åˆ¶</p>\n<p>sed -i â€˜s&#x2F;ADMIN_HTTPS&#x3D;false&#x2F;ADMIN_HTTPS&#x3D;true&#x2F;gâ€™ &#x2F;home&#x2F;web&#x2F;html&#x2F;dujiaoka&#x2F;.env</p>\n<p>é”™è¯¯ä»¥åŠè§£å†³åŠæ³•<br>ä¸åŒæ—¶æœŸå†ç½‘é¡µé¡µé¢ï¼Œç‚¹å‡»å®‰è£…åå‡ºç°çš„é”™è¯¯</p>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><pre><code>è§£å†³ï¼šä¿®æ”¹äº†nginx.confï¼Œç¡®ä¿80å’Œ443ç«¯å£ï¼ˆdockerä¸­çš„ç«¯å£å ç”¨ï¼Œé»˜è®¤å³å¯ï¼‰\nç¡®è®¤äº†php dockerä¸­çš„PHPæ‰©å±•ï¼Œç¡®ä¿æ‰€æœ‰æ’ä»¶éƒ½å®‰è£…æˆåŠŸ\n</code></pre>\n<h3 id=\"Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\"><a href=\"#Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\" class=\"headerlink\" title=\"Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known\"></a>Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known</h3><pre><code>è§£å†³ï¼šsed -i &#39;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#39; /home/web/html/dujiaoka/.env\næ ¸æŸ¥äº†php dockerä¸­ å®‰è£…PHPæ‹“å±•éƒ¨åˆ†äºredisç›¸å…³çš„ï¼›\ndocker-php-ext-redis.iniï¼ˆå·²åŒ…å«å†…å®¹ï¼šextension=redis.soï¼‰\n\nåŸæ¥æ˜¯redis å†™æˆäº†radisï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h3 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)</h3><pre><code>è§£å†³ï¼šMySQLç”¨æˆ·åå¡«å†™é”™è¯¯ï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><pre><code>è§£å†³ï¼š\næ£€æµ‹ï¼šdocker exec -it php php -i |grep mysqlnd  æ’æŸ¥æ˜¯å¦å¯ç”¨äº†mysqlé©±åŠ¨\n    mysqlnd\n    mysqlnd =&gt; enabled\n    Version =&gt; mysqlnd 7.4.3\n\ndocker exec -it php /bin/bash\ndocker-php-ext-install pdo pdo_mysql\ndocker-compose restart php\n\nè¿™ä¸ªå¥½åƒæ²¡æœ‰è¢«æ°¸ä¹…ä¿å­˜ä½ï¼Œè¿™å¯¼è‡´æ¯æ¬¡docker-compose restart phpéƒ½ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯,\næŒ‰ç…§ä¸Šé¢è§£å†³å¥½ä»¥åï¼Œç´§æ¥ç€å°±æ˜¯ä¸‹é¢è¿™ä¸ªRedisé”™è¯¯\n\nè¿™æ¬¡æ˜¯ä¿®æ­£åï¼Œæœ€åæ˜¯é€šè¿‡docker restart php è§£å†³äº†é”™è¯¯\næµ‹è¯• docker-compose restart ä¼šä¸ä¼šæŠŠæ•°æ®åœ¨ç»§ç»­ç ´åäº†ï¼Œé‡æ–°æ‹‰å–ï¼Ÿ\n    ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼ é‚£ä¸‹ä¸€æ¬¡æ€ä¹ˆåŠï¼Ÿç»§ç»­å¦‚æ­¤ä¿®å¤å³å¯\n</code></pre>\n<h4 id=\"Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\"><a href=\"#Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\" class=\"headerlink\" title=\"Please make sure the PHP Redis extension is installed and enabled.\"></a>Please make sure the PHP Redis extension is installed and enabled.</h4><pre><code>docker exec -it php /bin/bash\npecl install redis\n    checking for igbinary includes... configure: error: Cannot find igbinary.h\n        ERROR: `/tmp/pear/temp/redis/configure --with-php-config=/usr/local/bin/php-config --enable-redis-igbinary=yes --enable-redis-lzf=yes --enable-redis-zstd=yes --enable-redis-msgpack=yes --enable-redis-lz4=yes --with-liblz4&#39; failed\nBuild process completed successfully\nInstalling &#39;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#39;\ninstall ok: channel://pecl.php.net/redis-6.0.2\nconfiguration option &quot;php_ini&quot; is not set to php.ini location\nYou should add &quot;extension=redis.so&quot; to php.ini\n\nè§£å†³ï¼šdocker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#39;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#39;\nè§£å†³åˆ†è§£ï¼Œå¹¶é€ä¸€ç¡®è®¤æ‰§è¡ŒæˆåŠŸ\n    docker exec -it php /bin/bash\n        docker-php-ext-install pdo_mysql zip bcmath gd intl opcache\n        pecl install redis\n        sh -c &#39;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#39;\nåœ¨ bash ä¸‹ï¼Œä¸€ä¸€æ‰§è¡Œï¼Œæ£€æŸ¥ç»“æœ\n\næœ€åï¼Œéœ€è¦docker-compose restart\nä¹‹å‰éƒ½æ˜¯é‡å¯phpå®¹å™¨docker restart php æ— æ³•è§£å†³é—®é¢˜ã€‚éœ€è¦çš„æ˜¯ï¼šdocker-compose restart\n</code></pre>\n<h4 id=\"0-error\"><a href=\"#0-error\" class=\"headerlink\" title=\"0 error\"></a>0 error</h4><pre><code>å®‰è£…æˆåŠŸå redirect https://192.168.6.116:4444/admin/auth/login\n# åå°ç™»å½•å‡ºç°0erræˆ–è€…å…¶ä»–ç™»å½•å¼‚å¸¸é—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯å¼€å¯äº†httpsè€Œåå°æ²¡æœ‰å¼€å¯ï¼ŒæŠŠä¸‹é¢çš„falseæ”¹ä¸ºtrueå³å¯\nADMIN_HTTPS=false\nè§£å†³ï¼šsed -i &#39;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#39; /home/web/html/dujiaoka/.env\n\næˆåŠŸäº†ï¼Œæœ¬åœ°å±€åŸŸç½‘å¯è®¿é—®ã€‚\nä¸‹ä¸€æ­¥æ˜¯ä¸ºä½•æ— æ³•NPMåä»£https://192.168.6.116:4444\n</code></pre>\n<h4 id=\"outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\"><a href=\"#outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\" class=\"headerlink\" title=\"[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError\"></a>[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError</h4><pre><code>Call to undefined function App\\Service\\bcmul()\nhttps://192.168.6.116:4444/create-order\n</code></pre>\n<h4 id=\"outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-top-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"><a href=\"#outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-top-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\" class=\"headerlink\" title=\"[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ https://buy.carlzeng.top:4443/ å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"></a>[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ <a href=\"https://buy.carlzeng.top:4443/\">https://buy.carlzeng.top:4443/</a> å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦</h4><h4 id=\"é‡å‘½åinstall-lock-é‡è£…\"><a href=\"#é‡å‘½åinstall-lock-é‡è£…\" class=\"headerlink\" title=\"é‡å‘½åinstall.lock é‡è£…\"></a>é‡å‘½åinstall.lock é‡è£…</h4><pre><code>é‡è£…åæ•°æ®é‡æ–°é…ç½®ï¼Œå¯¼è‡´è®¾ç½®çš„å•†å“ç­‰ç­‰å…¨éƒ¨æ¸…é›¶ï¼›ä¸Šé¢é—®é¢˜å¾…æµ‹è¯•\nURLè‡ªåŠ¨æºå¸¦ç«¯å£ï¼Œæ²¡æœ‰è§£å†³ã€‚\n</code></pre>\n","more":"<h1 id=\"æœ‰ä»€ä¹ˆç”¨\"><a href=\"#æœ‰ä»€ä¹ˆç”¨\" class=\"headerlink\" title=\"æœ‰ä»€ä¹ˆç”¨\"></a>æœ‰ä»€ä¹ˆç”¨</h1><p>è‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡<br>å°è¯•æŒ‰æ•™æå’Œè§†é¢‘æ­å»ºå¤±è´¥äº†ï¼ˆè¯¦è§ç« èŠ‚ï¼šæ­å»ºå¤±è´¥çš„å†å²è®°å½•ï¼‰ï¼Œ<br>é¼“èµ·å‹‡æ°”ï¼Œé‡æ–°é€‰ç”¨æ–°çš„æ–¹æ¡ˆï¼š<a href=\"https://blog.dov.moe/posts/49102/\">https://blog.dov.moe/posts/49102/</a></p>\n<p>ä¸¾ä¸ªğŸŒ°ä¾‹å­ï¼š<a href=\"https://dovshop.net/\">https://dovshop.net/</a></p>\n<h1 id=\"å®ç°æ–¹æ³•\"><a href=\"#å®ç°æ–¹æ³•\" class=\"headerlink\" title=\"å®ç°æ–¹æ³•\"></a>å®ç°æ–¹æ³•</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /www/server/panel/data/compose/dujiaoka/template</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir Shop &amp;&amp; cd Shop</span><br><span class=\"line\">mkdir storage uploads</span><br><span class=\"line\">chmod 777 storage uploads</span><br><span class=\"line\">â—æ³¨æ„æ­¤å¤„æ–‡ä»¶å¤¹æƒé™ä¸€å®šè¦ç»™ï¼</span><br><span class=\"line\"></span><br><span class=\"line\">chmod -R 777 env.conf</span><br><span class=\"line\"># é‡è¦æ­¥éª¤</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  faka:</span><br><span class=\"line\">    image: ghcr.io/apocalypsor/dujiaoka:latest</span><br><span class=\"line\">    # å›½å†…æœåŠ¡å™¨å¯ä»¥ç”¨ hkccr.ccs.tencentyun.com/apocalypsor/dujiaoka:latest</span><br><span class=\"line\">    container_name: faka</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">        # - INSTALL=false</span><br><span class=\"line\">        - INSTALL=true</span><br><span class=\"line\">        # - MODIFY=true</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./env.conf:/dujiaoka/.env</span><br><span class=\"line\">      - ./uploads:/dujiaoka/public/uploads</span><br><span class=\"line\">      - ./storage:/dujiaoka/storage</span><br><span class=\"line\">      - ./start-hook.sh:/dujiaoka/start-hook.sh</span><br><span class=\"line\">      # ç½‘ç«™å›¾æ ‡ 32X32 favicon.ico 4kbï¼Œé»˜è®¤æ¨¡ç‰ˆåªéœ€ç¬¬ä¸€å¤„ï¼Œå…¶ä»–æ¨¡ç‰ˆéœ€è¦ç¬¬äºŒå¤„</span><br><span class=\"line\">\t  - ./favicon.ico:/dujiaoka/public/favicon.ico:ro</span><br><span class=\"line\">\t  - ./favicon.ico:/dujiaoka/public/assets/style/favicon.ico:ro</span><br><span class=\"line\">\t  # é»˜è®¤å•†å“å›¾ç‰‡ 512x512 default.jpg 18kbï¼ˆç½‘ç«™ LOGO å…±äº«æ­¤å›¾ï¼Œä¸åå°è‡ªå®šä¹‰ LOGO å’Œå•†å“å›¾ç‰‡ä¸å†²çªï¼‰</span><br><span class=\"line\">\t  - ./default.png:/dujiaoka/public/assets/common/images/default.jpg:ro</span><br><span class=\"line\">\t  # Luna ä¸»é¢˜ç½‘ç«™èƒŒæ™¯ 1920x1224 background.png 198kb</span><br><span class=\"line\">\t  - ./background.png:/dujiaoka/public/assets/luna/img/background.png:ro</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 4444:80</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\"> </span><br><span class=\"line\">  db:</span><br><span class=\"line\">    image: mariadb:focal</span><br><span class=\"line\">    container_name: faka-data</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - MYSQL_ROOT_PASSWORD=mariadb</span><br><span class=\"line\">      - MYSQL_DATABASE=dujiaoka</span><br><span class=\"line\">      - MYSQL_USER=dujiaoka</span><br><span class=\"line\">      - MYSQL_PASSWORD=dujiaokapassword</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./data:/var/lib/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:alpine</span><br><span class=\"line\">    container_name: faka-redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–è¾‘ .env æ–‡ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">APP_NAME=Carlçš„å°åº—</span><br><span class=\"line\">APP_ENV=local</span><br><span class=\"line\">APP_KEY=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\">APP_DEBUG=false</span><br><span class=\"line\">APP_URL=http://192.168.6.116:4444</span><br><span class=\"line\">#ADMIN_HTTPS=true</span><br><span class=\"line\"></span><br><span class=\"line\">LOG_CHANNEL=stack</span><br><span class=\"line\"></span><br><span class=\"line\"># æ•°æ®åº“é…ç½®</span><br><span class=\"line\">DB_CONNECTION=mysql</span><br><span class=\"line\">DB_HOST=db</span><br><span class=\"line\">DB_PORT=3306</span><br><span class=\"line\">DB_DATABASE=dujiaoka</span><br><span class=\"line\">DB_USERNAME=dujiaoka</span><br><span class=\"line\">DB_PASSWORD=dujiaokapassword</span><br><span class=\"line\"></span><br><span class=\"line\"># redis é…ç½®</span><br><span class=\"line\">REDIS_HOST=redis</span><br><span class=\"line\">REDIS_PASSWORD=</span><br><span class=\"line\">REDIS_PORT=6379</span><br><span class=\"line\"></span><br><span class=\"line\">BROADCAST_DRIVER=log</span><br><span class=\"line\">SESSION_DRIVER=file</span><br><span class=\"line\">SESSION_LIFETIME=120</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># ç¼“å­˜é…ç½®</span><br><span class=\"line\"># file ä¸ºç£ç›˜æ–‡ä»¶  redis ä¸ºå†…å­˜çº§åˆ«</span><br><span class=\"line\"># redis ä¸ºå†…å­˜éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span><br><span class=\"line\">CACHE_DRIVER=redis</span><br><span class=\"line\"></span><br><span class=\"line\"># å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</span><br><span class=\"line\"># sync ä¸ºåŒæ­¥  redis ä¸ºå¼‚æ­¥</span><br><span class=\"line\"># ä½¿ç”¨ redis å¼‚æ­¥éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span><br><span class=\"line\">QUEUE_CONNECTION=redis</span><br><span class=\"line\"></span><br><span class=\"line\"># åå°è¯­è¨€</span><br><span class=\"line\">## zh_CN ç®€ä½“ä¸­æ–‡</span><br><span class=\"line\">## zh_TW ç¹ä½“ä¸­æ–‡</span><br><span class=\"line\">## en    è‹±æ–‡</span><br><span class=\"line\">DUJIAO_ADMIN_LANGUAGE=zh_CN</span><br><span class=\"line\"></span><br><span class=\"line\"># åå°ç™»å½•åœ°å€</span><br><span class=\"line\">ADMIN_ROUTE_PREFIX=/admin</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ç›´æ— æ³•ä¸‹è½½æˆåŠŸâ€¦â€¦<br>ä¿®æ”¹ä½¿ç”¨ï¼šstilleshan&#x2F;dujiaoka</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose+å¦‚ä½•ä½¿ç”¨ä»£ç†æé€Ÿ</span><br><span class=\"line\">\t\thttps://neucrack.com/p/286</span><br><span class=\"line\">\tworkaourndï¼šæ‰‹åŠ¨è®©OpenClashä¸åœåœ¨çº¿ï¼ˆä¸åœ¨çº¿å°±é‡æ–°åˆ·æ–°å–è·å–æœ€æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ç»ˆäºä¸‹è½½æˆåŠŸåï¼Œå¯åŠ¨å¤±è´¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting &quot;/www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico&quot; to rootfs at &quot;/dujiaoka/public/favicon.ico&quot;: mount /www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico:/dujiaoka/public/favicon.ico (via /proc/self/fd/6), flags: 0x5001: not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type</span><br></pre></td></tr></table></figure>\n<p>æ³¨é‡Šæ‰é‚£å‡ ä¸ªè‡ªå®šä¹‰çš„æ–‡ä»¶æ˜ å°„ï¼Œå°±å¥½äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">faka        | The environment file is invalid!</span><br><span class=\"line\">faka        | Failed to parse dotenv file due to unexpected whitespace. Failed at [Carl Shop].</span><br></pre></td></tr></table></figure>\n<p>è¿”å›ä¿®æ”¹æŠŠå‰ååŠ ä¸Šå¼•å·ã€‚</p>\n<p>ä¿®æ”¹äº†ç«¯å£æ˜ å°„å‡º4444åï¼Œé”™è¯¯ï¼š<br>500<br>Server Error</p>\n<p>â—æ³¨æ„ç¯å¢ƒå˜é‡å¦‚æœå†™çš„ä¸å¯¹å¯èƒ½å¯¼è‡´ 500ï¼Œå¯ä»¥å¼€ APP_DEBUG&#x3D;true çœ‹çœ‹å…·ä½“æ˜¯å“ªé‡Œå†™é”™äº†ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   throw new RuntimeException(&#x27;The only supported ciphers are AES-128-CBC and AES-256-CBC with the correct key lengths.&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">è§£å†³åŠæ³•ï¼šä¿®æ”¹APP_KEY=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\">--------------</span><br><span class=\"line\"></span><br><span class=\"line\">file_put_contents(/dujiaoka/.env): failed to open stream: Permission denied</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æœ¬åœ°è®¿é—®æˆåŠŸï¼š<a href=\"http://192.168.6.116:4444/\">http://192.168.6.116:4444</a></p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://hub.docker.com/r/stilleshan/dujiaoka\">https://hub.docker.com/r/stilleshan/dujiaoka</a><br><a href=\"https://hub.docker.com/r/jiangjuhong/dujiaoka\">https://hub.docker.com/r/jiangjuhong/dujiaoka</a></p>\n<hr>\n<hr>\n<h1 id=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"><a href=\"#æ­å»ºå¤±è´¥çš„å†å²è®°å½•\" class=\"headerlink\" title=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"></a>æ­å»ºå¤±è´¥çš„å†å²è®°å½•</h1><p>ç‹¬è§’æ•°å¡<br>å¼€æºå¼ç«™é•¿è‡ªåŠ¨åŒ–å”®è´§è§£å†³æ–¹æ¡ˆã€é«˜æ•ˆã€ç¨³å®šã€å¿«é€Ÿï¼</p>\n<p>å¾’æ‰‹æ­å»ºç‹¬è§’æ•°å‘å¡ç½‘ç«™ ç»è¥è‡ªå·±çš„å°åº—ï¼ - å…­æœˆ 26, 2023<br><a href=\"https://kejilion.blogspot.com/2023/06/blog-post_26.html\">https://kejilion.blogspot.com/2023/06/blog-post_26.html</a></p>\n<p>é…ç½®docker-compose<br><a href=\"https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml\">https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;3.8&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nginx:</span><br><span class=\"line\">    image: nginx:1.22</span><br><span class=\"line\">    container_name: nginx</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 882:80</span><br><span class=\"line\">      - 4444:443      </span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./nginx.conf:/etc/nginx/nginx.conf</span><br><span class=\"line\">      - ./certs:/etc/nginx/certs      </span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  php:</span><br><span class=\"line\">    image: php:7.4.33-fpm</span><br><span class=\"line\">    container_name: php</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  mysql:</span><br><span class=\"line\">    image: mysql:5.7.42</span><br><span class=\"line\">    container_name: mysql</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./mysql:/var/lib/mysql</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - MYSQL_ROOT_PASSWORD=webroot</span><br><span class=\"line\">      - MYSQL_DATABASE=web</span><br><span class=\"line\">      - MYSQL_USER=carlZeng</span><br><span class=\"line\">      - MYSQL_PASSWORD=carlZengYYDS</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:latest</span><br><span class=\"line\">    container_name: redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n<p>ä¿®æ”¹äº†ç‹¬è§’æ•°å¡çš„ç«¯å£</p>\n<p>ç”³è¯·è¯ä¹¦, ä¸‹è½½è¯ä¹¦;</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ç›´æ¥å»NPMä¸­ä¸‹è½½è¯ä¹¦è§£å‹ç¼©åé‡å‘½åæ”¾åˆ°debiançš„ç›®å½•ï¼š</span><br><span class=\"line\">/home/web/certs</span><br><span class=\"line\">    key.pem</span><br><span class=\"line\">    cert.pem</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p>ç»§ç»­é…ç½®nginx.conf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections 1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">    </span><br><span class=\"line\">    client_max_body_size 1000m;  </span><br><span class=\"line\">    #ä¸Šä¼ é™åˆ¶å‚æ•°1Gä»¥å†…æ–‡ä»¶å¯ä¸Šä¼ </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # HTTP server</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name shop.carlzeng.top;</span><br><span class=\"line\"></span><br><span class=\"line\">        # Redirect all HTTP requests to HTTPS</span><br><span class=\"line\">        return 301 https://$host$request_uri;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # HTTPS server</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443 ssl http2;</span><br><span class=\"line\">        server_name shop.carlzeng.top;</span><br><span class=\"line\"></span><br><span class=\"line\">        # http2 on;</span><br><span class=\"line\">            </span><br><span class=\"line\">        ssl_certificate /etc/nginx/certs/cert.pem;</span><br><span class=\"line\">        ssl_certificate_key /etc/nginx/certs/key.pem;</span><br><span class=\"line\"></span><br><span class=\"line\">        root /var/www/html/dujiaoka/public/;</span><br><span class=\"line\">        index index.php;</span><br><span class=\"line\"></span><br><span class=\"line\">        try_files $uri $uri/ /index.php?$query_string;    </span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">        # PHP-FPM configuration</span><br><span class=\"line\">        location ~ \\.php$ &#123;</span><br><span class=\"line\">            fastcgi_pass php:9000;</span><br><span class=\"line\">            fastcgi_index index.php;</span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">            include fastcgi_params;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>cd &#x2F;home&#x2F;web&#x2F;html &amp;&amp; wget <a href=\"https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz\">https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz</a> &amp;&amp; apt install -y tar &amp;&amp; tar -zxvf 2.0.6-antibody.tar.gz &amp;&amp; rm 2.0.6-antibody.tar.gz</p>\n<p>å®‰è£…PHPæ‰©å±•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec php apt update &amp;&amp; docker exec php apt install -y libmariadb-dev-compat libmariadb-dev libzip-dev libmagickwand-dev imagemagick</span><br><span class=\"line\"></span><br><span class=\"line\">å¡æ­»åœ¨è¿™ä¸€æ­¥ï¼Œåˆ†è§£å¦‚ä¸‹ï¼š</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev-compat</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev</span><br><span class=\"line\">    docker exec php apt install -y libzip-dev</span><br><span class=\"line\">    docker exec php apt install -y libmagickwand-dev</span><br><span class=\"line\">        libmagickwand-dev is already the newest version (8:6.9.11.60+dfsg-1.3+deb11u1).</span><br><span class=\"line\">    docker exec php apt install -y imagemagick</span><br><span class=\"line\">        Build process completed successfully</span><br><span class=\"line\">        Installing &#x27;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#x27;</span><br><span class=\"line\">        install ok: channel://pecl.php.net/redis-6.0.2</span><br><span class=\"line\">        configuration option &quot;php_ini&quot; is not set to php.ini location</span><br><span class=\"line\">        You should add &quot;extension=redis.so&quot; to php.ini</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">docker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœç™»å½•æ—¶æŠ¥é”™å†ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œè§£é™¤HTTPSé™åˆ¶</p>\n<p>sed -i â€˜s&#x2F;ADMIN_HTTPS&#x3D;false&#x2F;ADMIN_HTTPS&#x3D;true&#x2F;gâ€™ &#x2F;home&#x2F;web&#x2F;html&#x2F;dujiaoka&#x2F;.env</p>\n<p>é”™è¯¯ä»¥åŠè§£å†³åŠæ³•<br>ä¸åŒæ—¶æœŸå†ç½‘é¡µé¡µé¢ï¼Œç‚¹å‡»å®‰è£…åå‡ºç°çš„é”™è¯¯</p>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><pre><code>è§£å†³ï¼šä¿®æ”¹äº†nginx.confï¼Œç¡®ä¿80å’Œ443ç«¯å£ï¼ˆdockerä¸­çš„ç«¯å£å ç”¨ï¼Œé»˜è®¤å³å¯ï¼‰\nç¡®è®¤äº†php dockerä¸­çš„PHPæ‰©å±•ï¼Œç¡®ä¿æ‰€æœ‰æ’ä»¶éƒ½å®‰è£…æˆåŠŸ\n</code></pre>\n<h3 id=\"Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\"><a href=\"#Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\" class=\"headerlink\" title=\"Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known\"></a>Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known</h3><pre><code>è§£å†³ï¼šsed -i &#39;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#39; /home/web/html/dujiaoka/.env\næ ¸æŸ¥äº†php dockerä¸­ å®‰è£…PHPæ‹“å±•éƒ¨åˆ†äºredisç›¸å…³çš„ï¼›\ndocker-php-ext-redis.iniï¼ˆå·²åŒ…å«å†…å®¹ï¼šextension=redis.soï¼‰\n\nåŸæ¥æ˜¯redis å†™æˆäº†radisï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h3 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)</h3><pre><code>è§£å†³ï¼šMySQLç”¨æˆ·åå¡«å†™é”™è¯¯ï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><pre><code>è§£å†³ï¼š\næ£€æµ‹ï¼šdocker exec -it php php -i |grep mysqlnd  æ’æŸ¥æ˜¯å¦å¯ç”¨äº†mysqlé©±åŠ¨\n    mysqlnd\n    mysqlnd =&gt; enabled\n    Version =&gt; mysqlnd 7.4.3\n\ndocker exec -it php /bin/bash\ndocker-php-ext-install pdo pdo_mysql\ndocker-compose restart php\n\nè¿™ä¸ªå¥½åƒæ²¡æœ‰è¢«æ°¸ä¹…ä¿å­˜ä½ï¼Œè¿™å¯¼è‡´æ¯æ¬¡docker-compose restart phpéƒ½ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯,\næŒ‰ç…§ä¸Šé¢è§£å†³å¥½ä»¥åï¼Œç´§æ¥ç€å°±æ˜¯ä¸‹é¢è¿™ä¸ªRedisé”™è¯¯\n\nè¿™æ¬¡æ˜¯ä¿®æ­£åï¼Œæœ€åæ˜¯é€šè¿‡docker restart php è§£å†³äº†é”™è¯¯\næµ‹è¯• docker-compose restart ä¼šä¸ä¼šæŠŠæ•°æ®åœ¨ç»§ç»­ç ´åäº†ï¼Œé‡æ–°æ‹‰å–ï¼Ÿ\n    ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼ é‚£ä¸‹ä¸€æ¬¡æ€ä¹ˆåŠï¼Ÿç»§ç»­å¦‚æ­¤ä¿®å¤å³å¯\n</code></pre>\n<h4 id=\"Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\"><a href=\"#Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\" class=\"headerlink\" title=\"Please make sure the PHP Redis extension is installed and enabled.\"></a>Please make sure the PHP Redis extension is installed and enabled.</h4><pre><code>docker exec -it php /bin/bash\npecl install redis\n    checking for igbinary includes... configure: error: Cannot find igbinary.h\n        ERROR: `/tmp/pear/temp/redis/configure --with-php-config=/usr/local/bin/php-config --enable-redis-igbinary=yes --enable-redis-lzf=yes --enable-redis-zstd=yes --enable-redis-msgpack=yes --enable-redis-lz4=yes --with-liblz4&#39; failed\nBuild process completed successfully\nInstalling &#39;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#39;\ninstall ok: channel://pecl.php.net/redis-6.0.2\nconfiguration option &quot;php_ini&quot; is not set to php.ini location\nYou should add &quot;extension=redis.so&quot; to php.ini\n\nè§£å†³ï¼šdocker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#39;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#39;\nè§£å†³åˆ†è§£ï¼Œå¹¶é€ä¸€ç¡®è®¤æ‰§è¡ŒæˆåŠŸ\n    docker exec -it php /bin/bash\n        docker-php-ext-install pdo_mysql zip bcmath gd intl opcache\n        pecl install redis\n        sh -c &#39;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#39;\nåœ¨ bash ä¸‹ï¼Œä¸€ä¸€æ‰§è¡Œï¼Œæ£€æŸ¥ç»“æœ\n\næœ€åï¼Œéœ€è¦docker-compose restart\nä¹‹å‰éƒ½æ˜¯é‡å¯phpå®¹å™¨docker restart php æ— æ³•è§£å†³é—®é¢˜ã€‚éœ€è¦çš„æ˜¯ï¼šdocker-compose restart\n</code></pre>\n<h4 id=\"0-error\"><a href=\"#0-error\" class=\"headerlink\" title=\"0 error\"></a>0 error</h4><pre><code>å®‰è£…æˆåŠŸå redirect https://192.168.6.116:4444/admin/auth/login\n# åå°ç™»å½•å‡ºç°0erræˆ–è€…å…¶ä»–ç™»å½•å¼‚å¸¸é—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯å¼€å¯äº†httpsè€Œåå°æ²¡æœ‰å¼€å¯ï¼ŒæŠŠä¸‹é¢çš„falseæ”¹ä¸ºtrueå³å¯\nADMIN_HTTPS=false\nè§£å†³ï¼šsed -i &#39;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#39; /home/web/html/dujiaoka/.env\n\næˆåŠŸäº†ï¼Œæœ¬åœ°å±€åŸŸç½‘å¯è®¿é—®ã€‚\nä¸‹ä¸€æ­¥æ˜¯ä¸ºä½•æ— æ³•NPMåä»£https://192.168.6.116:4444\n</code></pre>\n<h4 id=\"outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\"><a href=\"#outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\" class=\"headerlink\" title=\"[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError\"></a>[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError</h4><pre><code>Call to undefined function App\\Service\\bcmul()\nhttps://192.168.6.116:4444/create-order\n</code></pre>\n<h4 id=\"outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-top-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"><a href=\"#outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-top-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\" class=\"headerlink\" title=\"[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ https://buy.carlzeng.top:4443/ å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"></a>[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ <a href=\"https://buy.carlzeng.top:4443/\">https://buy.carlzeng.top:4443/</a> å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦</h4><h4 id=\"é‡å‘½åinstall-lock-é‡è£…\"><a href=\"#é‡å‘½åinstall-lock-é‡è£…\" class=\"headerlink\" title=\"é‡å‘½åinstall.lock é‡è£…\"></a>é‡å‘½åinstall.lock é‡è£…</h4><pre><code>é‡è£…åæ•°æ®é‡æ–°é…ç½®ï¼Œå¯¼è‡´è®¾ç½®çš„å•†å“ç­‰ç­‰å…¨éƒ¨æ¸…é›¶ï¼›ä¸Šé¢é—®é¢˜å¾…æµ‹è¯•\nURLè‡ªåŠ¨æºå¸¦ç«¯å£ï¼Œæ²¡æœ‰è§£å†³ã€‚\n</code></pre>","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"docker-compose","path":"api/tags/docker-compose.json"},{"name":"docker","path":"api/tags/docker.json"},{"name":"debian","path":"api/tags/debian.json"},{"name":"è‡ªåŠ¨å”®è´§ç³»ç»Ÿ","path":"api/tags/è‡ªåŠ¨å”®è´§ç³»ç»Ÿ.json"},{"name":"ç‹¬è§’æ•°å¡","path":"api/tags/ç‹¬è§’æ•°å¡.json"},{"name":"NPM","path":"api/tags/NPM.json"}]}