{"title":"加速Docker Pull或者docker-compose拉取镜像 - 适用github源","slug":"加速Docker-Pull或者docker-compose拉取镜像-适用github源","date":"2023-12-26T15:15:34.000Z","updated":"2024-10-25T12:32:22.209Z","comments":true,"path":"api/articles/加速Docker-Pull或者docker-compose拉取镜像-适用github源.json","excerpt":" [Figure] 为github的docker源提速","covers":["https://img.carlzeng.com:3/i/2024/07/02/668349f7dd3fd.png","https://img.carlzeng.com:3/i/2024/07/02/668351e1c0d0a.png"],"content":"<img class=\"lozad\" data-src=\"\">\n\n<p>为github的docker源提速</p>\n<span id=\"more\"></span>\n\n<p>下载zlib（github上的）非常幸苦，速度极慢</p>\n<p>找到了大神的文章：<a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">加速docker pull</a></p>\n<h1 id=\"有什么用\"><a href=\"#有什么用\" class=\"headerlink\" title=\"有什么用\"></a>有什么用</h1><p>为github的docker源提速，比如：</p>\n<p>ghcr.io&#x2F;zlib-searcher&#x2F;zlib-searcher:latest</p>\n<p>ghcr.io&#x2F;puzzithinker&#x2F;zlib-searcher:master</p>\n<h1 id=\"怎么用\"><a href=\"#怎么用\" class=\"headerlink\" title=\"怎么用\"></a>怎么用</h1><ol>\n<li>配置http-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTP_PROXY=http://192.168.1.1:7890&quot;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>配置https-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTPS_PROXY=http://192.168.1.1:7890&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">这个设置是难点，踩坑折腾了半小时左右，一直监控着clash.meta的UI，docker pull过程到底有没有走proxy，设置对了以后，速度果然一下子，嗖.....</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>重启服务</li>\n</ol>\n   <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl daemon-reload</span><br><span class=\"line\">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>监控一下是否正常走了设置的代理</li>\n</ol>\n<h1 id=\"相关内容\"><a href=\"#相关内容\" class=\"headerlink\" title=\"相关内容\"></a>相关内容</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.com:3/appsearch?q=docker\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n\n<h1 id=\"灵感来源\"><a href=\"#灵感来源\" class=\"headerlink\" title=\"灵感来源\"></a>灵感来源</h1><p><a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86</a></p>\n<h1 id=\"假如Docker-image的源repository被删除了\"><a href=\"#假如Docker-image的源repository被删除了\" class=\"headerlink\" title=\"假如Docker image的源repository被删除了\"></a>假如Docker image的源repository被删除了</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You will need to save the Docker image as a tar file:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o &lt;path for generated tar file&gt; &lt;image name&gt;</span><br><span class=\"line\">Then copy your image to a new system with regular file transfer tools such as cp, scp, or rsync (preferred for big files). After that you will have to load the image into Docker:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker load -i &lt;path to image tar file&gt;</span><br><span class=\"line\">You should add filename (not just directory) with -o, for example:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o c:/myfile.tar centos:16</span><br><span class=\"line\">PS: You may need to sudo all commands.</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository\">https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository</a></p>\n<h2 id=\"将docker内文件拷贝到本地文件夹内\"><a href=\"#将docker内文件拷贝到本地文件夹内\" class=\"headerlink\" title=\"将docker内文件拷贝到本地文件夹内\"></a>将docker内文件拷贝到本地文件夹内</h2><pre><code>  docker cp 容器Id或name:容器内路径 本地文件夹路径\n  docker cp containername:/usr/share/nginx/html /volume2/KingchuxingSSD512G/docker/compose/it-tools/html\n</code></pre>\n<p>反之亦然</p>\n<hr>\n<h1 id=\"NAS中无法使用该文方案\"><a href=\"#NAS中无法使用该文方案\" class=\"headerlink\" title=\"NAS中无法使用该文方案\"></a>NAS中无法使用该文方案</h1><p>失败错误：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ERROR: error pulling image configuration: Get &quot;https://production.cloudflare.docker.com/registry-v2/docker</span><br><span class=\"line\">/registry/v2/blobs/sha256/fe/fe9002effde28797931563f042679ea1e505026f90ddbd737ba9cc3d425f7b3a/data?verify=</span><br><span class=\"line\">1719848198-tPisG8yWTSP%2FS87aF2Ea40NhcOk%3D&quot;: dial tcp 157.240.12.35:443: i/o timeout  </span><br></pre></td></tr></table></figure>\n\n<p>环境NAS中 docker pull alfg&#x2F;nginx-rtmp</p>\n<p>docker pull 如何走代理?</p>\n<p>执行像上面那样的步骤</p>\n<p>sudo systemctl daemon-reload<br>sudo systemctl restart docker</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl restart docker           </span><br><span class=\"line\">Failed to restart docker.service: Unit docker.service failed to load: No such file or directory.</span><br></pre></td></tr></table></figure>\n\n<p>暂时放弃了该NAS中的docker，目前无法解决这个错误。（等待第二天自动重启后查看状态）</p>\n<ul>\n<li><p>切换到debian中可以正常pull（已经打了这个‘补丁’）</p>\n<p>&#x2F;www&#x2F;server&#x2F;panel&#x2F;data&#x2F;compose&#x2F;</p>\n</li>\n<li><p>或者 在docker-compose文件中 使用国内可用的镜像地址</p>\n<ul>\n<li>比如：registry.cn-hangzhou.aliyuncs.com&#x2F;ossrs&#x2F;srs:5</li>\n</ul>\n</li>\n</ul>\n<p><a href=\"https://www.cnblogs.com/anybt/p/13360807.html\">Docker 通过ffmpeg将rtsp转码为rtmp进行播放</a></p>\n<p>整个流程说明：<a href=\"https://github.com/AngryCodeDog/mydoc/blob/master/md_docment/rtsp%E8%BD%ACrtmp%E7%9B%B4%E6%92%AD.md\">rtsp转rtmp直播.md</a></p>\n<p>切换docker镜像到docker run -d -p 1935:1935 -p 8080:8080 alqutami&#x2F;rtmp-hls</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\">services:</span><br><span class=\"line\">    rtmp-hls:</span><br><span class=\"line\">        ports:</span><br><span class=\"line\">            - <span class=\"number\">1935</span>:<span class=\"number\">1935</span></span><br><span class=\"line\">            - <span class=\"number\">8113</span>:<span class=\"number\">8080</span></span><br><span class=\"line\">        image: alqutami/rtmp-hls</span><br></pre></td></tr></table></figure>\n\n<p>配置 nginx-hls.conf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx-hls.conf</span><br><span class=\"line\">....</span><br></pre></td></tr></table></figure>\n\n<p>是否需要做配置？</p>\n<p>上面这个方案的docker pull成功，但是无法正常启动；切换：</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\">services:</span><br><span class=\"line\">    rtmp-hls:</span><br><span class=\"line\">        ports:</span><br><span class=\"line\">            - <span class=\"number\">1935</span>:<span class=\"number\">1935</span></span><br><span class=\"line\">            - <span class=\"number\">8113</span>:<span class=\"number\">8080</span></span><br><span class=\"line\">        image: polinux/rtmp-hls</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\"></span><br><span class=\"line\">推流</span><br><span class=\"line\">ffmpeg -i <span class=\"string\">&quot;rtsp://admin:dahua123@192.168.6.126:554&quot;</span> -f flv -r <span class=\"number\">25</span> -an rtmp://<span class=\"number\">192.168</span>.<span class=\"number\">6.116</span>:<span class=\"number\">1935</span>/live/test</span><br></pre></td></tr></table></figure>\n\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/07/02/668349f7dd3fd.png\" alt=\"image-20240702082940511\"></p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/07/02/668351e1c0d0a.png\" alt=\"image-20240702090326679\"></p>\n<p>推流</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -i &quot;rtsp://a:a@192.168.6.126:554&quot; -f flv -r 25 -an rtmp://192.168.6.116:1935/stream/test</span><br></pre></td></tr></table></figure>\n\n\n\n<p>使用镜像自带的players播放</p>\n<ul>\n<li>To play RTMP content (requires Flash): <code>http://localhost:8080/players/rtmp.html</code></li>\n<li>To play HLS content: <code>http://localhost:8080/players/hls.html</code></li>\n<li>To play HLS content using hls.js library: <code>http://localhost:8080/players/hls_hlsjs.html</code></li>\n<li>To play DASH content: <code>http://localhost:8080/players/dash.html</code></li>\n<li>To play RTMP and HLS contents on the same page: <code>http://localhost:8080/players/rtmp_hls.html</code></li>\n</ul>\n","more":"<p>下载zlib（github上的）非常幸苦，速度极慢</p>\n<p>找到了大神的文章：<a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">加速docker pull</a></p>\n<h1 id=\"有什么用\"><a href=\"#有什么用\" class=\"headerlink\" title=\"有什么用\"></a>有什么用</h1><p>为github的docker源提速，比如：</p>\n<p>ghcr.io&#x2F;zlib-searcher&#x2F;zlib-searcher:latest</p>\n<p>ghcr.io&#x2F;puzzithinker&#x2F;zlib-searcher:master</p>\n<h1 id=\"怎么用\"><a href=\"#怎么用\" class=\"headerlink\" title=\"怎么用\"></a>怎么用</h1><ol>\n<li>配置http-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTP_PROXY=http://192.168.1.1:7890&quot;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>配置https-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTPS_PROXY=http://192.168.1.1:7890&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">这个设置是难点，踩坑折腾了半小时左右，一直监控着clash.meta的UI，docker pull过程到底有没有走proxy，设置对了以后，速度果然一下子，嗖.....</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>重启服务</li>\n</ol>\n   <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl daemon-reload</span><br><span class=\"line\">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>监控一下是否正常走了设置的代理</li>\n</ol>\n<h1 id=\"相关内容\"><a href=\"#相关内容\" class=\"headerlink\" title=\"相关内容\"></a>相关内容</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.com:3/appsearch?q=docker\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n\n<h1 id=\"灵感来源\"><a href=\"#灵感来源\" class=\"headerlink\" title=\"灵感来源\"></a>灵感来源</h1><p><a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86</a></p>\n<h1 id=\"假如Docker-image的源repository被删除了\"><a href=\"#假如Docker-image的源repository被删除了\" class=\"headerlink\" title=\"假如Docker image的源repository被删除了\"></a>假如Docker image的源repository被删除了</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You will need to save the Docker image as a tar file:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o &lt;path for generated tar file&gt; &lt;image name&gt;</span><br><span class=\"line\">Then copy your image to a new system with regular file transfer tools such as cp, scp, or rsync (preferred for big files). After that you will have to load the image into Docker:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker load -i &lt;path to image tar file&gt;</span><br><span class=\"line\">You should add filename (not just directory) with -o, for example:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o c:/myfile.tar centos:16</span><br><span class=\"line\">PS: You may need to sudo all commands.</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository\">https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository</a></p>\n<h2 id=\"将docker内文件拷贝到本地文件夹内\"><a href=\"#将docker内文件拷贝到本地文件夹内\" class=\"headerlink\" title=\"将docker内文件拷贝到本地文件夹内\"></a>将docker内文件拷贝到本地文件夹内</h2><pre><code>  docker cp 容器Id或name:容器内路径 本地文件夹路径\n  docker cp containername:/usr/share/nginx/html /volume2/KingchuxingSSD512G/docker/compose/it-tools/html\n</code></pre>\n<p>反之亦然</p>\n<hr>\n<h1 id=\"NAS中无法使用该文方案\"><a href=\"#NAS中无法使用该文方案\" class=\"headerlink\" title=\"NAS中无法使用该文方案\"></a>NAS中无法使用该文方案</h1><p>失败错误：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ERROR: error pulling image configuration: Get &quot;https://production.cloudflare.docker.com/registry-v2/docker</span><br><span class=\"line\">/registry/v2/blobs/sha256/fe/fe9002effde28797931563f042679ea1e505026f90ddbd737ba9cc3d425f7b3a/data?verify=</span><br><span class=\"line\">1719848198-tPisG8yWTSP%2FS87aF2Ea40NhcOk%3D&quot;: dial tcp 157.240.12.35:443: i/o timeout  </span><br></pre></td></tr></table></figure>\n\n<p>环境NAS中 docker pull alfg&#x2F;nginx-rtmp</p>\n<p>docker pull 如何走代理?</p>\n<p>执行像上面那样的步骤</p>\n<p>sudo systemctl daemon-reload<br>sudo systemctl restart docker</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl restart docker           </span><br><span class=\"line\">Failed to restart docker.service: Unit docker.service failed to load: No such file or directory.</span><br></pre></td></tr></table></figure>\n\n<p>暂时放弃了该NAS中的docker，目前无法解决这个错误。（等待第二天自动重启后查看状态）</p>\n<ul>\n<li><p>切换到debian中可以正常pull（已经打了这个‘补丁’）</p>\n<p>&#x2F;www&#x2F;server&#x2F;panel&#x2F;data&#x2F;compose&#x2F;</p>\n</li>\n<li><p>或者 在docker-compose文件中 使用国内可用的镜像地址</p>\n<ul>\n<li>比如：registry.cn-hangzhou.aliyuncs.com&#x2F;ossrs&#x2F;srs:5</li>\n</ul>\n</li>\n</ul>\n<p><a href=\"https://www.cnblogs.com/anybt/p/13360807.html\">Docker 通过ffmpeg将rtsp转码为rtmp进行播放</a></p>\n<p>整个流程说明：<a href=\"https://github.com/AngryCodeDog/mydoc/blob/master/md_docment/rtsp%E8%BD%ACrtmp%E7%9B%B4%E6%92%AD.md\">rtsp转rtmp直播.md</a></p>\n<p>切换docker镜像到docker run -d -p 1935:1935 -p 8080:8080 alqutami&#x2F;rtmp-hls</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\">services:</span><br><span class=\"line\">    rtmp-hls:</span><br><span class=\"line\">        ports:</span><br><span class=\"line\">            - <span class=\"number\">1935</span>:<span class=\"number\">1935</span></span><br><span class=\"line\">            - <span class=\"number\">8113</span>:<span class=\"number\">8080</span></span><br><span class=\"line\">        image: alqutami/rtmp-hls</span><br></pre></td></tr></table></figure>\n\n<p>配置 nginx-hls.conf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx-hls.conf</span><br><span class=\"line\">....</span><br></pre></td></tr></table></figure>\n\n<p>是否需要做配置？</p>\n<p>上面这个方案的docker pull成功，但是无法正常启动；切换：</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\">services:</span><br><span class=\"line\">    rtmp-hls:</span><br><span class=\"line\">        ports:</span><br><span class=\"line\">            - <span class=\"number\">1935</span>:<span class=\"number\">1935</span></span><br><span class=\"line\">            - <span class=\"number\">8113</span>:<span class=\"number\">8080</span></span><br><span class=\"line\">        image: polinux/rtmp-hls</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\"></span><br><span class=\"line\">推流</span><br><span class=\"line\">ffmpeg -i <span class=\"string\">&quot;rtsp://admin:dahua123@192.168.6.126:554&quot;</span> -f flv -r <span class=\"number\">25</span> -an rtmp://<span class=\"number\">192.168</span>.<span class=\"number\">6.116</span>:<span class=\"number\">1935</span>/live/test</span><br></pre></td></tr></table></figure>\n\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/07/02/668349f7dd3fd.png\" alt=\"image-20240702082940511\"></p>\n<p><img data-src=\"https://img.carlzeng.com:3/i/2024/07/02/668351e1c0d0a.png\" alt=\"image-20240702090326679\"></p>\n<p>推流</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -i &quot;rtsp://a:a@192.168.6.126:554&quot; -f flv -r 25 -an rtmp://192.168.6.116:1935/stream/test</span><br></pre></td></tr></table></figure>\n\n\n\n<p>使用镜像自带的players播放</p>\n<ul>\n<li>To play RTMP content (requires Flash): <code>http://localhost:8080/players/rtmp.html</code></li>\n<li>To play HLS content: <code>http://localhost:8080/players/hls.html</code></li>\n<li>To play HLS content using hls.js library: <code>http://localhost:8080/players/hls_hlsjs.html</code></li>\n<li>To play DASH content: <code>http://localhost:8080/players/dash.html</code></li>\n<li>To play RTMP and HLS contents on the same page: <code>http://localhost:8080/players/rtmp_hls.html</code></li>\n</ul>","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","path":"api/tags/Docker.json"},{"name":"docker-compose","path":"api/tags/docker-compose.json"}]}