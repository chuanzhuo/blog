{"title":"加速Docker Pull或者docker-compose拉取镜像 - 适用github源","slug":"加速Docker-Pull或者docker-compose拉取镜像-适用github源","date":"2023-12-26T15:15:34.000Z","updated":"2024-01-07T09:09:39.623Z","comments":true,"path":"api/articles/加速Docker-Pull或者docker-compose拉取镜像-适用github源.json","excerpt":" [Figure] 为github的docker源提速","covers":null,"content":"<img class=\"lozad\" data-src=\"\">\n\n<p>为github的docker源提速</p>\n<span id=\"more\"></span>\n\n<p>下载zlib（github上的）非常幸苦，速度极慢</p>\n<p>找到了大神的文章：<a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">加速docker pull</a></p>\n<h1 id=\"有什么用\"><a href=\"#有什么用\" class=\"headerlink\" title=\"有什么用\"></a>有什么用</h1><p>为github的docker源提速，比如：</p>\n<p>ghcr.io&#x2F;zlib-searcher&#x2F;zlib-searcher:latest</p>\n<p>ghcr.io&#x2F;puzzithinker&#x2F;zlib-searcher:master</p>\n<h1 id=\"怎么用\"><a href=\"#怎么用\" class=\"headerlink\" title=\"怎么用\"></a>怎么用</h1><ol>\n<li>配置http-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTP_PROXY=http://192.168.1.1:7890&quot;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>配置https-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTPS_PROXY=http://192.168.1.1:7890&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">这个设置是难点，踩坑折腾了半小时左右，一直监控着clash.meta的UI，docker pull过程到底有没有走proxy，设置对了以后，速度果然一下子，嗖.....</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>重启服务</li>\n</ol>\n   <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl daemon-reload</span><br><span class=\"line\">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>监控一下是否正常走了设置的代理</li>\n</ol>\n<h1 id=\"相关内容\"><a href=\"#相关内容\" class=\"headerlink\" title=\"相关内容\"></a>相关内容</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.top:3/appsearch?q=docker\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n\n<h1 id=\"灵感来源\"><a href=\"#灵感来源\" class=\"headerlink\" title=\"灵感来源\"></a>灵感来源</h1><p><a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86</a></p>\n<h1 id=\"假如Docker-image的源repository被删除了\"><a href=\"#假如Docker-image的源repository被删除了\" class=\"headerlink\" title=\"假如Docker image的源repository被删除了\"></a>假如Docker image的源repository被删除了</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You will need to save the Docker image as a tar file:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o &lt;path for generated tar file&gt; &lt;image name&gt;</span><br><span class=\"line\">Then copy your image to a new system with regular file transfer tools such as cp, scp, or rsync (preferred for big files). After that you will have to load the image into Docker:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker load -i &lt;path to image tar file&gt;</span><br><span class=\"line\">You should add filename (not just directory) with -o, for example:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o c:/myfile.tar centos:16</span><br><span class=\"line\">PS: You may need to sudo all commands.</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository\">https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository</a></p>\n<h2 id=\"将docker内文件拷贝到本地文件夹内\"><a href=\"#将docker内文件拷贝到本地文件夹内\" class=\"headerlink\" title=\"将docker内文件拷贝到本地文件夹内\"></a>将docker内文件拷贝到本地文件夹内</h2><pre><code>  docker cp 容器Id或name:容器内路径 本地文件夹路径\n  docker cp containername:/usr/share/nginx/html /volume2/KingchuxingSSD512G/docker/compose/it-tools/html\n</code></pre>\n<p>反之亦然</p>\n","more":"<p>下载zlib（github上的）非常幸苦，速度极慢</p>\n<p>找到了大神的文章：<a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">加速docker pull</a></p>\n<h1 id=\"有什么用\"><a href=\"#有什么用\" class=\"headerlink\" title=\"有什么用\"></a>有什么用</h1><p>为github的docker源提速，比如：</p>\n<p>ghcr.io&#x2F;zlib-searcher&#x2F;zlib-searcher:latest</p>\n<p>ghcr.io&#x2F;puzzithinker&#x2F;zlib-searcher:master</p>\n<h1 id=\"怎么用\"><a href=\"#怎么用\" class=\"headerlink\" title=\"怎么用\"></a>怎么用</h1><ol>\n<li>配置http-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTP_PROXY=http://192.168.1.1:7890&quot;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>配置https-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTPS_PROXY=http://192.168.1.1:7890&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">这个设置是难点，踩坑折腾了半小时左右，一直监控着clash.meta的UI，docker pull过程到底有没有走proxy，设置对了以后，速度果然一下子，嗖.....</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>重启服务</li>\n</ol>\n   <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl daemon-reload</span><br><span class=\"line\">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>监控一下是否正常走了设置的代理</li>\n</ol>\n<h1 id=\"相关内容\"><a href=\"#相关内容\" class=\"headerlink\" title=\"相关内容\"></a>相关内容</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.top:3/appsearch?q=docker\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n\n<h1 id=\"灵感来源\"><a href=\"#灵感来源\" class=\"headerlink\" title=\"灵感来源\"></a>灵感来源</h1><p><a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86\">https://zu1k.com/posts/coding/speedup-docker-pull/#%E4%B8%BAdocker%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86</a></p>\n<h1 id=\"假如Docker-image的源repository被删除了\"><a href=\"#假如Docker-image的源repository被删除了\" class=\"headerlink\" title=\"假如Docker image的源repository被删除了\"></a>假如Docker image的源repository被删除了</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You will need to save the Docker image as a tar file:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o &lt;path for generated tar file&gt; &lt;image name&gt;</span><br><span class=\"line\">Then copy your image to a new system with regular file transfer tools such as cp, scp, or rsync (preferred for big files). After that you will have to load the image into Docker:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker load -i &lt;path to image tar file&gt;</span><br><span class=\"line\">You should add filename (not just directory) with -o, for example:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o c:/myfile.tar centos:16</span><br><span class=\"line\">PS: You may need to sudo all commands.</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository\">https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository</a></p>\n<h2 id=\"将docker内文件拷贝到本地文件夹内\"><a href=\"#将docker内文件拷贝到本地文件夹内\" class=\"headerlink\" title=\"将docker内文件拷贝到本地文件夹内\"></a>将docker内文件拷贝到本地文件夹内</h2><pre><code>  docker cp 容器Id或name:容器内路径 本地文件夹路径\n  docker cp containername:/usr/share/nginx/html /volume2/KingchuxingSSD512G/docker/compose/it-tools/html\n</code></pre>\n<p>反之亦然</p>","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"docker-compose","path":"api/tags/docker-compose.json"},{"name":"Docker","path":"api/tags/Docker.json"}]}