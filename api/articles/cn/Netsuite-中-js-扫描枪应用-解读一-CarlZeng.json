{"title":"Netsuite 中 js 扫描枪应用 解读一-CarlZeng","slug":"cn/Netsuite-中-js-扫描枪应用-解读一-CarlZeng","date":"2010-03-03T04:05:00.000Z","updated":"2023-10-08T14:21:10.120Z","comments":true,"path":"api/articles/cn/Netsuite-中-js-扫描枪应用-解读一-CarlZeng.json","excerpt":"function Syncdepartment(fieldspec, linenum, onlySlaveSelect, mach, addlparams){var sel = document.forms['item_form'].elements['department'+linenum];var value = sel != null ? getSelectValue(sel) ...","covers":null,"content":"<p>function Syncdepartment(fieldspec, linenum, onlySlaveSelect, mach, addlparams) { var sel &#x3D; document.forms[‘item_form’].elements[‘department’+linenum]; var value &#x3D; sel !&#x3D; null ? getSelectValue(sel) …</p>\n<!-- more -->\n<p>function Syncdepartment(fieldspec, linenum, onlySlaveSelect, mach, addlparams)<br>{<br>var sel &#x3D; document.forms[‘item_form’].elements[‘department’+linenum];<br>var value &#x3D; sel !&#x3D; null ? getSelectValue(sel) : -1;<br>if (value &#x3D;&#x3D; -1) {resetlist(sel);<br>nlOpenWindow(‘&#x2F;app&#x2F;common&#x2F;otherlists&#x2F;departmenttype.nl?target&#x3D;item:department’+linenum+’&amp;label&#x3D;Department’, ‘newitemdepartment’,’width&#x3D;400,height&#x3D;175,resizable&#x3D;yes,scrollbars&#x3D;no’);<br>return; }<br>sizeLowerTabBGDiv(‘item’);<br>}<br>function Listdepartment(fld, multi,linenum,addlparams) {<br>var displayField &#x3D; document.forms[‘item_form’].elements[‘department’+linenum];if ( displayField !&#x3D; null &amp;&amp; !displayField.isvalid) { displayField.isvalid &#x3D; true; window.isvalid &#x3D; true; displayField.value &#x3D; ‘’;}NLPopupSelect_displayLoadingDiv(‘department’, false);var serverUrl &#x3D; ‘&#x2F;app&#x2F;accounting&#x2F;transactions&#x2F;itemship.nl?cp&#x3D;T&amp;nexus&#x3D;1&amp;memdoc&#x3D;0&amp;transform&#x3D;salesord&amp;advbilltransform&#x3D;T&amp;at&#x3D;T&amp;cf&#x3D;305&amp;purchase&#x3D;F&amp;fromtrnfrord&#x3D;F&amp;shipper&#x3D;ns&amp;e&#x3D;T&amp;q&#x3D;department&amp;id&#x3D;’+trim(document.forms[‘main_form’].elements[‘id’].value)+’&amp;l&#x3D;T&amp;t&#x3D;item:department&amp;machine&#x3D;item’+(multi ? ‘&amp;multi&#x3D;T’ : ‘’)+’’+’&amp;ln&#x3D;’+linenum+(addlparams?’&amp;’+addlparams:’’)+’’;<br>document.getElementById(‘server_commands’).src&#x3D;serverUrl; }</p>\n<p>&#x2F;&#x2F;扫描枪自动回车以后查询扫描码的事件。</p>\n<p>function itemLocateField(val) {<br>var frm &#x3D; document.forms[‘item_form’];<br>var linenum &#x3D; findEncodedValue(‘item’,’itemname_selector’,val);<br>if (linenum &lt; 0)<br>linenum &#x3D; findEncodedValue(‘item’,’itemupc’,val);<br>if (linenum &gt;&#x3D; 0)<br>{ frm.elements[‘quantity’+linenum].value &#x3D; frm.elements[‘quantity’+linenum].value.length &#x3D;&#x3D; 0 ? ‘1’ : parseFloat(frm.elements[‘quantity’+linenum].value)+1;frm.elements[‘quantity’+linenum].onchange(); }<br>else alert(‘No Match.’); }</p>\n<p>function findEncodedValue(machine_name, fieldname, value)<br>{<br>var i &#x3D; getEncodedFieldPosition(machine_name, fieldname);<br>if (i &#x3D;&#x3D; -1)<br>return -1;<br>for (var linenum&#x3D;0;linenum &lt; getLineCount(machine_name);linenum++)<br>{<br>var linedata &#x3D; getLineArrayLine(machine_name,linenum);<br>if (value &#x3D;&#x3D; linedata[i])<br>return linenum+1;<br>}<br>return -1;<br>}<br>function getEncodedFieldPosition(machine_name, fieldname)<br>{<br>var fieldnames &#x3D; getFieldNamesArray(machine_name);<br>if ( fieldnames !&#x3D; null )<br>{</p>\n<p>return fieldnames[fieldname] !&#x3D; null ? fieldnames[fieldname] : -1;</p>\n<p>}<br>return -1;<br>}  </p>\n<p>货品编码不是动态去货品那里每次扫描去查询的，而在加载单据时，那么货品码早就在那里等待匹配了。这样效率就能有保证。 12:13 2010-03-03</p>\n<p>-—————————————————</p>\n<p>onblur</p>\n<input type=\"text\" id=\"item\\_autoenter\" onblur=\"if (this.checkvalid == true) {this.isvalid=validate\\_field(this,'text',false,false);} if (this.isvalid == false) { selectAndFocusField(this); return this.isvalid;}\" name=\"item\\_autoenter\" size=\"15\" onfocus=\"if (this.isvalid == true || this.isvalid == false) this.checkvalid=true;\" onchange=\"setWindowChanged(window, true);this.isvalid=validate\\_field(this,'text',true,false);this.checkvalid=false;if (this.isvalid) {if (value.length > 0) {itemLocateField(value); value='';};}if (this.isvalid) this.isvalid=validate\\_textfield\\_maxlen(this,60,true,true);if (!this.isvalid) { selectAndFocusField(this);}return this.isvalid;\" class=\"input\" onkeypress=\"if( getEventKeypress(event) == 13) { event.cancelBubble = true; if (value.length > 0) {itemLocateField(value); value=''; } else {NLDoMainFormButtonAction('submitter');} return false;}\" maxlength=\"60\"/>\n\n<p>event.cancelBubble &#x3D; true 用来阻止enter键向父级传递（导致系统会认为要保存单据了），itemLocateField(value); 是回车以后查询扫描码的事件。</p>\n","more":"<p>function Syncdepartment(fieldspec, linenum, onlySlaveSelect, mach, addlparams) { var sel &#x3D; document.forms[‘item_form’].elements[‘department’+linenum]; var value &#x3D; sel !&#x3D; null ? getSelectValue(sel) …</p>\n<!-- more -->\n<p>function Syncdepartment(fieldspec, linenum, onlySlaveSelect, mach, addlparams)<br>{<br>var sel &#x3D; document.forms[‘item_form’].elements[‘department’+linenum];<br>var value &#x3D; sel !&#x3D; null ? getSelectValue(sel) : -1;<br>if (value &#x3D;&#x3D; -1) {resetlist(sel);<br>nlOpenWindow(‘&#x2F;app&#x2F;common&#x2F;otherlists&#x2F;departmenttype.nl?target&#x3D;item:department’+linenum+’&amp;label&#x3D;Department’, ‘newitemdepartment’,’width&#x3D;400,height&#x3D;175,resizable&#x3D;yes,scrollbars&#x3D;no’);<br>return; }<br>sizeLowerTabBGDiv(‘item’);<br>}<br>function Listdepartment(fld, multi,linenum,addlparams) {<br>var displayField &#x3D; document.forms[‘item_form’].elements[‘department’+linenum];if ( displayField !&#x3D; null &amp;&amp; !displayField.isvalid) { displayField.isvalid &#x3D; true; window.isvalid &#x3D; true; displayField.value &#x3D; ‘’;}NLPopupSelect_displayLoadingDiv(‘department’, false);var serverUrl &#x3D; ‘&#x2F;app&#x2F;accounting&#x2F;transactions&#x2F;itemship.nl?cp&#x3D;T&amp;nexus&#x3D;1&amp;memdoc&#x3D;0&amp;transform&#x3D;salesord&amp;advbilltransform&#x3D;T&amp;at&#x3D;T&amp;cf&#x3D;305&amp;purchase&#x3D;F&amp;fromtrnfrord&#x3D;F&amp;shipper&#x3D;ns&amp;e&#x3D;T&amp;q&#x3D;department&amp;id&#x3D;’+trim(document.forms[‘main_form’].elements[‘id’].value)+’&amp;l&#x3D;T&amp;t&#x3D;item:department&amp;machine&#x3D;item’+(multi ? ‘&amp;multi&#x3D;T’ : ‘’)+’’+’&amp;ln&#x3D;’+linenum+(addlparams?’&amp;’+addlparams:’’)+’’;<br>document.getElementById(‘server_commands’).src&#x3D;serverUrl; }</p>\n<p>&#x2F;&#x2F;扫描枪自动回车以后查询扫描码的事件。</p>\n<p>function itemLocateField(val) {<br>var frm &#x3D; document.forms[‘item_form’];<br>var linenum &#x3D; findEncodedValue(‘item’,’itemname_selector’,val);<br>if (linenum &lt; 0)<br>linenum &#x3D; findEncodedValue(‘item’,’itemupc’,val);<br>if (linenum &gt;&#x3D; 0)<br>{ frm.elements[‘quantity’+linenum].value &#x3D; frm.elements[‘quantity’+linenum].value.length &#x3D;&#x3D; 0 ? ‘1’ : parseFloat(frm.elements[‘quantity’+linenum].value)+1;frm.elements[‘quantity’+linenum].onchange(); }<br>else alert(‘No Match.’); }</p>\n<p>function findEncodedValue(machine_name, fieldname, value)<br>{<br>var i &#x3D; getEncodedFieldPosition(machine_name, fieldname);<br>if (i &#x3D;&#x3D; -1)<br>return -1;<br>for (var linenum&#x3D;0;linenum &lt; getLineCount(machine_name);linenum++)<br>{<br>var linedata &#x3D; getLineArrayLine(machine_name,linenum);<br>if (value &#x3D;&#x3D; linedata[i])<br>return linenum+1;<br>}<br>return -1;<br>}<br>function getEncodedFieldPosition(machine_name, fieldname)<br>{<br>var fieldnames &#x3D; getFieldNamesArray(machine_name);<br>if ( fieldnames !&#x3D; null )<br>{</p>\n<p>return fieldnames[fieldname] !&#x3D; null ? fieldnames[fieldname] : -1;</p>\n<p>}<br>return -1;<br>}  </p>\n<p>货品编码不是动态去货品那里每次扫描去查询的，而在加载单据时，那么货品码早就在那里等待匹配了。这样效率就能有保证。 12:13 2010-03-03</p>\n<p>-—————————————————</p>\n<p>onblur</p>\n<input type=\"text\" id=\"item\\_autoenter\" onblur=\"if (this.checkvalid == true) {this.isvalid=validate\\_field(this,'text',false,false);} if (this.isvalid == false) { selectAndFocusField(this); return this.isvalid;}\" name=\"item\\_autoenter\" size=\"15\" onfocus=\"if (this.isvalid == true || this.isvalid == false) this.checkvalid=true;\" onchange=\"setWindowChanged(window, true);this.isvalid=validate\\_field(this,'text',true,false);this.checkvalid=false;if (this.isvalid) {if (value.length > 0) {itemLocateField(value); value='';};}if (this.isvalid) this.isvalid=validate\\_textfield\\_maxlen(this,60,true,true);if (!this.isvalid) { selectAndFocusField(this);}return this.isvalid;\" class=\"input\" onkeypress=\"if( getEventKeypress(event) == 13) { event.cancelBubble = true; if (value.length > 0) {itemLocateField(value); value=''; } else {NLDoMainFormButtonAction('submitter');} return false;}\" maxlength=\"60\"/>\n\n<p>event.cancelBubble &#x3D; true 用来阻止enter键向父级传递（导致系统会认为要保存单据了），itemLocateField(value); 是回车以后查询扫描码的事件。</p>\n","categories":[{"name":"NetSuite","path":"api/categories/NetSuite.json"}],"tags":[{"name":"NetSuite","path":"api/tags/NetSuite.json"}]}