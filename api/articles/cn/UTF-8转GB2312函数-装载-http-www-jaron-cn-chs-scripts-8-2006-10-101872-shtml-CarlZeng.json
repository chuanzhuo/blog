{"title":"UTF-8转GB2312函数 {装载 http://www.jaron.cn/chs_scripts/8/2006-10/101872.shtml}-CarlZeng","slug":"cn/UTF-8转GB2312函数-装载-http-www-jaron-cn-chs-scripts-8-2006-10-101872-shtml-CarlZeng","date":"2009-05-25T09:59:00.000Z","updated":"2023-10-02T02:27:28.983Z","comments":true,"path":"api/articles/cn/UTF-8转GB2312函数-装载-http-www-jaron-cn-chs-scripts-8-2006-10-101872-shtml-CarlZeng.json","excerpt":"<%'用途:將UTF-8編碼漢字轉換為GB2312碼，兼容英文和數字'版權:雖說是原創，其實也參考了別人的部分算法'用法:Response.write UTF2GB(\"%E9%83%BD%E5%B8%82%E6%83%85%E7%B7%A3 %E6%98%9F%E5%BA%A7\")function UTF2GB(UTFStr)for Dig=1 to len(UTFStr...","covers":null,"content":"<p>&lt;% ‘用途:將UTF-8編碼漢字轉換為GB2312碼，兼容英文和數字 ‘版權:雖說是原創，其實也參考了別人的部分算法 ‘用法:Response.write UTF2GB(“%E9%83%BD%E5%B8%82%E6%83%85%E7%B7%A3 %E6%98%9F%E5%BA%A7”) function UTF2GB(UTFStr) for Dig&#x3D;1 to len(UTFStr…</p>\n<!-- more -->\n<p>&lt;%<br>‘用途:將UTF-8編碼漢字轉換為GB2312碼，兼容英文和數字<br>‘版權:雖說是原創，其實也參考了別人的部分算法<br>‘用法:Response.write UTF2GB(“%E9%83%BD%E5%B8%82%E6%83%85%E7%B7%A3 %E6%98%9F%E5%BA%A7”)</p>\n<p>function UTF2GB(UTFStr)<br>for Dig&#x3D;1 to len(UTFStr)<br>if mid(UTFStr,Dig,1)&#x3D;”%” then<br>if len(UTFStr) &gt;&#x3D; Dig+8 then<br>GBStr&#x3D;GBStr &amp; ConvChinese(mid(UTFStr,Dig,9))<br>Dig&#x3D;Dig+8<br>else<br>GBStr&#x3D;GBStr &amp; mid(UTFStr,Dig,1)<br>end if<br>else<br>GBStr&#x3D;GBStr &amp; mid(UTFStr,Dig,1)<br>end if<br>next<br>UTF2GB&#x3D;GBStr<br>end function</p>\n<p>function ConvChinese(x)<br>A&#x3D;split(mid(x,2),”%”)<br>i&#x3D;0<br>j&#x3D;0</p>\n<p>for i&#x3D;0 to ubound(A)<br>A(i)&#x3D;c16to2(A(i))<br>next</p>\n<p>for i&#x3D;0 to ubound(A)-1<br>DigS&#x3D;instr(A(i),”0”)<br>Unicode&#x3D;””<br>for j&#x3D;1 to DigS-1<br>if j&#x3D;1 then<br>A(i)&#x3D;right(A(i),len(A(i))-DigS)<br>Unicode&#x3D;Unicode &amp; A(i)<br>else<br>i&#x3D;i+1<br>A(i)&#x3D;right(A(i),len(A(i))-2)<br>Unicode&#x3D;Unicode &amp; A(i)<br>end if<br>next</p>\n<p>if len(c2to16(Unicode))&#x3D;4 then<br>ConvChinese&#x3D;ConvChinese &amp; chrw(int(“&amp;H” &amp; c2to16(Unicode)))<br>else<br>ConvChinese&#x3D;ConvChinese &amp; chr(int(“&amp;H” &amp; c2to16(Unicode)))<br>end if<br>next<br>end function</p>\n<p>function c2to16(x)<br>i&#x3D;1<br>for i&#x3D;1 to len(x) step 4<br>c2to16&#x3D;c2to16 &amp; hex(c2to10(mid(x,i,4)))<br>next<br>end function</p>\n<p>function c2to10(x)<br>c2to10&#x3D;0<br>if x&#x3D;”0” then exit function<br>i&#x3D;0<br>for i&#x3D; 0 to len(x) -1<br>if mid(x,len(x)-i,1)&#x3D;”1” then c2to10&#x3D;c2to10+2^(i)<br>next<br>end function</p>\n<p>function c16to2(x)<br>i&#x3D;0<br>for i&#x3D;1 to len(trim(x))<br>tempstr&#x3D; c10to2(cint(int(“&amp;h” &amp; mid(x,i,1))))<br>do while len(tempstr)&lt;4<br>tempstr&#x3D;”0” &amp; tempstr<br>loop<br>c16to2&#x3D;c16to2 &amp; tempstr<br>next<br>end function</p>\n<p>function c10to2(x)<br>mysign&#x3D;sgn(x)<br>x&#x3D;abs(x)<br>DigS&#x3D;1<br>do<br>if x&lt;2^DigS then<br>exit do<br>else<br>DigS&#x3D;DigS+1<br>end if<br>loop<br>tempnum&#x3D;x</p>\n<p>i&#x3D;0<br>for i&#x3D;DigS to 1 step-1<br>if tempnum&gt;&#x3D;2^(i-1) then<br>tempnum&#x3D;tempnum-2^(i-1)<br>c10to2&#x3D;c10to2 &amp; “1”<br>else<br>c10to2&#x3D;c10to2 &amp; “0”<br>end if<br>next<br>if mysign&#x3D;-1 then c10to2&#x3D;”-“ &amp; c10to2<br>end function<br>%&gt;</p>\n","more":"<p>&lt;% ‘用途:將UTF-8編碼漢字轉換為GB2312碼，兼容英文和數字 ‘版權:雖說是原創，其實也參考了別人的部分算法 ‘用法:Response.write UTF2GB(“%E9%83%BD%E5%B8%82%E6%83%85%E7%B7%A3 %E6%98%9F%E5%BA%A7”) function UTF2GB(UTFStr) for Dig&#x3D;1 to len(UTFStr…</p>\n<!-- more -->\n<p>&lt;%<br>‘用途:將UTF-8編碼漢字轉換為GB2312碼，兼容英文和數字<br>‘版權:雖說是原創，其實也參考了別人的部分算法<br>‘用法:Response.write UTF2GB(“%E9%83%BD%E5%B8%82%E6%83%85%E7%B7%A3 %E6%98%9F%E5%BA%A7”)</p>\n<p>function UTF2GB(UTFStr)<br>for Dig&#x3D;1 to len(UTFStr)<br>if mid(UTFStr,Dig,1)&#x3D;”%” then<br>if len(UTFStr) &gt;&#x3D; Dig+8 then<br>GBStr&#x3D;GBStr &amp; ConvChinese(mid(UTFStr,Dig,9))<br>Dig&#x3D;Dig+8<br>else<br>GBStr&#x3D;GBStr &amp; mid(UTFStr,Dig,1)<br>end if<br>else<br>GBStr&#x3D;GBStr &amp; mid(UTFStr,Dig,1)<br>end if<br>next<br>UTF2GB&#x3D;GBStr<br>end function</p>\n<p>function ConvChinese(x)<br>A&#x3D;split(mid(x,2),”%”)<br>i&#x3D;0<br>j&#x3D;0</p>\n<p>for i&#x3D;0 to ubound(A)<br>A(i)&#x3D;c16to2(A(i))<br>next</p>\n<p>for i&#x3D;0 to ubound(A)-1<br>DigS&#x3D;instr(A(i),”0”)<br>Unicode&#x3D;””<br>for j&#x3D;1 to DigS-1<br>if j&#x3D;1 then<br>A(i)&#x3D;right(A(i),len(A(i))-DigS)<br>Unicode&#x3D;Unicode &amp; A(i)<br>else<br>i&#x3D;i+1<br>A(i)&#x3D;right(A(i),len(A(i))-2)<br>Unicode&#x3D;Unicode &amp; A(i)<br>end if<br>next</p>\n<p>if len(c2to16(Unicode))&#x3D;4 then<br>ConvChinese&#x3D;ConvChinese &amp; chrw(int(“&amp;H” &amp; c2to16(Unicode)))<br>else<br>ConvChinese&#x3D;ConvChinese &amp; chr(int(“&amp;H” &amp; c2to16(Unicode)))<br>end if<br>next<br>end function</p>\n<p>function c2to16(x)<br>i&#x3D;1<br>for i&#x3D;1 to len(x) step 4<br>c2to16&#x3D;c2to16 &amp; hex(c2to10(mid(x,i,4)))<br>next<br>end function</p>\n<p>function c2to10(x)<br>c2to10&#x3D;0<br>if x&#x3D;”0” then exit function<br>i&#x3D;0<br>for i&#x3D; 0 to len(x) -1<br>if mid(x,len(x)-i,1)&#x3D;”1” then c2to10&#x3D;c2to10+2^(i)<br>next<br>end function</p>\n<p>function c16to2(x)<br>i&#x3D;0<br>for i&#x3D;1 to len(trim(x))<br>tempstr&#x3D; c10to2(cint(int(“&amp;h” &amp; mid(x,i,1))))<br>do while len(tempstr)&lt;4<br>tempstr&#x3D;”0” &amp; tempstr<br>loop<br>c16to2&#x3D;c16to2 &amp; tempstr<br>next<br>end function</p>\n<p>function c10to2(x)<br>mysign&#x3D;sgn(x)<br>x&#x3D;abs(x)<br>DigS&#x3D;1<br>do<br>if x&lt;2^DigS then<br>exit do<br>else<br>DigS&#x3D;DigS+1<br>end if<br>loop<br>tempnum&#x3D;x</p>\n<p>i&#x3D;0<br>for i&#x3D;DigS to 1 step-1<br>if tempnum&gt;&#x3D;2^(i-1) then<br>tempnum&#x3D;tempnum-2^(i-1)<br>c10to2&#x3D;c10to2 &amp; “1”<br>else<br>c10to2&#x3D;c10to2 &amp; “0”<br>end if<br>next<br>if mysign&#x3D;-1 then c10to2&#x3D;”-“ &amp; c10to2<br>end function<br>%&gt;</p>\n","categories":[],"tags":[]}