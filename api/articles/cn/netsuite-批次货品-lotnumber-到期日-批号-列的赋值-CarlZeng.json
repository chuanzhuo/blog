{"title":"netsuite 批次货品 lotnumber 到期日/批号 列的赋值-CarlZeng","slug":"cn/netsuite-批次货品-lotnumber-到期日-批号-列的赋值-CarlZeng","date":"2009-01-07T03:44:00.000Z","updated":"2023-10-08T13:38:52.659Z","comments":true,"path":"api/articles/cn/netsuite-批次货品-lotnumber-到期日-批号-列的赋值-CarlZeng.json","excerpt":"在弹出的搜索页面，确认输入的批号时，函数的调用依次是：setTarget('21/2/2009-269852',21/2/2009-269852);function setTarget(s,i) {var frm,fldnam,fld;frm = parent.opener.document.forms.item_form;fldnam = 'serialnumbers';fld = parent...","covers":null,"content":"<p>在弹出的搜索页面，确认输入的批号时，函数的调用依次是：setTarget(‘21&#x2F;2&#x2F;2009-269852’,21&#x2F;2&#x2F;2009-269852);function setTarget(s,i) {var frm,fldnam,fld;frm &#x3D; parent.opener.document.forms.item_form;fldnam &#x3D; ‘serialnumbers’;fld &#x3D; parent…</p>\n<!-- more -->\n<p>在弹出的搜索页面，确认输入的批号时，</p>\n<p>函数的调用依次是：</p>\n<p>setTarget(‘21&#x2F;2&#x2F;2009-269852’,21&#x2F;2&#x2F;2009-269852);</p>\n<p>function setTarget(s,i) {<br>var frm,fldnam,fld;<br>frm &#x3D; parent.opener.document.forms.item_form;<br>fldnam &#x3D; ‘serialnumbers’;<br>fld &#x3D; parent.opener.getFormElement(frm,fldnam);<br>addMultiSelectValue(fld,i,s);<br>window.opener.setTimeout(function() { fld.onchange(); }, 0);;<br>}</p>\n<p>所有批号的赋值关键就在这个addMultiSelectValue(fld,i,s);中，我们接着来看：</p>\n<p>function addMultiSelectValue(sel, val, name)<br>{<br>if (isNLMultiDropDown(sel))<br>{<br>var dd &#x3D; getMultiDropdown(sel);<br>var idx &#x3D; dd.getIndexForValue(val);<br>dd.addIndex(idx);<br>}<br>else if (sel.type &#x3D;&#x3D; “select-multiple”)<br>{<br>var opts &#x3D; sel.options;<br>for (var i&#x3D;0; i &lt; opts.length; i++)<br>if ( opts[i].value &#x3D;&#x3D; val )<br>opts[i].selected &#x3D; true;<br>}<br>else<br>{<br>var values &#x3D; sel.value.split(String.fromCharCode(5));<br>for (var i&#x3D;0;i &lt; values.length;i++)<br>if (values[i] &#x3D;&#x3D; val) return;<br>sel.form.elements[sel.name+”_display”].style.color &#x3D; ‘000000’;<br>if (values.length &#x3D;&#x3D; 0 || values[0].length &#x3D;&#x3D; 0)<br>{<br>sel.value &#x3D; val;<br>sel.form.elements[sel.name+”_display”].value &#x3D; name;<br>sel.form.elements[sel.name+”_labels”].value &#x3D; name;<br>}<br>else<br>{<br>sel.value +&#x3D; String.fromCharCode(5)+val;<br>sel.form.elements[sel.name+”_labels”].value +&#x3D; String.fromCharCode(5)+name;<br>var lines &#x3D; sel.form.elements[sel.name+”_display”].value.split(&#x2F;\\n|\\r&#x2F;);<br>if (lines.length &#x3D;&#x3D; values.length)<br>sel.form.elements[sel.name+”_display”].value +&#x3D; “\\n”+name;<br>else<br>{<br>lines[values.length] &#x3D; name;<br>sel.form.elements[sel.name+”_display”].value &#x3D; lines.join(“\\n”);<br>}<br>}<br>}<br>}</p>\n<p>总结：document.item_form.elements[‘serialnumbers_display’].value&#x3D;’21&#x2F;2&#x2F;2009-269852’; 即可完成批号的批量赋值。。。</p>\n<p>当然：Syncserialnumbers(true);<br>nlapiFieldChanged(‘item’,this);<br>validateInventoryNumbers(); 可不能忘记罗。。。</p>\n<p>同样学到一点 ，如果elements 没有id 的话，用默认的 getElementById是取不到值的，在firefox下是这样的。所有系统被迫用了sel.form.elements[sel.name+”_display”].value 去赋值了。</p>\n<p>zeng.cz</p>\n<p>=&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;由于SO中的lotnumber的序列号列中所有填写的数量，受到SO界面中Location的影响，所以抓到的东西必须是过滤后的东西，而货品的编辑页面（<a href=\"https://system.netsuite.com/app/common/item/item.nl?id=42\">https://system.netsuite.com/app/common/item/item.nl?id=42</a>）的SubTab(numbers)有两个filter，</p>\n<p>一个是Synconhandfilter 另一个是Synclocationfilter ，所以现在取得这两个东西过滤后的东西 成为必须和关键要素。200901071758</p>\n<p>To Be Continued….</p>\n<p><a href=\"javascript:void(\"help\")\" title=\"What&#39;s this?\">View</a></p>\n<p>All On Hand</p>\n<p><a href=\"javascript:void(\"help\")\" title=\"What&#39;s this?\">Location</a></p>\n<p>MX库 NBTY NB库 广州库 总库房 总库房 : MX区 总库房 : NB区 总库房 : PP区 总库房 : 零时区域 缓冲库 赠品库</p>\n<ul>\n<li></li>\n</ul>\n<p>that’s the page we need to catch : <a href=\"https://system.netsuite.com/app/common/item/item.nl?itemtype=InvtPart&costingmethod=LOT&cf=7&id=%27+itemid+%27&q=locationfilter&si=%27+location+%27&si_onhandfilter=onhand&f=T&machine=numbers%27\">https://system.netsuite.com/app/common/item/item.nl?itemtype=InvtPart&costingmethod=LOT&cf=7&id='+itemid+'&q=locationfilter&si='+location+'&si_onhandfilter&#x3D;onhand&amp;f&#x3D;T&amp;machine&#x3D;numbers’</a></p>\n<p>itemid is the item’s internalId ; and location is the location’s InternalId;</p>\n<p>ok it’ come to more easyer…</p>\n","more":"<p>在弹出的搜索页面，确认输入的批号时，函数的调用依次是：setTarget(‘21&#x2F;2&#x2F;2009-269852’,21&#x2F;2&#x2F;2009-269852);function setTarget(s,i) {var frm,fldnam,fld;frm &#x3D; parent.opener.document.forms.item_form;fldnam &#x3D; ‘serialnumbers’;fld &#x3D; parent…</p>\n<!-- more -->\n<p>在弹出的搜索页面，确认输入的批号时，</p>\n<p>函数的调用依次是：</p>\n<p>setTarget(‘21&#x2F;2&#x2F;2009-269852’,21&#x2F;2&#x2F;2009-269852);</p>\n<p>function setTarget(s,i) {<br>var frm,fldnam,fld;<br>frm &#x3D; parent.opener.document.forms.item_form;<br>fldnam &#x3D; ‘serialnumbers’;<br>fld &#x3D; parent.opener.getFormElement(frm,fldnam);<br>addMultiSelectValue(fld,i,s);<br>window.opener.setTimeout(function() { fld.onchange(); }, 0);;<br>}</p>\n<p>所有批号的赋值关键就在这个addMultiSelectValue(fld,i,s);中，我们接着来看：</p>\n<p>function addMultiSelectValue(sel, val, name)<br>{<br>if (isNLMultiDropDown(sel))<br>{<br>var dd &#x3D; getMultiDropdown(sel);<br>var idx &#x3D; dd.getIndexForValue(val);<br>dd.addIndex(idx);<br>}<br>else if (sel.type &#x3D;&#x3D; “select-multiple”)<br>{<br>var opts &#x3D; sel.options;<br>for (var i&#x3D;0; i &lt; opts.length; i++)<br>if ( opts[i].value &#x3D;&#x3D; val )<br>opts[i].selected &#x3D; true;<br>}<br>else<br>{<br>var values &#x3D; sel.value.split(String.fromCharCode(5));<br>for (var i&#x3D;0;i &lt; values.length;i++)<br>if (values[i] &#x3D;&#x3D; val) return;<br>sel.form.elements[sel.name+”_display”].style.color &#x3D; ‘000000’;<br>if (values.length &#x3D;&#x3D; 0 || values[0].length &#x3D;&#x3D; 0)<br>{<br>sel.value &#x3D; val;<br>sel.form.elements[sel.name+”_display”].value &#x3D; name;<br>sel.form.elements[sel.name+”_labels”].value &#x3D; name;<br>}<br>else<br>{<br>sel.value +&#x3D; String.fromCharCode(5)+val;<br>sel.form.elements[sel.name+”_labels”].value +&#x3D; String.fromCharCode(5)+name;<br>var lines &#x3D; sel.form.elements[sel.name+”_display”].value.split(&#x2F;\\n|\\r&#x2F;);<br>if (lines.length &#x3D;&#x3D; values.length)<br>sel.form.elements[sel.name+”_display”].value +&#x3D; “\\n”+name;<br>else<br>{<br>lines[values.length] &#x3D; name;<br>sel.form.elements[sel.name+”_display”].value &#x3D; lines.join(“\\n”);<br>}<br>}<br>}<br>}</p>\n<p>总结：document.item_form.elements[‘serialnumbers_display’].value&#x3D;’21&#x2F;2&#x2F;2009-269852’; 即可完成批号的批量赋值。。。</p>\n<p>当然：Syncserialnumbers(true);<br>nlapiFieldChanged(‘item’,this);<br>validateInventoryNumbers(); 可不能忘记罗。。。</p>\n<p>同样学到一点 ，如果elements 没有id 的话，用默认的 getElementById是取不到值的，在firefox下是这样的。所有系统被迫用了sel.form.elements[sel.name+”_display”].value 去赋值了。</p>\n<p>zeng.cz</p>\n<p>=&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;由于SO中的lotnumber的序列号列中所有填写的数量，受到SO界面中Location的影响，所以抓到的东西必须是过滤后的东西，而货品的编辑页面（<a href=\"https://system.netsuite.com/app/common/item/item.nl?id=42\">https://system.netsuite.com/app/common/item/item.nl?id=42</a>）的SubTab(numbers)有两个filter，</p>\n<p>一个是Synconhandfilter 另一个是Synclocationfilter ，所以现在取得这两个东西过滤后的东西 成为必须和关键要素。200901071758</p>\n<p>To Be Continued….</p>\n<p><a href=\"javascript:void(\"help\")\" title=\"What&#39;s this?\">View</a></p>\n<p>All On Hand</p>\n<p><a href=\"javascript:void(\"help\")\" title=\"What&#39;s this?\">Location</a></p>\n<p>MX库 NBTY NB库 广州库 总库房 总库房 : MX区 总库房 : NB区 总库房 : PP区 总库房 : 零时区域 缓冲库 赠品库</p>\n<ul>\n<li></li>\n</ul>\n<p>that’s the page we need to catch : <a href=\"https://system.netsuite.com/app/common/item/item.nl?itemtype=InvtPart&costingmethod=LOT&cf=7&id=%27+itemid+%27&q=locationfilter&si=%27+location+%27&si_onhandfilter=onhand&f=T&machine=numbers%27\">https://system.netsuite.com/app/common/item/item.nl?itemtype=InvtPart&costingmethod=LOT&cf=7&id='+itemid+'&q=locationfilter&si='+location+'&si_onhandfilter&#x3D;onhand&amp;f&#x3D;T&amp;machine&#x3D;numbers’</a></p>\n<p>itemid is the item’s internalId ; and location is the location’s InternalId;</p>\n<p>ok it’ come to more easyer…</p>\n","categories":[{"name":"NetSuite","path":"api/categories/NetSuite.json"}],"tags":[{"name":"NetSuite","path":"api/tags/NetSuite.json"}]}