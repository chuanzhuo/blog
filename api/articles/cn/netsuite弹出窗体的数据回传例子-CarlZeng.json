{"title":"netsuite弹出窗体的数据回传例子-CarlZeng","slug":"cn/netsuite弹出窗体的数据回传例子-CarlZeng","date":"2008-11-12T02:57:00.000Z","updated":"2023-10-08T13:38:52.659Z","comments":true,"path":"api/articles/cn/netsuite弹出窗体的数据回传例子-CarlZeng.json","excerpt":"netsuite弹出窗体的数据回传例子这样如果顺利，你就能很多开发出一个 弹出的窗体（实现特殊的货品列表），回传单个或多项的货品会销售或采购订单。------------------------------------User Event suitescript beforeloadform.getSubList('item').addButton('custpage_name_print', '...","covers":null,"content":"<p>netsuite弹出窗体的数据回传例子这样如果顺利，你就能很多开发出一个 弹出的窗体（实现特殊的货品列表），回传单个或多项的货品会销售或采购订单。————————————User Event suitescript beforeloadform.getSubList(‘item’).addButton(‘custpage_name_print’, ‘…</p>\n<!-- more -->\n<p>netsuite弹出窗体的数据回传例子</p>\n<script language='Javascript'>  \nfunction setTarget(s,i) { //这个方法在用户点击一项货品时，回传到parent  \nvar frm,fldnam,fld;  \nfrm = parent.opener.document.forms.item\\_form;  \nfldnam = 'item';  \nfld = parent.opener.getFormElement(frm,fldnam);  \nvar displayfld = frm.elements\\[fldnam+'\\_display'\\];  \nif (displayfld != null) {  \ndisplayfld.value = s;  \nfld.value = i;  \n} else parent.opener.setFormValue(fld,i);  \nfld.onchange();  \nparent.close();  \n}\n\n  \nfunction addMultiple() { //这个方法在用户点击多项货品时，回传到parent  \nvar frm = document.forms\\[0\\];  \nvar items='';  \nfor (var i = 0; i < frm.elements.length; i++) {  \nelem = frm.elements\\[i\\];  \nif (elem.name.substring(0,3)=='qty' && elem.value.length>0 && !isNaN(parseFloat(elem.value)))  \nitems += (items.length > 0 ? String.fromCharCode(5) : '') +elem.name.substring(3)+'(' + parseFloat(elem.value) + ')';  \n}  \nwindow.opener.addSearchMultipleitem(items);  \nwindow.close();  \n}\n\n  \n</script>\n\n<p>这样如果顺利，你就能很多开发出一个 弹出的窗体（实现特殊的货品列表），回传单个或多项的货品会销售或采购订单。</p>\n<p>-———————————–</p>\n<p>User Event suitescript beforeload</p>\n<p>form.getSubList(‘item’).addButton(‘custpage_name_print’, ‘添加选配件’, “nlOpenWindow(‘suitelet url &amp;item&#x3D;’+passitem,750,500,true)”);</p>\n<p>说明：nlOpenWindow(‘&#x2F;app&#x2F;common&#x2F;search&#x2F;search.nl?l&#x3D;T&amp;searchtype&#x3D;Item’,750,500,true); 这个是用来实现弹窗的。</p>\n<p>现在的关键就是在suitelet中抓取这个passitem，然后通过这个条件按一定规律给用户生成一个item的列表，供用户选择和回传数据。</p>\n<p>suitelet： sublist</p>\n","more":"<p>netsuite弹出窗体的数据回传例子这样如果顺利，你就能很多开发出一个 弹出的窗体（实现特殊的货品列表），回传单个或多项的货品会销售或采购订单。————————————User Event suitescript beforeloadform.getSubList(‘item’).addButton(‘custpage_name_print’, ‘…</p>\n<!-- more -->\n<p>netsuite弹出窗体的数据回传例子</p>\n<script language='Javascript'>  \nfunction setTarget(s,i) { //这个方法在用户点击一项货品时，回传到parent  \nvar frm,fldnam,fld;  \nfrm = parent.opener.document.forms.item\\_form;  \nfldnam = 'item';  \nfld = parent.opener.getFormElement(frm,fldnam);  \nvar displayfld = frm.elements\\[fldnam+'\\_display'\\];  \nif (displayfld != null) {  \ndisplayfld.value = s;  \nfld.value = i;  \n} else parent.opener.setFormValue(fld,i);  \nfld.onchange();  \nparent.close();  \n}\n\n  \nfunction addMultiple() { //这个方法在用户点击多项货品时，回传到parent  \nvar frm = document.forms\\[0\\];  \nvar items='';  \nfor (var i = 0; i < frm.elements.length; i++) {  \nelem = frm.elements\\[i\\];  \nif (elem.name.substring(0,3)=='qty' && elem.value.length>0 && !isNaN(parseFloat(elem.value)))  \nitems += (items.length > 0 ? String.fromCharCode(5) : '') +elem.name.substring(3)+'(' + parseFloat(elem.value) + ')';  \n}  \nwindow.opener.addSearchMultipleitem(items);  \nwindow.close();  \n}\n\n  \n</script>\n\n<p>这样如果顺利，你就能很多开发出一个 弹出的窗体（实现特殊的货品列表），回传单个或多项的货品会销售或采购订单。</p>\n<p>-———————————–</p>\n<p>User Event suitescript beforeload</p>\n<p>form.getSubList(‘item’).addButton(‘custpage_name_print’, ‘添加选配件’, “nlOpenWindow(‘suitelet url &amp;item&#x3D;’+passitem,750,500,true)”);</p>\n<p>说明：nlOpenWindow(‘&#x2F;app&#x2F;common&#x2F;search&#x2F;search.nl?l&#x3D;T&amp;searchtype&#x3D;Item’,750,500,true); 这个是用来实现弹窗的。</p>\n<p>现在的关键就是在suitelet中抓取这个passitem，然后通过这个条件按一定规律给用户生成一个item的列表，供用户选择和回传数据。</p>\n<p>suitelet： sublist</p>\n","categories":[{"name":"NetSuite","path":"api/categories/NetSuite.json"}],"tags":[{"name":"NetSuite","path":"api/tags/NetSuite.json"}]}