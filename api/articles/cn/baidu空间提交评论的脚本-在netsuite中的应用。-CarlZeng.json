{"title":"baidu空间提交评论的脚本,在netsuite中的应用。-CarlZeng","slug":"cn/baidu空间提交评论的脚本-在netsuite中的应用。-CarlZeng","date":"2008-10-29T09:34:00.000Z","updated":"2023-10-08T13:38:52.659Z","comments":true,"path":"api/articles/cn/baidu空间提交评论的脚本-在netsuite中的应用。-CarlZeng.json","excerpt":"ok,让我们来分析一下，当用户输入完相应信息点击'发表评论'按钮时，触发：checkcmtform() （由 可得） 代码如下： function checkcmtform() { if(checkname(\"spBlogCmtor\")&&checkeandu(\"spBlogCmtURL\")&&checktext(\"spBlogCmtText\")&&cmtfull()) { s...","covers":null,"content":"<p>ok,让我们来分析一下，当用户输入完相应信息点击’发表评论’按钮时，触发：checkcmtform() （由 可得） 代码如下： function checkcmtform() { if(checkname(“spBlogCmtor”)&amp;&amp;checkeandu(“spBlogCmtURL”)&amp;&amp;checktext(“spBlogCmtText”)&amp;&amp;cmtfull()) { s…</p>\n<!-- more -->\n<p>ok,让我们来分析一下，当用户输入完相应信息点击’发表评论’按钮时，触发：checkcmtform()  </p>\n<p>（由&lt;form name=“form1” id=“popFormSubmit” action=“&#x2F;%CC%EC%CF%C2%BF%F1%C0%BD&#x2F;commit” method=“post” onSubmit=“return checkcmtform()”&gt;  </p>\n<p>可得）  </p>\n<p>代码如下：  </p>\n<p>function checkcmtform()  </p>\n<p>{  </p>\n<p>if(checkname(“spBlogCmtor”)&amp;&amp;checkeandu(“spBlogCmtURL”)&amp;&amp;checktext(“spBlogCmtText”)&amp;&amp;cmtfull())  </p>\n<p>{  </p>\n<p>submitForm();  </p>\n<p>return true;  </p>\n<p>}  </p>\n<p>else  </p>\n<p>{  </p>\n<p>return false;  </p>\n<p>}  </p>\n<p>}  </p>\n<p>var g_pop&#x3D;null;  </p>\n<p>function submitForm()  </p>\n<p>{  </p>\n<p>g_pop&#x3D;new Popup({ contentType:1,isReloadOnClose:false,width:340,height:80});  </p>\n<p>g_pop.setContent(“title”,”添加评论”);  </p>\n<p>g_pop.setContent(“contentUrl”,””);  </p>\n<p>g_pop.setContent(“someDisabledBtn”,”btn_ok”);  </p>\n<p>g_pop.build();  </p>\n<p>G(“popFormSubmit”).target&#x3D;g_pop.iframeIdName;  </p>\n<p>g_pop.show();  </p>\n<p>}  </p>\n<p>function g_close_pop()  </p>\n<p>{  </p>\n<p>g_pop.close();  </p>\n<p>}  </p>\n<p>这样，一个g_pop.setContent(“title”,”添加评论”);就开始创建一个窗体，并且蒙版了一个层，防止用户误操作影响提交相关评论到后台的功能。  </p>\n<p><a href=\"http://hi.baidu.com/js/popup.js\">http://hi.baidu.com/js/popup.js</a>  </p>\n<p>if(!Array.prototype.push){  </p>\n<p>Array.prototype.push&#x3D;function(){  </p>\n<p>var startLength&#x3D;this.length;  </p>\n<p>for(var i&#x3D;0;i&lt;arguments.length;i++)this[startLength+i]&#x3D;arguments[i];  </p>\n<p>return this.length}};  </p>\n<p>function G(){var elements&#x3D;new Array();  </p>\n<p>for(var i&#x3D;0;i&lt;arguments.length;i++)  </p>\n<p>{var element&#x3D;arguments[i];if(typeof element&#x3D;&#x3D;’string’)element&#x3D;document.getElementById(element);if(arguments.length&#x3D;&#x3D;1)return element;elements.push(element)};return elements};  </p>\n<p>Function.prototype.bind&#x3D;function(object){var __method&#x3D;this;return function(){__method.apply(object,arguments)}};Function.prototype.bindAsEventListener&#x3D;function(object){var __method&#x3D;this;return function(event){__method.call(object,event||window.event)}};Object.extend&#x3D;function(destination,source){for(property in source){destination[property]&#x3D;source[property]};return destination};if(!window.Event){var Event&#x3D;new Object()};Object.extend(Event,{observers:false,element:function(event){return event.target||event.srcElement},isLeftClick:function(event){return(((event.which)&amp;&amp;(event.which&#x3D;&#x3D;1))||((event.button)&amp;&amp;(event.button&#x3D;&#x3D;1)))},pointerX:function(event){return event.pageX||(event.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft))},pointerY:function(event){return event.pageY||(event.clientY+(document.documentElement.scrollTop||document.body.scrollTop))},stop:function(event){if(event.preventDefault){event.preventDefault();event.stopPropagation()}else{event.returnValue&#x3D;false;event.cancelBubble&#x3D;true}},findElement:function(event,tagName){var element&#x3D;Event.element(event);while(element.parentNode&amp;&amp;(!element.tagName||(element.tagName.toUpperCase()!&#x3D;tagName.toUpperCase())))element&#x3D;element.parentNode;return element},_observeAndCache:function(element,name,observer,useCapture){if(!this.observers)this.observers&#x3D;[];if(element.addEventListener){this.observers.push([element,name,observer,useCapture]);element.addEventListener(name,observer,useCapture)}else if(element.attachEvent){this.observers.push([element,name,observer,useCapture]);element.attachEvent(‘on’+name,observer)}},unloadCache:function(){if(!Event.observers)return;for(var i&#x3D;0;i&lt;Event.observers.length;i++){Event.stopObserving.apply(this,Event.observers[i]);Event.observers[i][0]&#x3D;null};Event.observers&#x3D;false},observe:function(element,name,observer,useCapture){var element&#x3D;G(element);useCapture&#x3D;useCapture||false;if(name&#x3D;&#x3D;’keypress’&amp;&amp;(navigator.appVersion.match(&#x2F;Konqueror|Safari|KHTML&#x2F;)||element.attachEvent))name&#x3D;’keydown’;this._observeAndCache(element,name,observer,useCapture)},stopObserving:function(element,name,observer,useCapture){var element&#x3D;G(element);useCapture&#x3D;useCapture||false;if(name&#x3D;&#x3D;’keypress’&amp;&amp;(navigator.appVersion.match(&#x2F;Konqueror|Safari|KHTML&#x2F;)||element.detachEvent))name&#x3D;’keydown’;if(element.removeEventListener){element.removeEventListener(name,observer,useCapture)}else if(element.detachEvent){element.detachEvent(‘on’+name,observer)}}});Event.observe(window,’unload’,Event.unloadCache,false);var Class&#x3D;function(){var _class&#x3D;function(){this.initialize.apply(this,arguments)};for(i&#x3D;0;i&lt;arguments.length;i++){superClass&#x3D;arguments[i];for(member in superClass.prototype){_class.prototype[member]&#x3D;superClass.prototype[member]}};_class.child&#x3D;function(){return new Class(this)};_class.extend&#x3D;function(f){for(property in f){_class.prototype[property]&#x3D;f[property]}};return _class};function space(flag){if(flag&#x3D;&#x3D;”begin”){var ele&#x3D;document.getElementById(“ft”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”ft_popup”;ele&#x3D;document.getElementById(“usrbar”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”usrbar_popup”}  </p>\n<p>else if(flag&#x3D;&#x3D;”end”){var ele&#x3D;document.getElementById(“ft_popup”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”ft”;ele&#x3D;document.getElementById(“usrbar_popup”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”usrbar”}};var Popup&#x3D;new Class();Popup.prototype&#x3D;{iframeIdName:’ifr_popup’,initialize:function(config){this.config&#x3D;Object.extend({contentType:1,isHaveTitle:true,scrollType:’no’,isBackgroundCanClick:false,isSupportDraging:true,isShowShadow:true,isReloadOnClose:true,width:400,height:300},config||{});this.info&#x3D;{shadowWidth:4,title:””,contentUrl:””,contentHtml:””,callBack:null,parameter:null,confirmCon:””,alertCon:””,someHiddenTag:”select,object,embed”,someDisabledBtn:””,someHiddenEle:””,overlay:0,coverOpacity:40};this.color&#x3D;{cColor:”#EEEEEE”,bColor:”#FFFFFF”,tColor:”#709CD2”,wColor:”#FFFFFF”};this.dropClass&#x3D;null;this.someToHidden&#x3D;[];this.someToDisabled&#x3D;[];if(!this.config.isHaveTitle)this.config.isSupportDraging&#x3D;false;this.iniBuild()},setContent:function(arrt,val){if(val!&#x3D;’’){switch(arrt){case ‘width’:this.config.width&#x3D;val;break;case ‘height’:this.config.height&#x3D;val;break;case ‘title’:this.info.title&#x3D;val;break;case ‘contentUrl’:this.info.contentUrl&#x3D;val;break;case ‘contentHtml’:this.info.contentHtml&#x3D;val;break;case ‘callBack’:this.info.callBack&#x3D;val;break;case ‘parameter’:this.info.parameter&#x3D;val;break;case ‘confirmCon’:this.info.confirmCon&#x3D;val;break;case ‘alertCon’:this.info.alertCon&#x3D;val;break;case ‘someHiddenTag’:this.info.someHiddenTag&#x3D;val;break;case ‘someHiddenEle’:this.info.someHiddenEle&#x3D;val;break;case ‘someDisabledBtn’:this.info.someDisabledBtn&#x3D;val;break;case ‘overlay’:this.info.overlay&#x3D;val}}},iniBuild:function(){G(‘dialogCase’)?G(‘dialogCase’).parentNode.removeChild(G(‘dialogCase’)):function(){};var oDiv&#x3D;document.createElement(‘span’);oDiv.id&#x3D;’dialogCase’;  </p>\n<p>document.body.appendChild(oDiv)},build:function(){var baseZIndex&#x3D;10001+this.info.overlay*10;var showZIndex&#x3D;baseZIndex+2;this.iframeIdName&#x3D;’ifr_popup’+this.info.overlay;var path&#x3D;”<a href=\"http://img.baidu.com/hi/img/%22;var\">http://img.baidu.com/hi/img/&quot;;var</a> close&#x3D;’<input type=\"image\" id=\"dialogBoxClose\" src=\"'+path+'dialogclose.gif\" border=\"0\" width=\"16\" height=\"16\" align=\"absmiddle\" title=\"关闭\"/>‘;var cB&#x3D;’filter: alpha(opacity&#x3D;’+this.info.coverOpacity+’);opacity:’+this.info.coverOpacity&#x2F;100+’;’;var cover&#x3D;’<div id=\"dialogBoxBG\" style=\"position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:'+baseZIndex+';'+cB+'background-color:'+this.color.cColor+';display:none;\"></div>‘;var mainBox&#x3D;’<div id=\"dialogBox\" style=\"border:1px solid '+this.color.tColor+';display:none;z-index:'+showZIndex+';position:relative;width:'+this.config.width+'px;\"><table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"'+this.color.bColor+'\">‘;if(this.config.isHaveTitle){mainBox+&#x3D;’<tr height=\"24\" bgcolor=\"'+this.color.tColor+'\"><td><table style=\"-moz-user-select:none;height:24px;\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" ><tr>‘+’<td width=\"6\" height=\"24\"></td><td id=\"dialogBoxTitle\" style=\"color:'+this.color.wColor+';font-size:14px;font-weight:bold;\">‘+this.info.title+’&nbsp;</td>‘+’<td id=\"dialogClose\" width=\"20\" align=\"right\" valign=\"middle\">‘+close+’</td><td width=\"6\"></td></tr></table></td></tr>‘}else{mainBox+&#x3D;’<tr height=\"10\"><td align=\"right\">‘+close+’</td></tr>‘};mainBox+&#x3D;’<tr style=\"height:'+this.config.height+'px\" valign=\"top\"><td id=\"dialogBody\" style=\"position:relative;\"></td></tr></table></div>‘+’<div id=\"dialogBoxShadow\" style=\"display:none;z-index:'+baseZIndex+';\"></div>‘;if(!this.config.isBackgroundCanClick){G(‘dialogCase’).innerHTML&#x3D;cover+mainBox;G(‘dialogBoxBG’).style.height&#x3D;document.body.scrollHeight}else G(‘dialogCase’).innerHTML&#x3D;mainBox;Event.observe(G(‘dialogBoxClose’),”click”,this.reset.bindAsEventListener(this),false);if(this.config.isSupportDraging){dropClass&#x3D;new Dragdrop(this.config.width,this.config.height,this.info.shadowWidth,this.config.isSupportDraging,this.config.contentType);G(“dialogBoxTitle”).style.cursor&#x3D;”move”};this.lastBuild()},lastBuild:function(){var confirm&#x3D;’<div style=\"width:100%;height:100%;text-align:center;\"><div style=\"margin:20px 20px 0 20px;font-size:14px;line-height:16px;color:#000000;\">‘+this.info.confirmCon+’</div>  </p>\n<div style=\"margin:20px;\"><input id=\"dialogOk\" type=\"button\" value=\"  确定  \"/>&nbsp;<input id=\"dialogCancel\" type=\"button\" value=\"  取消  \"/></div></div>';var alert='<div style=\"width:100%;height:100%;text-align:center;\"><div style=\"margin:20px 20px 0 20px;font-size:14px;line-height:16px;color:#000000;\">'+this.info.alertCon+'</div><div style=\"margin:20px;\"><input id=\"dialogYES\" type=\"button\" value=\"  确定  \"/></div></div>';var baseZIndex=10001+this.info.overlay\\*10;var coverIfZIndex=baseZIndex+4;if(this.config.contentType==1){var openIframe=\"<iframe width='100%' style='height:\"+this.config.height+\"px' name='\"+this.iframeIdName+\"' id='\"+this.iframeIdName+\"' src='\"+this.info.contentUrl+\"' frameborder='0' scrolling='\"+this.config.scrollType+\"'></iframe>\";var coverIframe=\"<div id='iframeBG' style='position:absolute;top:0px;left:0px;width:1px;height:1px;z-index:\"+coverIfZIndex+\";filter: alpha(opacity=00);opacity:0.00;background-color:#ffffff;'><div>\";G(\"dialogBody\").innerHTML=openIframe+coverIframe}else if(this.config.contentType==2){G(\"dialogBody\").innerHTML=this.info.contentHtml}else if(this.config.contentType==3){G(\"dialogBody\").innerHTML=confirm;Event.observe(G('dialogOk'),\"click\",this.forCallback.bindAsEventListener(this),false);Event.observe(G('dialogCancel'),\"click\",this.close.bindAsEventListener(this),false)}  \n  \n\n<p>else if(this.config.contentType&#x3D;&#x3D;4){G(“dialogBody”).innerHTML&#x3D;alert;Event.observe(G(‘dialogYES’),”click”,this.close.bindAsEventListener(this),false)}},reBuild:function(){G(‘dialogBody’).height&#x3D;G(‘dialogBody’).clientHeight;this.lastBuild()},show:function(){this.hiddenSome();this.middle();if(this.config.isShowShadow)this.shadow()},forCallback:function(){return this.info.callBack(this.info.parameter)},shadow:function(){var oShadow&#x3D;G(‘dialogBoxShadow’);var oDialog&#x3D;G(‘dialogBox’);oShadow[‘style’][‘position’]&#x3D;”absolute”;oShadow[‘style’][‘background’]&#x3D;”#000”;oShadow[‘style’][‘display’]&#x3D;””;oShadow[‘style’][‘opacity’]&#x3D;”0.2”;oShadow[‘style’][‘filter’]&#x3D;”alpha(opacity&#x3D;20)”;oShadow[‘style’][‘top’]&#x3D;oDialog.offsetTop+this.info.shadowWidth;oShadow[‘style’][‘left’]&#x3D;oDialog.offsetLeft+this.info.shadowWidth;oShadow[‘style’][‘width’]&#x3D;oDialog.offsetWidth;oShadow[‘style’][‘height’]&#x3D;oDialog.offsetHeight},middle:function(){if(!this.config.isBackgroundCanClick)G(‘dialogBoxBG’).style.display&#x3D;’’;var oDialog&#x3D;G(‘dialogBox’);oDialog[‘style’][‘position’]&#x3D;”absolute”;oDialog[‘style’][‘display’]&#x3D;’’;var sClientWidth&#x3D;document.body.clientWidth;var sClientHeight&#x3D;document.body.clientHeight;var sScrollTop&#x3D;document.body.scrollTop;var sleft&#x3D;(document.body.clientWidth&#x2F;2)-(oDialog.offsetWidth&#x2F;2);var iTop&#x3D;-80+(sClientHeight&#x2F;2+sScrollTop)-(oDialog.offsetHeight&#x2F;2);var sTop&#x3D;iTop&gt;0?iTop:(sClientHeight&#x2F;2+sScrollTop)-(oDialog.offsetHeight&#x2F;2);if(sTop&lt;1)sTop&#x3D;”20”;if(sleft&lt;1)sleft&#x3D;”20”;oDialog[‘style’][‘left’]&#x3D;sleft;oDialog[‘style’][‘top’]&#x3D;sTop},reset:function(){if(this.config.isReloadOnClose){top.location.reload()};this.close()},close:function(){G(‘dialogBox’).style.display&#x3D;’none’;if(!this.config.isBackgroundCanClick)G(‘dialogBoxBG’).style.display&#x3D;’none’;if(this.config.isShowShadow)G(‘dialogBoxShadow’).style.display&#x3D;’none’;G(‘dialogBody’).innerHTML&#x3D;’’;this.showSome()},hiddenSome:function(){var tag&#x3D;this.info.someHiddenTag.split(“,”);if(tag.length&#x3D;&#x3D;1&amp;&amp;tag[0]&#x3D;&#x3D;””)tag.length&#x3D;0;for(var i&#x3D;0;i&lt;tag.length;i++){this.hiddenTag(tag[i])};var ids&#x3D;this.info.someHiddenEle.split(“,”);if(ids.length&#x3D;&#x3D;1&amp;&amp;ids[0]&#x3D;&#x3D;””)ids.length&#x3D;0;for(var i&#x3D;0;i&lt;ids.length;i++){this.hiddenEle(ids[i])};var ids&#x3D;this.info.someDisabledBtn.split(“,”);if(ids.length&#x3D;&#x3D;1&amp;&amp;ids[0]&#x3D;&#x3D;””)ids.length&#x3D;0;for(var i&#x3D;0;i&lt;ids.length;i++){this.disabledBtn(ids[i])};space(“begin”)},disabledBtn:function(id){var ele&#x3D;document.getElementById(id);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null&amp;&amp;ele.disabled&#x3D;&#x3D;false){ele.disabled&#x3D;true;this.someToDisabled.push(ele)}},hiddenTag:function(tagName){var ele&#x3D;document.getElementsByTagName(tagName);if(ele!&#x3D;null){for(var i&#x3D;0;i&lt;ele.length;i++){if(ele[i].style.display!&#x3D;”none”&amp;&amp;ele[i].style.visibility!&#x3D;’hidden’){ele[i].style.visibility&#x3D;’hidden’;this.someToHidden.push(ele[i])}}}},hiddenEle:function(id){var ele&#x3D;document.getElementById(id);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null){ele.style.visibility&#x3D;’hidden’;this.someToHidden.push(ele)}},showSome:function(){for(var i&#x3D;0;i&lt;this.someToHidden.length;i++){this.someToHidden[i].style.visibility&#x3D;’visible’};for(var i&#x3D;0;i&lt;this.someToDisabled.length;i++){this.someToDisabled[i].disabled&#x3D;false};space(“end”)}};var Dragdrop&#x3D;new Class();Dragdrop.prototype&#x3D;{initialize:function(width,height,shadowWidth,showShadow,contentType){this.dragData&#x3D;null;this.dragDataIn&#x3D;null;this.backData&#x3D;null;this.width&#x3D;width;this.height&#x3D;height;this.shadowWidth&#x3D;shadowWidth;this.showShadow&#x3D;showShadow;this.contentType&#x3D;contentType;this.IsDraging&#x3D;false;this.oObj&#x3D;G(‘dialogBox’);Event.observe(G(‘dialogBoxTitle’),”mousedown”,this.moveStart.bindAsEventListener(this),false)},moveStart:function(event){this.IsDraging&#x3D;true;  </p>\n<p>if(this.contentType&#x3D;&#x3D;1){G(“iframeBG”).style.display&#x3D;””;G(“iframeBG”).style.width&#x3D;this.width;G(“iframeBG”).style.height&#x3D;this.height};Event.observe(document,”mousemove”,this.mousemove.bindAsEventListener(this),false);Event.observe(document,”mouseup”,this.mouseup.bindAsEventListener(this),false);Event.observe(document,”selectstart”,this.returnFalse,false);this.dragData&#x3D;{x:Event.pointerX(event),y:Event.pointerY(event)};this.backData&#x3D;{x:parseInt(this.oObj.style.left),y:parseInt(this.oObj.style.top)}},mousemove:function(event){if(!this.IsDraging)return;var iLeft&#x3D;Event.pointerX(event)-this.dragData[“x”]+parseInt(this.oObj.style.left);var iTop&#x3D;Event.pointerY(event)-this.dragData[“y”]+parseInt(this.oObj.style.top);if(this.dragData[“y”]&lt;parseInt(this.oObj.style.top))iTop&#x3D;iTop-12;else if(this.dragData[“y”]&gt;parseInt(this.oObj.style.top)+25)iTop&#x3D;iTop+12;this.oObj.style.left&#x3D;iLeft;this.oObj.style.top&#x3D;iTop;if(this.showShadow){G(‘dialogBoxShadow’).style.left&#x3D;iLeft+this.shadowWidth;G(‘dialogBoxShadow’).style.top&#x3D;iTop+this.shadowWidth};this.dragData&#x3D;{x:Event.pointerX(event),y:Event.pointerY(event)};document.body.style.cursor&#x3D;”move”},mouseup:function(event){if(!this.IsDraging)return;if(this.contentType&#x3D;&#x3D;1)G(“iframeBG”).style.display&#x3D;”none”;document.onmousemove&#x3D;null;document.onmouseup&#x3D;null;var mousX&#x3D;Event.pointerX(event)-(document.documentElement.scrollLeft||document.body.scrollLeft);var mousY&#x3D;Event.pointerY(event)-(document.documentElement.scrollTop||document.body.scrollTop);if(mousX&lt;1||mousY&lt;1||mousX&gt;document.body.clientWidth||mousY&gt;document.body.clientHeight){this.oObj.style.left&#x3D;this.backData[“x”];this.oObj.style.top&#x3D;this.backData[“y”];if(this.showShadow){G(‘dialogBoxShadow’).style.left&#x3D;this.backData.x+this.shadowWidth;G(‘dialogBoxShadow’).style.top&#x3D;this.backData.y+this.shadowWidth}};this.IsDraging&#x3D;false;document.body.style.cursor&#x3D;””;Event.stopObserving(document,”selectstart”,this.returnFalse,false)},returnFalse:function(){return false}};  </p>\n<p>说白了还是用了prototype库变了一下向来实现一个窗口，这样增强了用户体验。  </p>\n<p>在netsuite中，当你的脚本写得操作100多行时，我感觉就很有必要由一个蒙版层在引导用户操作。  </p>\n<p>防止用户在相关事务没有处理完之前关闭或者刷新了该窗体。  </p>\n<p>比如我在设计多币种报价时，用户的需求：必须是随意的用户切换主界面上的币种字段时，来完成所有这张销售订单货品的币种换算工作，  </p>\n<p>这样无论你如何优化这个脚本，系统还是需要时间去读去相关的汇率信息，然后完成换算，在赋值结束操作。  </p>\n<p>在运算过程中就很有必要添加一个用户增强用户体验度的窗体，提示用户，耐心等候。  </p>\n<p><a href=\"http://www.totemsuite.com/SAAS\">http://www.totemsuite.com/SAAS</a>  </p>\n<p>author:zeng.chuanzhuo</p>\n","more":"<p>ok,让我们来分析一下，当用户输入完相应信息点击’发表评论’按钮时，触发：checkcmtform() （由 可得） 代码如下： function checkcmtform() { if(checkname(“spBlogCmtor”)&amp;&amp;checkeandu(“spBlogCmtURL”)&amp;&amp;checktext(“spBlogCmtText”)&amp;&amp;cmtfull()) { s…</p>\n<!-- more -->\n<p>ok,让我们来分析一下，当用户输入完相应信息点击’发表评论’按钮时，触发：checkcmtform()  </p>\n<p>（由&lt;form name=“form1” id=“popFormSubmit” action=“&#x2F;%CC%EC%CF%C2%BF%F1%C0%BD&#x2F;commit” method=“post” onSubmit=“return checkcmtform()”&gt;  </p>\n<p>可得）  </p>\n<p>代码如下：  </p>\n<p>function checkcmtform()  </p>\n<p>{  </p>\n<p>if(checkname(“spBlogCmtor”)&amp;&amp;checkeandu(“spBlogCmtURL”)&amp;&amp;checktext(“spBlogCmtText”)&amp;&amp;cmtfull())  </p>\n<p>{  </p>\n<p>submitForm();  </p>\n<p>return true;  </p>\n<p>}  </p>\n<p>else  </p>\n<p>{  </p>\n<p>return false;  </p>\n<p>}  </p>\n<p>}  </p>\n<p>var g_pop&#x3D;null;  </p>\n<p>function submitForm()  </p>\n<p>{  </p>\n<p>g_pop&#x3D;new Popup({ contentType:1,isReloadOnClose:false,width:340,height:80});  </p>\n<p>g_pop.setContent(“title”,”添加评论”);  </p>\n<p>g_pop.setContent(“contentUrl”,””);  </p>\n<p>g_pop.setContent(“someDisabledBtn”,”btn_ok”);  </p>\n<p>g_pop.build();  </p>\n<p>G(“popFormSubmit”).target&#x3D;g_pop.iframeIdName;  </p>\n<p>g_pop.show();  </p>\n<p>}  </p>\n<p>function g_close_pop()  </p>\n<p>{  </p>\n<p>g_pop.close();  </p>\n<p>}  </p>\n<p>这样，一个g_pop.setContent(“title”,”添加评论”);就开始创建一个窗体，并且蒙版了一个层，防止用户误操作影响提交相关评论到后台的功能。  </p>\n<p><a href=\"http://hi.baidu.com/js/popup.js\">http://hi.baidu.com/js/popup.js</a>  </p>\n<p>if(!Array.prototype.push){  </p>\n<p>Array.prototype.push&#x3D;function(){  </p>\n<p>var startLength&#x3D;this.length;  </p>\n<p>for(var i&#x3D;0;i&lt;arguments.length;i++)this[startLength+i]&#x3D;arguments[i];  </p>\n<p>return this.length}};  </p>\n<p>function G(){var elements&#x3D;new Array();  </p>\n<p>for(var i&#x3D;0;i&lt;arguments.length;i++)  </p>\n<p>{var element&#x3D;arguments[i];if(typeof element&#x3D;&#x3D;’string’)element&#x3D;document.getElementById(element);if(arguments.length&#x3D;&#x3D;1)return element;elements.push(element)};return elements};  </p>\n<p>Function.prototype.bind&#x3D;function(object){var __method&#x3D;this;return function(){__method.apply(object,arguments)}};Function.prototype.bindAsEventListener&#x3D;function(object){var __method&#x3D;this;return function(event){__method.call(object,event||window.event)}};Object.extend&#x3D;function(destination,source){for(property in source){destination[property]&#x3D;source[property]};return destination};if(!window.Event){var Event&#x3D;new Object()};Object.extend(Event,{observers:false,element:function(event){return event.target||event.srcElement},isLeftClick:function(event){return(((event.which)&amp;&amp;(event.which&#x3D;&#x3D;1))||((event.button)&amp;&amp;(event.button&#x3D;&#x3D;1)))},pointerX:function(event){return event.pageX||(event.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft))},pointerY:function(event){return event.pageY||(event.clientY+(document.documentElement.scrollTop||document.body.scrollTop))},stop:function(event){if(event.preventDefault){event.preventDefault();event.stopPropagation()}else{event.returnValue&#x3D;false;event.cancelBubble&#x3D;true}},findElement:function(event,tagName){var element&#x3D;Event.element(event);while(element.parentNode&amp;&amp;(!element.tagName||(element.tagName.toUpperCase()!&#x3D;tagName.toUpperCase())))element&#x3D;element.parentNode;return element},_observeAndCache:function(element,name,observer,useCapture){if(!this.observers)this.observers&#x3D;[];if(element.addEventListener){this.observers.push([element,name,observer,useCapture]);element.addEventListener(name,observer,useCapture)}else if(element.attachEvent){this.observers.push([element,name,observer,useCapture]);element.attachEvent(‘on’+name,observer)}},unloadCache:function(){if(!Event.observers)return;for(var i&#x3D;0;i&lt;Event.observers.length;i++){Event.stopObserving.apply(this,Event.observers[i]);Event.observers[i][0]&#x3D;null};Event.observers&#x3D;false},observe:function(element,name,observer,useCapture){var element&#x3D;G(element);useCapture&#x3D;useCapture||false;if(name&#x3D;&#x3D;’keypress’&amp;&amp;(navigator.appVersion.match(&#x2F;Konqueror|Safari|KHTML&#x2F;)||element.attachEvent))name&#x3D;’keydown’;this._observeAndCache(element,name,observer,useCapture)},stopObserving:function(element,name,observer,useCapture){var element&#x3D;G(element);useCapture&#x3D;useCapture||false;if(name&#x3D;&#x3D;’keypress’&amp;&amp;(navigator.appVersion.match(&#x2F;Konqueror|Safari|KHTML&#x2F;)||element.detachEvent))name&#x3D;’keydown’;if(element.removeEventListener){element.removeEventListener(name,observer,useCapture)}else if(element.detachEvent){element.detachEvent(‘on’+name,observer)}}});Event.observe(window,’unload’,Event.unloadCache,false);var Class&#x3D;function(){var _class&#x3D;function(){this.initialize.apply(this,arguments)};for(i&#x3D;0;i&lt;arguments.length;i++){superClass&#x3D;arguments[i];for(member in superClass.prototype){_class.prototype[member]&#x3D;superClass.prototype[member]}};_class.child&#x3D;function(){return new Class(this)};_class.extend&#x3D;function(f){for(property in f){_class.prototype[property]&#x3D;f[property]}};return _class};function space(flag){if(flag&#x3D;&#x3D;”begin”){var ele&#x3D;document.getElementById(“ft”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”ft_popup”;ele&#x3D;document.getElementById(“usrbar”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”usrbar_popup”}  </p>\n<p>else if(flag&#x3D;&#x3D;”end”){var ele&#x3D;document.getElementById(“ft_popup”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”ft”;ele&#x3D;document.getElementById(“usrbar_popup”);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null)ele.id&#x3D;”usrbar”}};var Popup&#x3D;new Class();Popup.prototype&#x3D;{iframeIdName:’ifr_popup’,initialize:function(config){this.config&#x3D;Object.extend({contentType:1,isHaveTitle:true,scrollType:’no’,isBackgroundCanClick:false,isSupportDraging:true,isShowShadow:true,isReloadOnClose:true,width:400,height:300},config||{});this.info&#x3D;{shadowWidth:4,title:””,contentUrl:””,contentHtml:””,callBack:null,parameter:null,confirmCon:””,alertCon:””,someHiddenTag:”select,object,embed”,someDisabledBtn:””,someHiddenEle:””,overlay:0,coverOpacity:40};this.color&#x3D;{cColor:”#EEEEEE”,bColor:”#FFFFFF”,tColor:”#709CD2”,wColor:”#FFFFFF”};this.dropClass&#x3D;null;this.someToHidden&#x3D;[];this.someToDisabled&#x3D;[];if(!this.config.isHaveTitle)this.config.isSupportDraging&#x3D;false;this.iniBuild()},setContent:function(arrt,val){if(val!&#x3D;’’){switch(arrt){case ‘width’:this.config.width&#x3D;val;break;case ‘height’:this.config.height&#x3D;val;break;case ‘title’:this.info.title&#x3D;val;break;case ‘contentUrl’:this.info.contentUrl&#x3D;val;break;case ‘contentHtml’:this.info.contentHtml&#x3D;val;break;case ‘callBack’:this.info.callBack&#x3D;val;break;case ‘parameter’:this.info.parameter&#x3D;val;break;case ‘confirmCon’:this.info.confirmCon&#x3D;val;break;case ‘alertCon’:this.info.alertCon&#x3D;val;break;case ‘someHiddenTag’:this.info.someHiddenTag&#x3D;val;break;case ‘someHiddenEle’:this.info.someHiddenEle&#x3D;val;break;case ‘someDisabledBtn’:this.info.someDisabledBtn&#x3D;val;break;case ‘overlay’:this.info.overlay&#x3D;val}}},iniBuild:function(){G(‘dialogCase’)?G(‘dialogCase’).parentNode.removeChild(G(‘dialogCase’)):function(){};var oDiv&#x3D;document.createElement(‘span’);oDiv.id&#x3D;’dialogCase’;  </p>\n<p>document.body.appendChild(oDiv)},build:function(){var baseZIndex&#x3D;10001+this.info.overlay*10;var showZIndex&#x3D;baseZIndex+2;this.iframeIdName&#x3D;’ifr_popup’+this.info.overlay;var path&#x3D;”<a href=\"http://img.baidu.com/hi/img/%22;var\">http://img.baidu.com/hi/img/&quot;;var</a> close&#x3D;’<input type=\"image\" id=\"dialogBoxClose\" src=\"'+path+'dialogclose.gif\" border=\"0\" width=\"16\" height=\"16\" align=\"absmiddle\" title=\"关闭\"/>‘;var cB&#x3D;’filter: alpha(opacity&#x3D;’+this.info.coverOpacity+’);opacity:’+this.info.coverOpacity&#x2F;100+’;’;var cover&#x3D;’<div id=\"dialogBoxBG\" style=\"position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:'+baseZIndex+';'+cB+'background-color:'+this.color.cColor+';display:none;\"></div>‘;var mainBox&#x3D;’<div id=\"dialogBox\" style=\"border:1px solid '+this.color.tColor+';display:none;z-index:'+showZIndex+';position:relative;width:'+this.config.width+'px;\"><table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"'+this.color.bColor+'\">‘;if(this.config.isHaveTitle){mainBox+&#x3D;’<tr height=\"24\" bgcolor=\"'+this.color.tColor+'\"><td><table style=\"-moz-user-select:none;height:24px;\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" ><tr>‘+’<td width=\"6\" height=\"24\"></td><td id=\"dialogBoxTitle\" style=\"color:'+this.color.wColor+';font-size:14px;font-weight:bold;\">‘+this.info.title+’&nbsp;</td>‘+’<td id=\"dialogClose\" width=\"20\" align=\"right\" valign=\"middle\">‘+close+’</td><td width=\"6\"></td></tr></table></td></tr>‘}else{mainBox+&#x3D;’<tr height=\"10\"><td align=\"right\">‘+close+’</td></tr>‘};mainBox+&#x3D;’<tr style=\"height:'+this.config.height+'px\" valign=\"top\"><td id=\"dialogBody\" style=\"position:relative;\"></td></tr></table></div>‘+’<div id=\"dialogBoxShadow\" style=\"display:none;z-index:'+baseZIndex+';\"></div>‘;if(!this.config.isBackgroundCanClick){G(‘dialogCase’).innerHTML&#x3D;cover+mainBox;G(‘dialogBoxBG’).style.height&#x3D;document.body.scrollHeight}else G(‘dialogCase’).innerHTML&#x3D;mainBox;Event.observe(G(‘dialogBoxClose’),”click”,this.reset.bindAsEventListener(this),false);if(this.config.isSupportDraging){dropClass&#x3D;new Dragdrop(this.config.width,this.config.height,this.info.shadowWidth,this.config.isSupportDraging,this.config.contentType);G(“dialogBoxTitle”).style.cursor&#x3D;”move”};this.lastBuild()},lastBuild:function(){var confirm&#x3D;’<div style=\"width:100%;height:100%;text-align:center;\"><div style=\"margin:20px 20px 0 20px;font-size:14px;line-height:16px;color:#000000;\">‘+this.info.confirmCon+’</div>  </p>\n<div style=\"margin:20px;\"><input id=\"dialogOk\" type=\"button\" value=\"  确定  \"/>&nbsp;<input id=\"dialogCancel\" type=\"button\" value=\"  取消  \"/></div></div>';var alert='<div style=\"width:100%;height:100%;text-align:center;\"><div style=\"margin:20px 20px 0 20px;font-size:14px;line-height:16px;color:#000000;\">'+this.info.alertCon+'</div><div style=\"margin:20px;\"><input id=\"dialogYES\" type=\"button\" value=\"  确定  \"/></div></div>';var baseZIndex=10001+this.info.overlay\\*10;var coverIfZIndex=baseZIndex+4;if(this.config.contentType==1){var openIframe=\"<iframe width='100%' style='height:\"+this.config.height+\"px' name='\"+this.iframeIdName+\"' id='\"+this.iframeIdName+\"' src='\"+this.info.contentUrl+\"' frameborder='0' scrolling='\"+this.config.scrollType+\"'></iframe>\";var coverIframe=\"<div id='iframeBG' style='position:absolute;top:0px;left:0px;width:1px;height:1px;z-index:\"+coverIfZIndex+\";filter: alpha(opacity=00);opacity:0.00;background-color:#ffffff;'><div>\";G(\"dialogBody\").innerHTML=openIframe+coverIframe}else if(this.config.contentType==2){G(\"dialogBody\").innerHTML=this.info.contentHtml}else if(this.config.contentType==3){G(\"dialogBody\").innerHTML=confirm;Event.observe(G('dialogOk'),\"click\",this.forCallback.bindAsEventListener(this),false);Event.observe(G('dialogCancel'),\"click\",this.close.bindAsEventListener(this),false)}  \n  \n\n<p>else if(this.config.contentType&#x3D;&#x3D;4){G(“dialogBody”).innerHTML&#x3D;alert;Event.observe(G(‘dialogYES’),”click”,this.close.bindAsEventListener(this),false)}},reBuild:function(){G(‘dialogBody’).height&#x3D;G(‘dialogBody’).clientHeight;this.lastBuild()},show:function(){this.hiddenSome();this.middle();if(this.config.isShowShadow)this.shadow()},forCallback:function(){return this.info.callBack(this.info.parameter)},shadow:function(){var oShadow&#x3D;G(‘dialogBoxShadow’);var oDialog&#x3D;G(‘dialogBox’);oShadow[‘style’][‘position’]&#x3D;”absolute”;oShadow[‘style’][‘background’]&#x3D;”#000”;oShadow[‘style’][‘display’]&#x3D;””;oShadow[‘style’][‘opacity’]&#x3D;”0.2”;oShadow[‘style’][‘filter’]&#x3D;”alpha(opacity&#x3D;20)”;oShadow[‘style’][‘top’]&#x3D;oDialog.offsetTop+this.info.shadowWidth;oShadow[‘style’][‘left’]&#x3D;oDialog.offsetLeft+this.info.shadowWidth;oShadow[‘style’][‘width’]&#x3D;oDialog.offsetWidth;oShadow[‘style’][‘height’]&#x3D;oDialog.offsetHeight},middle:function(){if(!this.config.isBackgroundCanClick)G(‘dialogBoxBG’).style.display&#x3D;’’;var oDialog&#x3D;G(‘dialogBox’);oDialog[‘style’][‘position’]&#x3D;”absolute”;oDialog[‘style’][‘display’]&#x3D;’’;var sClientWidth&#x3D;document.body.clientWidth;var sClientHeight&#x3D;document.body.clientHeight;var sScrollTop&#x3D;document.body.scrollTop;var sleft&#x3D;(document.body.clientWidth&#x2F;2)-(oDialog.offsetWidth&#x2F;2);var iTop&#x3D;-80+(sClientHeight&#x2F;2+sScrollTop)-(oDialog.offsetHeight&#x2F;2);var sTop&#x3D;iTop&gt;0?iTop:(sClientHeight&#x2F;2+sScrollTop)-(oDialog.offsetHeight&#x2F;2);if(sTop&lt;1)sTop&#x3D;”20”;if(sleft&lt;1)sleft&#x3D;”20”;oDialog[‘style’][‘left’]&#x3D;sleft;oDialog[‘style’][‘top’]&#x3D;sTop},reset:function(){if(this.config.isReloadOnClose){top.location.reload()};this.close()},close:function(){G(‘dialogBox’).style.display&#x3D;’none’;if(!this.config.isBackgroundCanClick)G(‘dialogBoxBG’).style.display&#x3D;’none’;if(this.config.isShowShadow)G(‘dialogBoxShadow’).style.display&#x3D;’none’;G(‘dialogBody’).innerHTML&#x3D;’’;this.showSome()},hiddenSome:function(){var tag&#x3D;this.info.someHiddenTag.split(“,”);if(tag.length&#x3D;&#x3D;1&amp;&amp;tag[0]&#x3D;&#x3D;””)tag.length&#x3D;0;for(var i&#x3D;0;i&lt;tag.length;i++){this.hiddenTag(tag[i])};var ids&#x3D;this.info.someHiddenEle.split(“,”);if(ids.length&#x3D;&#x3D;1&amp;&amp;ids[0]&#x3D;&#x3D;””)ids.length&#x3D;0;for(var i&#x3D;0;i&lt;ids.length;i++){this.hiddenEle(ids[i])};var ids&#x3D;this.info.someDisabledBtn.split(“,”);if(ids.length&#x3D;&#x3D;1&amp;&amp;ids[0]&#x3D;&#x3D;””)ids.length&#x3D;0;for(var i&#x3D;0;i&lt;ids.length;i++){this.disabledBtn(ids[i])};space(“begin”)},disabledBtn:function(id){var ele&#x3D;document.getElementById(id);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null&amp;&amp;ele.disabled&#x3D;&#x3D;false){ele.disabled&#x3D;true;this.someToDisabled.push(ele)}},hiddenTag:function(tagName){var ele&#x3D;document.getElementsByTagName(tagName);if(ele!&#x3D;null){for(var i&#x3D;0;i&lt;ele.length;i++){if(ele[i].style.display!&#x3D;”none”&amp;&amp;ele[i].style.visibility!&#x3D;’hidden’){ele[i].style.visibility&#x3D;’hidden’;this.someToHidden.push(ele[i])}}}},hiddenEle:function(id){var ele&#x3D;document.getElementById(id);if(typeof(ele)!&#x3D;”undefined”&amp;&amp;ele!&#x3D;null){ele.style.visibility&#x3D;’hidden’;this.someToHidden.push(ele)}},showSome:function(){for(var i&#x3D;0;i&lt;this.someToHidden.length;i++){this.someToHidden[i].style.visibility&#x3D;’visible’};for(var i&#x3D;0;i&lt;this.someToDisabled.length;i++){this.someToDisabled[i].disabled&#x3D;false};space(“end”)}};var Dragdrop&#x3D;new Class();Dragdrop.prototype&#x3D;{initialize:function(width,height,shadowWidth,showShadow,contentType){this.dragData&#x3D;null;this.dragDataIn&#x3D;null;this.backData&#x3D;null;this.width&#x3D;width;this.height&#x3D;height;this.shadowWidth&#x3D;shadowWidth;this.showShadow&#x3D;showShadow;this.contentType&#x3D;contentType;this.IsDraging&#x3D;false;this.oObj&#x3D;G(‘dialogBox’);Event.observe(G(‘dialogBoxTitle’),”mousedown”,this.moveStart.bindAsEventListener(this),false)},moveStart:function(event){this.IsDraging&#x3D;true;  </p>\n<p>if(this.contentType&#x3D;&#x3D;1){G(“iframeBG”).style.display&#x3D;””;G(“iframeBG”).style.width&#x3D;this.width;G(“iframeBG”).style.height&#x3D;this.height};Event.observe(document,”mousemove”,this.mousemove.bindAsEventListener(this),false);Event.observe(document,”mouseup”,this.mouseup.bindAsEventListener(this),false);Event.observe(document,”selectstart”,this.returnFalse,false);this.dragData&#x3D;{x:Event.pointerX(event),y:Event.pointerY(event)};this.backData&#x3D;{x:parseInt(this.oObj.style.left),y:parseInt(this.oObj.style.top)}},mousemove:function(event){if(!this.IsDraging)return;var iLeft&#x3D;Event.pointerX(event)-this.dragData[“x”]+parseInt(this.oObj.style.left);var iTop&#x3D;Event.pointerY(event)-this.dragData[“y”]+parseInt(this.oObj.style.top);if(this.dragData[“y”]&lt;parseInt(this.oObj.style.top))iTop&#x3D;iTop-12;else if(this.dragData[“y”]&gt;parseInt(this.oObj.style.top)+25)iTop&#x3D;iTop+12;this.oObj.style.left&#x3D;iLeft;this.oObj.style.top&#x3D;iTop;if(this.showShadow){G(‘dialogBoxShadow’).style.left&#x3D;iLeft+this.shadowWidth;G(‘dialogBoxShadow’).style.top&#x3D;iTop+this.shadowWidth};this.dragData&#x3D;{x:Event.pointerX(event),y:Event.pointerY(event)};document.body.style.cursor&#x3D;”move”},mouseup:function(event){if(!this.IsDraging)return;if(this.contentType&#x3D;&#x3D;1)G(“iframeBG”).style.display&#x3D;”none”;document.onmousemove&#x3D;null;document.onmouseup&#x3D;null;var mousX&#x3D;Event.pointerX(event)-(document.documentElement.scrollLeft||document.body.scrollLeft);var mousY&#x3D;Event.pointerY(event)-(document.documentElement.scrollTop||document.body.scrollTop);if(mousX&lt;1||mousY&lt;1||mousX&gt;document.body.clientWidth||mousY&gt;document.body.clientHeight){this.oObj.style.left&#x3D;this.backData[“x”];this.oObj.style.top&#x3D;this.backData[“y”];if(this.showShadow){G(‘dialogBoxShadow’).style.left&#x3D;this.backData.x+this.shadowWidth;G(‘dialogBoxShadow’).style.top&#x3D;this.backData.y+this.shadowWidth}};this.IsDraging&#x3D;false;document.body.style.cursor&#x3D;””;Event.stopObserving(document,”selectstart”,this.returnFalse,false)},returnFalse:function(){return false}};  </p>\n<p>说白了还是用了prototype库变了一下向来实现一个窗口，这样增强了用户体验。  </p>\n<p>在netsuite中，当你的脚本写得操作100多行时，我感觉就很有必要由一个蒙版层在引导用户操作。  </p>\n<p>防止用户在相关事务没有处理完之前关闭或者刷新了该窗体。  </p>\n<p>比如我在设计多币种报价时，用户的需求：必须是随意的用户切换主界面上的币种字段时，来完成所有这张销售订单货品的币种换算工作，  </p>\n<p>这样无论你如何优化这个脚本，系统还是需要时间去读去相关的汇率信息，然后完成换算，在赋值结束操作。  </p>\n<p>在运算过程中就很有必要添加一个用户增强用户体验度的窗体，提示用户，耐心等候。  </p>\n<p><a href=\"http://www.totemsuite.com/SAAS\">http://www.totemsuite.com/SAAS</a>  </p>\n<p>author:zeng.chuanzhuo</p>\n","categories":[{"name":"NetSuite","path":"api/categories/NetSuite.json"}],"tags":[{"name":"NetSuite","path":"api/tags/NetSuite.json"}]}