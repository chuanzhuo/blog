{"title":"appendFormDataToURL完成导出，netsuite导出csv-CarlZeng","slug":"cn/appendFormDataToURL完成导出，netsuite导出csv-CarlZeng","date":"2008-12-08T06:33:00.000Z","updated":"2023-10-08T13:38:52.659Z","comments":true,"path":"api/articles/cn/appendFormDataToURL完成导出，netsuite导出csv-CarlZeng.json","excerpt":"footer_actions 是netsuite中 所有系统列表form页面都存在的对象，就是页脚那些可以用来排序，过滤等等的对象，我们可以对这些对象进行操作，包括定制，系统完成您操作后的动态刷新当前页面的功能。这个四个对象是包括在form：foot_actions中的，是四个隐藏的对象，在界面上无法查看到，是系统内置的用来动态管理其自身功能的变量。比如在导出时候：document.forms['...","covers":null,"content":"<p>footer_actions 是netsuite中 所有系统列表form页面都存在的对象，就是页脚那些可以用来排序，过滤等等的对象，我们可以对这些对象进行操作，包括定制，系统完成您操作后的动态刷新当前页面的功能。这个四个对象是包括在form：foot_actions中的，是四个隐藏的对象，在界面上无法查看到，是系统内置的用来动态管理其自身功能的变量。比如在导出时候：document.forms[‘…</p>\n<!-- more -->\n<p>footer_actions 是netsuite中 所有系统列表form页面都存在的对象，就是页脚那些可以用来排序，过滤等等的对象，我们可以对这些对象进行操作，包括定制，系统完成您操作后的动态刷新当前页面的功能。</p>\n<p>&lt;input type=hidden name=‘sortcol’ value=‘Transaction_TRANDATE_raw’&gt;</p>\n<p>&lt;input type=hidden name=‘sortdir’ value=‘ASC’&gt;<br>&lt;input type=hidden name=‘csv’ value=‘HTML’&gt;<br>&lt;input type=hidden name=‘OfficeXML’ value=‘F’&gt;</p>\n<p>这个四个对象是包括在form：foot_actions中的，是四个隐藏的对象，在界面上无法查看到，是系统内置的用来动态管理其自身功能的变量。</p>\n<p>比如在导出时候：</p>\n<p>document.forms[‘footer_actions’].elements.csv.value&#x3D;’Export’;</p>\n<p>&#x2F;&#x2F;document.forms[‘footer_actions’].elements.OfficeXML.value&#x3D;’F’;</p>\n<p>document.location.replace(appendFormDataToURL(‘&#x2F;app&#x2F;accounting&#x2F;transactions&#x2F;transactionlist.csv?searchtype&#x3D;Transaction’));</p>\n<p>csv被变成Export时，在用appendFormDataToURL才会发生导出动作哦！~</p>\n<p>function appendFormDataToURL(url,omit) {<br> var footer &#x3D; document.getElementById(‘div__footer’);<br> var elem, frm &#x3D; parent.document.forms[‘footer_actions’];<br> if (isValEmpty(url)) url &#x3D; ‘’<br> for (var i &#x3D; 0; i &lt; frm.elements.length; i++) {<br>  elem &#x3D; frm.elements[i];<br>  if (elem.name.length &#x3D;&#x3D; 0 || elem.name &#x3D;&#x3D; omit || elem.name.indexOf(‘inpt_‘) &#x3D;&#x3D; 0) continue;<br>  if (elem.type&#x3D;&#x3D;’select-one’)<br>   url &#x3D; addParamToURL(url, elem.name, escape(parent.getSelectValue(elem)));<br>  else if (isMultiSelect(elem))<br>   url &#x3D; addParamToURL(url, elem.name, escape(getMultiSelectValues(elem)));<br>  else if (elem.type&#x3D;&#x3D;’radio’)<br>   url &#x3D; addParamToURL(url, elem.name, escape(getRadioValue(elem)));<br>  else if (elem.type&#x3D;&#x3D;’checkbox’)<br>   url &#x3D; addParamToURL(url, elem.name, (elem.checked ? ‘T’ : ‘F’));<br>  else if (elem.type&#x3D;&#x3D;’text’)<br>   url &#x3D; addParamToURL(url, elem.name, escape(elem.value));<br>  else if (elem.type&#x3D;&#x3D;’hidden’ &amp;&amp; elem.name !&#x3D; ‘frame’)<br>   url &#x3D; addParamToURL(url, elem.name, encode(elem.value));<br> }<br> return url;  }</p>\n<p>这个隐含的API中调用到了系统公开的一个API：addParamToURL和一个escape方法：</p>\n<p>addParamToURL(param, value, dynamic)<br>Adds a URL parameter to this column. Should only be called after calling setURL(xxx)<br>Parameters<br>? param {string} - The parameter name added to the URL<br>? value {string} - The parameter value added to the URL<br>? dynamic {boolean} - If true, then the parameter value is actually an alias that is<br>calculated per row</p>\n<p>-———————–</p>\n<h3 id=\"escape-方法\"><a href=\"#escape-方法\" class=\"headerlink\" title=\"escape 方法\"></a>escape 方法</h3><p>对 <strong>String</strong> 对象编码以便它们能在所有计算机上可读，<br><code>**escape(**_charString_**)**</code><br>必选项 <em>charstring</em> 参数是要编码的任意 <strong>String</strong> 对象或文字。 </p>\n<h4 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h4><p><strong>escape</strong> 方法返回一个包含了 <em>charstring</em> 内容的字符串值（ Unicode 格式）。所有空格、标点、重音符号以及其他非 ASCII 字符都用 <strong>%</strong><em>xx</em> 编码代替，其中 <em>xx</em> 等于表示该字符的十六进制数。例如，空格返回的是 “%20” 。<br>字符值大于 255 的以 <strong>%u</strong><em>xxxx</em> 格式存储。<br><strong>注意</strong>   <strong>escape</strong> 方法不能够用来对统一资源标示码 (URI) 进行编码。对其编码应使用 <strong>encodeURI</strong> 和<strong>encodeURIComponent</strong> 方法。</p>\n<h4 id=\"要求\"><a href=\"#要求\" class=\"headerlink\" title=\"要求\"></a>要求</h4><p>版本 1</p>\n<h4 id=\"请参阅\"><a href=\"#请参阅\" class=\"headerlink\" title=\"请参阅\"></a>请参阅</h4><p>encodeURI 方法 | encodeURIComponent 方法 |String 对象 | unescape 方法</p>\n","more":"<p>footer_actions 是netsuite中 所有系统列表form页面都存在的对象，就是页脚那些可以用来排序，过滤等等的对象，我们可以对这些对象进行操作，包括定制，系统完成您操作后的动态刷新当前页面的功能。这个四个对象是包括在form：foot_actions中的，是四个隐藏的对象，在界面上无法查看到，是系统内置的用来动态管理其自身功能的变量。比如在导出时候：document.forms[‘…</p>\n<!-- more -->\n<p>footer_actions 是netsuite中 所有系统列表form页面都存在的对象，就是页脚那些可以用来排序，过滤等等的对象，我们可以对这些对象进行操作，包括定制，系统完成您操作后的动态刷新当前页面的功能。</p>\n<p>&lt;input type=hidden name=‘sortcol’ value=‘Transaction_TRANDATE_raw’&gt;</p>\n<p>&lt;input type=hidden name=‘sortdir’ value=‘ASC’&gt;<br>&lt;input type=hidden name=‘csv’ value=‘HTML’&gt;<br>&lt;input type=hidden name=‘OfficeXML’ value=‘F’&gt;</p>\n<p>这个四个对象是包括在form：foot_actions中的，是四个隐藏的对象，在界面上无法查看到，是系统内置的用来动态管理其自身功能的变量。</p>\n<p>比如在导出时候：</p>\n<p>document.forms[‘footer_actions’].elements.csv.value&#x3D;’Export’;</p>\n<p>&#x2F;&#x2F;document.forms[‘footer_actions’].elements.OfficeXML.value&#x3D;’F’;</p>\n<p>document.location.replace(appendFormDataToURL(‘&#x2F;app&#x2F;accounting&#x2F;transactions&#x2F;transactionlist.csv?searchtype&#x3D;Transaction’));</p>\n<p>csv被变成Export时，在用appendFormDataToURL才会发生导出动作哦！~</p>\n<p>function appendFormDataToURL(url,omit) {<br> var footer &#x3D; document.getElementById(‘div__footer’);<br> var elem, frm &#x3D; parent.document.forms[‘footer_actions’];<br> if (isValEmpty(url)) url &#x3D; ‘’<br> for (var i &#x3D; 0; i &lt; frm.elements.length; i++) {<br>  elem &#x3D; frm.elements[i];<br>  if (elem.name.length &#x3D;&#x3D; 0 || elem.name &#x3D;&#x3D; omit || elem.name.indexOf(‘inpt_‘) &#x3D;&#x3D; 0) continue;<br>  if (elem.type&#x3D;&#x3D;’select-one’)<br>   url &#x3D; addParamToURL(url, elem.name, escape(parent.getSelectValue(elem)));<br>  else if (isMultiSelect(elem))<br>   url &#x3D; addParamToURL(url, elem.name, escape(getMultiSelectValues(elem)));<br>  else if (elem.type&#x3D;&#x3D;’radio’)<br>   url &#x3D; addParamToURL(url, elem.name, escape(getRadioValue(elem)));<br>  else if (elem.type&#x3D;&#x3D;’checkbox’)<br>   url &#x3D; addParamToURL(url, elem.name, (elem.checked ? ‘T’ : ‘F’));<br>  else if (elem.type&#x3D;&#x3D;’text’)<br>   url &#x3D; addParamToURL(url, elem.name, escape(elem.value));<br>  else if (elem.type&#x3D;&#x3D;’hidden’ &amp;&amp; elem.name !&#x3D; ‘frame’)<br>   url &#x3D; addParamToURL(url, elem.name, encode(elem.value));<br> }<br> return url;  }</p>\n<p>这个隐含的API中调用到了系统公开的一个API：addParamToURL和一个escape方法：</p>\n<p>addParamToURL(param, value, dynamic)<br>Adds a URL parameter to this column. Should only be called after calling setURL(xxx)<br>Parameters<br>? param {string} - The parameter name added to the URL<br>? value {string} - The parameter value added to the URL<br>? dynamic {boolean} - If true, then the parameter value is actually an alias that is<br>calculated per row</p>\n<p>-———————–</p>\n<h3 id=\"escape-方法\"><a href=\"#escape-方法\" class=\"headerlink\" title=\"escape 方法\"></a>escape 方法</h3><p>对 <strong>String</strong> 对象编码以便它们能在所有计算机上可读，<br><code>**escape(**_charString_**)**</code><br>必选项 <em>charstring</em> 参数是要编码的任意 <strong>String</strong> 对象或文字。 </p>\n<h4 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h4><p><strong>escape</strong> 方法返回一个包含了 <em>charstring</em> 内容的字符串值（ Unicode 格式）。所有空格、标点、重音符号以及其他非 ASCII 字符都用 <strong>%</strong><em>xx</em> 编码代替，其中 <em>xx</em> 等于表示该字符的十六进制数。例如，空格返回的是 “%20” 。<br>字符值大于 255 的以 <strong>%u</strong><em>xxxx</em> 格式存储。<br><strong>注意</strong>   <strong>escape</strong> 方法不能够用来对统一资源标示码 (URI) 进行编码。对其编码应使用 <strong>encodeURI</strong> 和<strong>encodeURIComponent</strong> 方法。</p>\n<h4 id=\"要求\"><a href=\"#要求\" class=\"headerlink\" title=\"要求\"></a>要求</h4><p>版本 1</p>\n<h4 id=\"请参阅\"><a href=\"#请参阅\" class=\"headerlink\" title=\"请参阅\"></a>请参阅</h4><p>encodeURI 方法 | encodeURIComponent 方法 |String 对象 | unescape 方法</p>\n","categories":[{"name":"NetSuite","path":"api/categories/NetSuite.json"}],"tags":[{"name":"NetSuite","path":"api/tags/NetSuite.json"}]}