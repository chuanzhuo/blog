{"title":"html js 跨域 p3p-CarlZeng","slug":"cn/html-js-跨域-p3p-CarlZeng","date":"2009-09-22T06:18:00.000Z","updated":"2023-10-08T14:37:40.576Z","comments":true,"path":"api/articles/cn/html-js-跨域-p3p-CarlZeng.json","excerpt":"动态的创建iframe，然后向里面append DOM元素","covers":null,"content":"<p>动态的创建iframe，然后向里面append DOM元素</p>\n<span id=\"more\"></span>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> cw = <span class=\"variable language_\">window</span>.<span class=\"property\">frames</span>\\[<span class=\"string\">&#x27;tst&#x27;</span>\\]; cw.<span class=\"property\">document</span>.<span class=\"title function_\">open</span>(); cw.<span class=\"property\">document</span>.<span class=\"title function_\">write</span>(<span class=\"string\">&#x27;&lt;script&gt;alert(&quot;test&quot;)&lt;&#x27;</span> + <span class=\"string\">&#x27;/script&gt;&#x27;</span>); cw...&lt;/x-turndown&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">*   <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;tst&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;javascript:false&quot;</span>\\&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span></span><br><span class=\"line\">*   <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   <span class=\"keyword\">var</span> cw = <span class=\"variable language_\">window</span>.<span class=\"property\">frames</span>\\[<span class=\"string\">&#x27;tst&#x27;</span>\\];</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">open</span>();</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">write</span>(<span class=\"string\">&#x27;&lt;script&gt;alert(&quot;test&quot;)&lt;&#x27;</span> + <span class=\"string\">&#x27;/script&gt;&#x27;</span>);</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">write</span>(<span class=\"string\">&#x27;&lt;div&gt;test&lt;/div&gt;&#x27;</span>);</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">close</span>();</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>这段代码可以实现 js动态的创建iframe，然后向里面append DOM元素、JS函数</p>\n<p>js动态的创建iframe：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> f=<span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;IFRAME&quot;</span>);  </span><br><span class=\"line\">f.<span class=\"property\">id</span> = <span class=\"string\">&quot;iframe01&quot;</span>;  </span><br><span class=\"line\">f.<span class=\"property\">name</span>= <span class=\"string\">&quot;iframe01&quot;</span>;  </span><br><span class=\"line\">f.<span class=\"property\">height</span>=<span class=\"number\">1000</span>;  </span><br><span class=\"line\">f.<span class=\"property\">width</span>=<span class=\"number\">1000</span>;  </span><br><span class=\"line\">f.<span class=\"property\">src</span>=<span class=\"string\">&#x27;https://system.netsuite.com/app/accounting/transactions/inventory/inventorynumbereditor.nl?l=T&amp;tranid=745&amp;lineid=1&#x27;</span>; <span class=\"comment\">//&quot;about:blank&quot;  </span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(f);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> header= <span class=\"keyword\">new</span> <span class=\"title class_\">Array</span>();  </span><br><span class=\"line\">header\\[<span class=\"string\">&#x27;P3P: CP&#x27;</span>\\]= <span class=\"string\">&#x27;CURa ADMa DEVa PSAo PSDo OUR BUS UNI PUR INT DEM STA PRE COM NAV OTC NOI DSP COR&#x27;</span>;  </span><br><span class=\"line\">header\\[<span class=\"string\">&#x27;Set-Cookie&#x27;</span>\\]= <span class=\"string\">&#x27;test=axis; expires=Sun, 23-Dec-2018 08:13:02 GMT; domain=.google.com; path=/&#x27;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">var</span> url =<span class=\"string\">&#x27;https://mail.google.com/mail/#inbox&#x27;</span>;  </span><br><span class=\"line\"><span class=\"title function_\">nlapiRequestURL</span>(url, <span class=\"literal\">null</span>, header);</span><br></pre></td></tr></table></figure>\n<p>如上代码失败可知：ajax不支持跨域， 这样跨域必须要用到php,jsp或者c++等动态语言服务端的代理。</p>\n<p>详细见：</p>\n<p><a href=\"http://blog.csdn.net/lanmao100/archive/2008/04/25/2328491.aspx\">http://blog.csdn.net/lanmao100/archive/2008/04/25/2328491.aspx</a> 用P3P header解决iframe跨域访问cookie&#x2F;session</p>\n<p><a href=\"http://viralpatel.net/blogs/2008/12/how-to-set-third-party-cookies-with-iframe.html\">http://viralpatel.net/blogs/2008/12/how-to-set-third-party-cookies-with-iframe.html</a> How to set third-party cookies with iframe</p>\n<p><a href=\"http://hi.baidu.com/aullik5/blog/item/cde7f31efc3953f2e0fe0b46.html\">http://hi.baidu.com/aullik5/blog/item/cde7f31efc3953f2e0fe0b46.html</a> P3P Header Tips</p>\n","more":"<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> cw = <span class=\"variable language_\">window</span>.<span class=\"property\">frames</span>\\[<span class=\"string\">&#x27;tst&#x27;</span>\\]; cw.<span class=\"property\">document</span>.<span class=\"title function_\">open</span>(); cw.<span class=\"property\">document</span>.<span class=\"title function_\">write</span>(<span class=\"string\">&#x27;&lt;script&gt;alert(&quot;test&quot;)&lt;&#x27;</span> + <span class=\"string\">&#x27;/script&gt;&#x27;</span>); cw...&lt;/x-turndown&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">*   <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;tst&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;javascript:false&quot;</span>\\&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span></span><br><span class=\"line\">*   <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   <span class=\"keyword\">var</span> cw = <span class=\"variable language_\">window</span>.<span class=\"property\">frames</span>\\[<span class=\"string\">&#x27;tst&#x27;</span>\\];</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">open</span>();</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">write</span>(<span class=\"string\">&#x27;&lt;script&gt;alert(&quot;test&quot;)&lt;&#x27;</span> + <span class=\"string\">&#x27;/script&gt;&#x27;</span>);</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">write</span>(<span class=\"string\">&#x27;&lt;div&gt;test&lt;/div&gt;&#x27;</span>);</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   cw.<span class=\"property\">document</span>.<span class=\"title function_\">close</span>();</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">*   </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>这段代码可以实现 js动态的创建iframe，然后向里面append DOM元素、JS函数</p>\n<p>js动态的创建iframe：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> f=<span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;IFRAME&quot;</span>);  </span><br><span class=\"line\">f.<span class=\"property\">id</span> = <span class=\"string\">&quot;iframe01&quot;</span>;  </span><br><span class=\"line\">f.<span class=\"property\">name</span>= <span class=\"string\">&quot;iframe01&quot;</span>;  </span><br><span class=\"line\">f.<span class=\"property\">height</span>=<span class=\"number\">1000</span>;  </span><br><span class=\"line\">f.<span class=\"property\">width</span>=<span class=\"number\">1000</span>;  </span><br><span class=\"line\">f.<span class=\"property\">src</span>=<span class=\"string\">&#x27;https://system.netsuite.com/app/accounting/transactions/inventory/inventorynumbereditor.nl?l=T&amp;tranid=745&amp;lineid=1&#x27;</span>; <span class=\"comment\">//&quot;about:blank&quot;  </span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(f);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> header= <span class=\"keyword\">new</span> <span class=\"title class_\">Array</span>();  </span><br><span class=\"line\">header\\[<span class=\"string\">&#x27;P3P: CP&#x27;</span>\\]= <span class=\"string\">&#x27;CURa ADMa DEVa PSAo PSDo OUR BUS UNI PUR INT DEM STA PRE COM NAV OTC NOI DSP COR&#x27;</span>;  </span><br><span class=\"line\">header\\[<span class=\"string\">&#x27;Set-Cookie&#x27;</span>\\]= <span class=\"string\">&#x27;test=axis; expires=Sun, 23-Dec-2018 08:13:02 GMT; domain=.google.com; path=/&#x27;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">var</span> url =<span class=\"string\">&#x27;https://mail.google.com/mail/#inbox&#x27;</span>;  </span><br><span class=\"line\"><span class=\"title function_\">nlapiRequestURL</span>(url, <span class=\"literal\">null</span>, header);</span><br></pre></td></tr></table></figure>\n<p>如上代码失败可知：ajax不支持跨域， 这样跨域必须要用到php,jsp或者c++等动态语言服务端的代理。</p>\n<p>详细见：</p>\n<p><a href=\"http://blog.csdn.net/lanmao100/archive/2008/04/25/2328491.aspx\">http://blog.csdn.net/lanmao100/archive/2008/04/25/2328491.aspx</a> 用P3P header解决iframe跨域访问cookie&#x2F;session</p>\n<p><a href=\"http://viralpatel.net/blogs/2008/12/how-to-set-third-party-cookies-with-iframe.html\">http://viralpatel.net/blogs/2008/12/how-to-set-third-party-cookies-with-iframe.html</a> How to set third-party cookies with iframe</p>\n<p><a href=\"http://hi.baidu.com/aullik5/blog/item/cde7f31efc3953f2e0fe0b46.html\">http://hi.baidu.com/aullik5/blog/item/cde7f31efc3953f2e0fe0b46.html</a> P3P Header Tips</p>","categories":[{"name":"Javascript","path":"api/categories/Javascript.json"}],"tags":[{"name":"Javascript","path":"api/tags/Javascript.json"},{"name":"JS","path":"api/tags/JS.json"}]}