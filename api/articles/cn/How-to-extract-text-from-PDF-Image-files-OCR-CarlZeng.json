{"title":"How to extract text from PDF(Image) files, OCR-CarlZeng","slug":"cn/How-to-extract-text-from-PDF-Image-files-OCR-CarlZeng","date":"2020-11-25T02:43:00.000Z","updated":"2023-10-02T02:27:29.050Z","comments":true,"path":"api/articles/cn/How-to-extract-text-from-PDF-Image-files-OCR-CarlZeng.json","excerpt":"How to extract text from PDF(Image) files","covers":null,"content":"<p>How to extract text from PDF(Image) files</p>\n<!-- more -->\n<p>Background: below is SS1.0 as example since it came from NetSuite email plugin, SS2.0 is the same thing.</p>\n<h1 id=\"1-Registry-a-API-key-throw-https-ocr-space-OCRAPI\"><a href=\"#1-Registry-a-API-key-throw-https-ocr-space-OCRAPI\" class=\"headerlink\" title=\"1. Registry a API key throw https://ocr.space/OCRAPI\"></a>1. Registry a API key throw <a href=\"https://ocr.space/OCRAPI\">https://ocr.space/OCRAPI</a></h1><p>There are limitations for Free Plan</p>\n<h1 id=\"2-Save-the-email-attachment-PDF-file-to-NetSuite-FileCabinet-set-it-to-available-without-login-get-the-full-url-address-encode-it\"><a href=\"#2-Save-the-email-attachment-PDF-file-to-NetSuite-FileCabinet-set-it-to-available-without-login-get-the-full-url-address-encode-it\" class=\"headerlink\" title=\"2. Save the email attachment(PDF file) to NetSuite FileCabinet, set it to available without login, get the full url address, encode it.\"></a>2. Save the email attachment(PDF file) to NetSuite FileCabinet, set it to available without login, get the full url address, encode it.</h1><p>var importFile &#x3D; attachments[indexAtt];importFile.setIsOnline(true);<br>var intFileId &#x3D; nlapiSubmitFile(importFile);<br>var strInvFileUrl &#x3D; “https:&#x2F;&#x2F;“ + nlapiGetContext().getCompany() + “.app.netsuite.com”+ objInvoiceFileRec.getURL();<br>strInvFileUrl &#x3D; encodeURIComponent(strInvFileUrl);</p>\n<h1 id=\"3-Send-Request-to-https-api-ocr-space-parse-imageurl-apikey-abcAPIKEYabc-filetype-PDF-isTable-true-url\"><a href=\"#3-Send-Request-to-https-api-ocr-space-parse-imageurl-apikey-abcAPIKEYabc-filetype-PDF-isTable-true-url\" class=\"headerlink\" title=\"3. Send Request to https://api.ocr.space/parse/imageurl?apikey=abcAPIKEYabc&amp;filetype=PDF&amp;isTable=true&amp;url=\"></a>3. Send Request to <a href=\"https://api.ocr.space/parse/imageurl?apikey=abcAPIKEYabc&filetype=PDF&isTable=true&url=\">https://api.ocr.space/parse/imageurl?apikey=abcAPIKEYabc&amp;filetype=PDF&amp;isTable=true&amp;url=</a></h1><p>var response &#x3D; nlapiRequestURL(strReqUrl, null, a);<br>There are varience of parameters for this API, in my case, it’s invoice formated as table, that’s why I send isTable&#x3D;true to identify it; then it will help me to locate the expected cell and values.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>4. Got and parsed the Response, we will get the Text messages on the PDF or Images.</p>\n<p>var arrParsedLines &#x3D; (objOcrRes[‘ParsedResults’] &amp;&amp; objOcrRes[‘ParsedResults’][0]) ? objOcrRes[‘ParsedResults’][0][‘TextOverlay’][‘Lines’]: null;<br>var objVndBillData &#x3D; parseDataFromInvPdf(arrParsedLines);</p>\n","more":"<p>How to extract text from PDF(Image) files</p>\n<!-- more -->\n<p>Background: below is SS1.0 as example since it came from NetSuite email plugin, SS2.0 is the same thing.</p>\n<h1 id=\"1-Registry-a-API-key-throw-https-ocr-space-OCRAPI\"><a href=\"#1-Registry-a-API-key-throw-https-ocr-space-OCRAPI\" class=\"headerlink\" title=\"1. Registry a API key throw https://ocr.space/OCRAPI\"></a>1. Registry a API key throw <a href=\"https://ocr.space/OCRAPI\">https://ocr.space/OCRAPI</a></h1><p>There are limitations for Free Plan</p>\n<h1 id=\"2-Save-the-email-attachment-PDF-file-to-NetSuite-FileCabinet-set-it-to-available-without-login-get-the-full-url-address-encode-it\"><a href=\"#2-Save-the-email-attachment-PDF-file-to-NetSuite-FileCabinet-set-it-to-available-without-login-get-the-full-url-address-encode-it\" class=\"headerlink\" title=\"2. Save the email attachment(PDF file) to NetSuite FileCabinet, set it to available without login, get the full url address, encode it.\"></a>2. Save the email attachment(PDF file) to NetSuite FileCabinet, set it to available without login, get the full url address, encode it.</h1><p>var importFile &#x3D; attachments[indexAtt];importFile.setIsOnline(true);<br>var intFileId &#x3D; nlapiSubmitFile(importFile);<br>var strInvFileUrl &#x3D; “https:&#x2F;&#x2F;“ + nlapiGetContext().getCompany() + “.app.netsuite.com”+ objInvoiceFileRec.getURL();<br>strInvFileUrl &#x3D; encodeURIComponent(strInvFileUrl);</p>\n<h1 id=\"3-Send-Request-to-https-api-ocr-space-parse-imageurl-apikey-abcAPIKEYabc-filetype-PDF-isTable-true-url\"><a href=\"#3-Send-Request-to-https-api-ocr-space-parse-imageurl-apikey-abcAPIKEYabc-filetype-PDF-isTable-true-url\" class=\"headerlink\" title=\"3. Send Request to https://api.ocr.space/parse/imageurl?apikey=abcAPIKEYabc&amp;filetype=PDF&amp;isTable=true&amp;url=\"></a>3. Send Request to <a href=\"https://api.ocr.space/parse/imageurl?apikey=abcAPIKEYabc&filetype=PDF&isTable=true&url=\">https://api.ocr.space/parse/imageurl?apikey=abcAPIKEYabc&amp;filetype=PDF&amp;isTable=true&amp;url=</a></h1><p>var response &#x3D; nlapiRequestURL(strReqUrl, null, a);<br>There are varience of parameters for this API, in my case, it’s invoice formated as table, that’s why I send isTable&#x3D;true to identify it; then it will help me to locate the expected cell and values.</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>4. Got and parsed the Response, we will get the Text messages on the PDF or Images.</p>\n<p>var arrParsedLines &#x3D; (objOcrRes[‘ParsedResults’] &amp;&amp; objOcrRes[‘ParsedResults’][0]) ? objOcrRes[‘ParsedResults’][0][‘TextOverlay’][‘Lines’]: null;<br>var objVndBillData &#x3D; parseDataFromInvPdf(arrParsedLines);</p>\n","categories":[],"tags":[]}