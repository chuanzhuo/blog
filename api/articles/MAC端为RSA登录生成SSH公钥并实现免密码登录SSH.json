{"title":"MAC端为RSA登录生成SSH公钥并实现免密码登录SSH","slug":"MAC端为RSA登录生成SSH公钥并实现免密码登录SSH","date":"2024-09-26T00:13:40.000Z","updated":"2024-09-26T08:21:44.098Z","comments":true,"path":"api/articles/MAC端为RSA登录生成SSH公钥并实现免密码登录SSH.json","excerpt":" [Figure] ","covers":null,"content":"<img class=\"lozad\" data-src=\"\">\n\n<span id=\"more\"></span>\n<div> \n<button onclick=\"synthesizeSpeech()\">朗读全文</button>\n</div>\n<audio controls id=\"audioPlayer\">Your browser does not support the audio element.</audio>      \n<script>\n  function synthesizeSpeech() { \n    var inputText = document.getElementsByClassName('post-block')[0].innerText;\n    var voice = \"ZH\";\n    var url = 'https://tts.carlzeng.top:3/speech?text=' + encodeURIComponent(inputText.substring(0,3000)) + '&voice=' + voice;\n    var audioPlayer = document.getElementById('audioPlayer');          \n    audioPlayer.src = url;\n    audioPlayer.load();\n    audioPlayer.play();\n  }\n</script>\n\n\n<h1 id=\"有什么用\"><a href=\"#有什么用\" class=\"headerlink\" title=\"有什么用\"></a>有什么用</h1><p>MAC端为RSA登录生成SSH公钥并实现免密码登录SSH</p>\n<p>让每次SSH登录 免掉输入密码的2个繁琐步骤 (由于密码太长太复杂而变得繁琐, 而且root用户需要两次输入才能到达)</p>\n<h1 id=\"怎么用\"><a href=\"#怎么用\" class=\"headerlink\" title=\"怎么用\"></a>怎么用</h1><p>在Mac的终端中使用ssh-keygen命令创建RSA类型的SSH密钥</p>\n<ol>\n<li>打开mac的终端，输入以下命令：ssh-keygen -t rsa</li>\n<li>将生成出来的id_rsa.pub公钥文件, 复制到群晖的目录下: <ol>\n<li>以管理员身份登录 DSM。</li>\n<li>进入 DSM File Station &gt; home 。</li>\n<li>创建名为.ssh的子文件夹。</li>\n<li>将公共密钥id_rsa.pub上传到.ssh文件夹。</li>\n</ol>\n</li>\n<li>如何通过 SSH 使用 RSA 密钥对登录 DSM<ol>\n<li>按步骤操作还是没成功, 太复杂,繁琐; 等待下一步测试</li>\n<li><a href=\"https://kb.synology.cn/zh-cn/DSM/tutorial/How_to_log_in_to_DSM_with_key_pairs_as_admin_or_root_permission_via_SSH_on_computers#x_anchor_ida892\">如何通过 SSH 使用 RSA 密钥对登录 DSM？</a></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ol>\n<hr>\n<h2 id=\"MAC用脚本自动登录SSH-root用户\"><a href=\"#MAC用脚本自动登录SSH-root用户\" class=\"headerlink\" title=\"MAC用脚本自动登录SSH root用户\"></a>MAC用脚本自动登录SSH root用户</h2><p>新建一个sshNas.sh 内容如下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/usr/bin/expect</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> <span class=\"built_in\">timeout</span> 30</span><br><span class=\"line\"><span class=\"built_in\">set</span> password ******</span><br><span class=\"line\">spawn ssh carlzeng@192.168.6.203</span><br><span class=\"line\">expect <span class=\"string\">&quot;*assword:&quot;</span></span><br><span class=\"line\">send <span class=\"string\">&quot;<span class=\"variable\">$password</span>\\r&quot;</span></span><br><span class=\"line\">expect <span class=\"string\">&quot;*carlzeng*&quot;</span></span><br><span class=\"line\">send <span class=\"string\">&quot;sudo -i\\r&quot;</span></span><br><span class=\"line\">expect <span class=\"string\">&quot;*assword:&quot;</span></span><br><span class=\"line\">send <span class=\"string\">&quot;<span class=\"variable\">$password</span>\\r&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">interact</span><br></pre></td></tr></table></figure>\n\n<p>赋予执行权限 chmod +X</p>\n<p>运行后, 就直接到NAS的root权限</p>\n<h1 id=\"相关内容\"><a href=\"#相关内容\" class=\"headerlink\" title=\"相关内容\"></a>相关内容</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.top:3/appsearch?q=ssh\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n<h1 id=\"实现方法-过程\"><a href=\"#实现方法-过程\" class=\"headerlink\" title=\"实现方法&#x2F;过程\"></a>实现方法&#x2F;过程</h1><p>生产密钥的过程</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">% ssh-keygen -t rsa                                                         </span><br><span class=\"line\">Generating public/private rsa key pair.                                                                  </span><br><span class=\"line\">Enter file <span class=\"keyword\">in</span> <span class=\"built_in\">which</span> to save the key (/Users/carlzeng/.ssh/id_rsa):                                       </span><br><span class=\"line\">Enter passphrase (empty <span class=\"keyword\">for</span> no passphrase):                                                              </span><br><span class=\"line\">Enter same passphrase again:                                                                             </span><br><span class=\"line\">Your identification has been saved <span class=\"keyword\">in</span> /Users/carlzeng/.ssh/id_rsa                                        </span><br><span class=\"line\">Your public key has been saved <span class=\"keyword\">in</span> /Users/carlzeng/.ssh/id_rsa.pub                                        </span><br><span class=\"line\">The key fingerprint is:                                                                                  </span><br><span class=\"line\">SHA256:sde2S5q6QnXOoLvA32vGAOuhcJeLNPQ1eLbdtTrTgSw carlzeng@Carls-MBP.lan                                </span><br><span class=\"line\">The key<span class=\"string\">&#x27;s randomart image is:                                                                            </span></span><br><span class=\"line\"><span class=\"string\">+---[RSA 3072]----+                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|                 |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|                 |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|     .  .        |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|  . o = oo...    |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">| . . B *SB.oo.   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|. +.* = E.*.o.   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">| + *o+ + . oo.   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|  o ooo.+ ++..   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|      o==+oo.    |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">+----[SHA256]-----+                                      </span></span><br></pre></td></tr></table></figure>\n\n<p>由于登录时仍然提示输入密码, 暂时先使用了ssh的方案: MAC用脚本自动登录SSH root用户</p>\n<p>密钥的上传到NAS和应用设置生效, 有待进一步测试</p>\n","more":"<div> \n<button onclick=\"synthesizeSpeech()\">朗读全文</button>\n</div>\n<audio controls id=\"audioPlayer\">Your browser does not support the audio element.</audio>      \n<script>\n  function synthesizeSpeech() { \n    var inputText = document.getElementsByClassName('post-block')[0].innerText;\n    var voice = \"ZH\";\n    var url = 'https://tts.carlzeng.top:3/speech?text=' + encodeURIComponent(inputText.substring(0,3000)) + '&voice=' + voice;\n    var audioPlayer = document.getElementById('audioPlayer');          \n    audioPlayer.src = url;\n    audioPlayer.load();\n    audioPlayer.play();\n  }\n</script>\n\n\n<h1 id=\"有什么用\"><a href=\"#有什么用\" class=\"headerlink\" title=\"有什么用\"></a>有什么用</h1><p>MAC端为RSA登录生成SSH公钥并实现免密码登录SSH</p>\n<p>让每次SSH登录 免掉输入密码的2个繁琐步骤 (由于密码太长太复杂而变得繁琐, 而且root用户需要两次输入才能到达)</p>\n<h1 id=\"怎么用\"><a href=\"#怎么用\" class=\"headerlink\" title=\"怎么用\"></a>怎么用</h1><p>在Mac的终端中使用ssh-keygen命令创建RSA类型的SSH密钥</p>\n<ol>\n<li>打开mac的终端，输入以下命令：ssh-keygen -t rsa</li>\n<li>将生成出来的id_rsa.pub公钥文件, 复制到群晖的目录下: <ol>\n<li>以管理员身份登录 DSM。</li>\n<li>进入 DSM File Station &gt; home 。</li>\n<li>创建名为.ssh的子文件夹。</li>\n<li>将公共密钥id_rsa.pub上传到.ssh文件夹。</li>\n</ol>\n</li>\n<li>如何通过 SSH 使用 RSA 密钥对登录 DSM<ol>\n<li>按步骤操作还是没成功, 太复杂,繁琐; 等待下一步测试</li>\n<li><a href=\"https://kb.synology.cn/zh-cn/DSM/tutorial/How_to_log_in_to_DSM_with_key_pairs_as_admin_or_root_permission_via_SSH_on_computers#x_anchor_ida892\">如何通过 SSH 使用 RSA 密钥对登录 DSM？</a></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ol>\n<hr>\n<h2 id=\"MAC用脚本自动登录SSH-root用户\"><a href=\"#MAC用脚本自动登录SSH-root用户\" class=\"headerlink\" title=\"MAC用脚本自动登录SSH root用户\"></a>MAC用脚本自动登录SSH root用户</h2><p>新建一个sshNas.sh 内容如下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/usr/bin/expect</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> <span class=\"built_in\">timeout</span> 30</span><br><span class=\"line\"><span class=\"built_in\">set</span> password ******</span><br><span class=\"line\">spawn ssh carlzeng@192.168.6.203</span><br><span class=\"line\">expect <span class=\"string\">&quot;*assword:&quot;</span></span><br><span class=\"line\">send <span class=\"string\">&quot;<span class=\"variable\">$password</span>\\r&quot;</span></span><br><span class=\"line\">expect <span class=\"string\">&quot;*carlzeng*&quot;</span></span><br><span class=\"line\">send <span class=\"string\">&quot;sudo -i\\r&quot;</span></span><br><span class=\"line\">expect <span class=\"string\">&quot;*assword:&quot;</span></span><br><span class=\"line\">send <span class=\"string\">&quot;<span class=\"variable\">$password</span>\\r&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">interact</span><br></pre></td></tr></table></figure>\n\n<p>赋予执行权限 chmod +X</p>\n<p>运行后, 就直接到NAS的root权限</p>\n<h1 id=\"相关内容\"><a href=\"#相关内容\" class=\"headerlink\" title=\"相关内容\"></a>相关内容</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.top:3/appsearch?q=ssh\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n<h1 id=\"实现方法-过程\"><a href=\"#实现方法-过程\" class=\"headerlink\" title=\"实现方法&#x2F;过程\"></a>实现方法&#x2F;过程</h1><p>生产密钥的过程</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">% ssh-keygen -t rsa                                                         </span><br><span class=\"line\">Generating public/private rsa key pair.                                                                  </span><br><span class=\"line\">Enter file <span class=\"keyword\">in</span> <span class=\"built_in\">which</span> to save the key (/Users/carlzeng/.ssh/id_rsa):                                       </span><br><span class=\"line\">Enter passphrase (empty <span class=\"keyword\">for</span> no passphrase):                                                              </span><br><span class=\"line\">Enter same passphrase again:                                                                             </span><br><span class=\"line\">Your identification has been saved <span class=\"keyword\">in</span> /Users/carlzeng/.ssh/id_rsa                                        </span><br><span class=\"line\">Your public key has been saved <span class=\"keyword\">in</span> /Users/carlzeng/.ssh/id_rsa.pub                                        </span><br><span class=\"line\">The key fingerprint is:                                                                                  </span><br><span class=\"line\">SHA256:sde2S5q6QnXOoLvA32vGAOuhcJeLNPQ1eLbdtTrTgSw carlzeng@Carls-MBP.lan                                </span><br><span class=\"line\">The key<span class=\"string\">&#x27;s randomart image is:                                                                            </span></span><br><span class=\"line\"><span class=\"string\">+---[RSA 3072]----+                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|                 |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|                 |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|     .  .        |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|  . o = oo...    |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">| . . B *SB.oo.   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|. +.* = E.*.o.   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">| + *o+ + . oo.   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|  o ooo.+ ++..   |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">|      o==+oo.    |                                                                                      </span></span><br><span class=\"line\"><span class=\"string\">+----[SHA256]-----+                                      </span></span><br></pre></td></tr></table></figure>\n\n<p>由于登录时仍然提示输入密码, 暂时先使用了ssh的方案: MAC用脚本自动登录SSH root用户</p>\n<p>密钥的上传到NAS和应用设置生效, 有待进一步测试</p>","categories":[{"name":"SSH","path":"api/categories/SSH.json"}],"tags":[{"name":"SSH","path":"api/tags/SSH.json"},{"name":"MAC","path":"api/tags/MAC.json"},{"name":"RSA","path":"api/tags/RSA.json"}]}