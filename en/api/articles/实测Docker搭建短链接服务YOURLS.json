{"title":"Practice Test - Docker Deployment of URL Shortening Service YOURLS","slug":"实测Docker搭建短链接服务YOURLS","date":"2023-11-08T02:03:29.000Z","updated":"2024-10-25T14:42:55.816Z","comments":true,"path":"api/articles/实测Docker搭建短链接服务YOURLS.json","excerpt":"A service for shortening URLs, allowing you to operate a URL shortening service on your own server. It provides complete control over your data, including simple statistics, analysis, and numerous plugins.","covers":["https://www.evernote.com/shard/s122/sh/da92cf63-633f-4527-800e-0c6360c55eac/hQ1AvljDYWbfCVIJtDV8YmhOlX9tUiGxUde88Fthy09LJZmfcf5yPozqCw/deep/0/image.png","https://www.evernote.com/shard/s122/sh/9cdd27f6-a8d0-42eb-8b74-72c3635ffb2b/CkXm5XGWidMRJSsB7i3iEiczTZiTUNFkt5n6EKNcq98jQLOqQjDPsshZfg/deep/0/image.png"],"content":"<p>A service for shortening URLs, allowing you to operate a URL shortening service on your own server. It provides complete control over your data, including simple statistics, analysis, and numerous <a href=\"https://github.com/YOURLS/awesome#plugins\">plugins</a>.</p>\n<span id=\"more\"></span>\n\n<div class=\"note success\"><p>December 30, 2023: Escaping the clutches of the MySQL database, embracing its branch, MariaDB.</p>\n<p>Reason: In the event of an unexpected power failure, MySQL reported errors when Docker was started, which could not be resolved. In comparison, MariaDB provides a better solution.</p>\n</div>\n\n<img class=\"lozad\" data-src=\"https://www.evernote.com/shard/s122/sh/da92cf63-633f-4527-800e-0c6360c55eac/hQ1AvljDYWbfCVIJtDV8YmhOlX9tUiGxUde88Fthy09LJZmfcf5yPozqCw/deep/0/image.png\">\n\n<h1 id=\"Purpose\"><a href=\"#Purpose\" class=\"headerlink\" title=\"Purpose\"></a>Purpose</h1><p>This is a URL shortening service that enables you to run a URL shortening service on your own server. Its features include complete control over your data, including statistics, analysis, and the ability to install various plugins. It also allows for the management of links related to Clash.</p>\n<p>Existing online URL shortening solutions often come with obvious drawbacks, some of which involve hidden and specific redirections.</p>\n<h2 id=\"Existing-URL-Shortening-Resources\"><a href=\"#Existing-URL-Shortening-Resources\" class=\"headerlink\" title=\"Existing URL Shortening Resources\"></a>Existing URL Shortening Resources</h2><p><a href=\"https://www.sina.lt/\">Short Links</a><br>- <a href=\"https://t.hk.uy/b5kg\">https://t.hk.uy/b5kg</a><br>- <a href=\"https://netlify.carlzeng.com/\">https://netlify.carlzeng.com</a> currently does not support the domain name you entered. Use this URL to shorten: <a href=\"https://sage-halva-bac054.netlify.app/\">https://sage-halva-bac054.netlify.app</a><br>- <a href=\"https://t.hk.uy/b6qy\">https://t.hk.uy/b6qy</a></p>\n<p><a href=\"https://goo.su/lang/zh\">Easily Shorten Links</a><br>- <a href=\"https://goo.su/BwRaE1T\">https://goo.su/BwRaE1T</a><br>- <a href=\"https://goo.su/prTA5T5\">https://goo.su/prTA5T5</a></p>\n<p><a href=\"https://www.ifreesite.com/shorturl/\">URL Shortener</a><br>- <a href=\"https://tinyurl.com/yurgh2fm\">https://tinyurl.com/yurgh2fm</a></p>\n<p><a href=\"https://www.dwz.lc/\">Traditional Free URL Shortening Tool</a><br>- <a href=\"http://s8u.cn/HIG7o\">http://s8u.cn/HIG7o</a><br>- Elegant, but unable to accept: first redirects to a link, then restores the original URL.</p>\n<p>Change of Perspective:<br>Use your own domain name for shorter ‘Nname’;<br>Setting up your own URL shortening service</p>\n<h1 id=\"Implementation-Details-and-Process-Notes\"><a href=\"#Implementation-Details-and-Process-Notes\" class=\"headerlink\" title=\"Implementation Details and Process Notes\"></a>Implementation Details and Process Notes</h1><h2 id=\"Visual-Guide\"><a href=\"#Visual-Guide\" class=\"headerlink\" title=\"Visual Guide\"></a>Visual Guide</h2><p>[Fun Docker Project] Setting up your own URL Shortening Service—YOURLS in 10 minutes](<a href=\"https://iwanlab.com/docker-compose-install-yourls/\">https://iwanlab.com/docker-compose-install-yourls/</a>)<br>[Server] How to Set Up Your Own Private Short URL Service Using Docker](<a href=\"https://www.hellosanta.com.tw/knowledge/category-38/post-219\">https://www.hellosanta.com.tw/knowledge/category-38/post-219</a>)</p>\n<h2 id=\"Process-Issues-Encountered-and-Solutions\"><a href=\"#Process-Issues-Encountered-and-Solutions\" class=\"headerlink\" title=\"Process, Issues Encountered, and Solutions\"></a>Process, Issues Encountered, and Solutions</h2><p>In the ‘bt’ directory, a docker-compose template was created,<br><code>docker-compose -f yours.yml up</code><br>Then, a firewall rule was added to allow traffic through port 8200</p>\n<p>After adding a firewall rule, it was impossible to connect to the ‘bt’ panel</p>\n<p>Setting up your own URL shortening service</p>\n<p><a href=\"https://www.cnblogs.com/CyLee/p/16152673.html\">Old Version</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3.5&quot;</span><br><span class=\"line\">services:</span><br><span class=\"line\"></span><br><span class=\"line\">  mysql:</span><br><span class=\"line\">    image: mysql:5.7.42   # If incorrect database configuration occurs, or there is a failure to connect to the database with the message: &quot;PDOException: SQLSTATE[HY000] [1045] Access denied for user &#x27;yourls&#x27;@&#x27;yourls_service.yourls_default&#x27; (using password: YES)&quot;, changing 5.7.22 to 5.7 may resolve it</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - MYSQL_ROOT_PASSWORD=my-secret-pw</span><br><span class=\"line\">      - MYSQL_DATABASE=yourls</span><br><span class=\"line\">      - MYSQL_USER=yourls</span><br><span class=\"line\">      - MYSQL_PASSWORD=yourls</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./mysql/db/:/var/lib/mysql</span><br><span class=\"line\">      - ./mysql/conf/:/etc/mysql/conf.d # Caution: It is important to note that the original author added a &quot;.d&quot; character (probably due to automatic tab input in debian), which caused troubleshooting effort for half an hour before successful resolution</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    container_name: yourls_mysql # This naming convention helps avoid problems with duplicate names when there are multiple Docker instances, and it provides clear documentation</span><br><span class=\"line\">  </span><br><span class=\"line\">  yourls:</span><br><span class=\"line\">    image: yourls</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;8200:80&quot;</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      YOURLS_DB_HOST: mysql</span><br><span class=\"line\">      YOURLS_DB_USER: admin</span><br><span class=\"line\">      YOURLS_DB_PASS: admin</span><br><span class=\"line\">      YOURLS_DB_NAME: yourls</span><br><span class=\"line\">      YOURLS_USER: admin      # Choose your own username</span><br><span class=\"line\">      YOURLS_PASS: 123admin@@      # Choose your own login password</span><br><span class=\"line\">      YOURLS_SITE: https://c.carlzeng.com:4443  # Replace with your own domain and ensure that Nginx Proxy Manager points to this address</span><br><span class=\"line\">      YOURLS_HOURS_OFFSET: 8</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./yourls_data/:/var/www/html   </span><br><span class=\"line\">    container_name: yourls_service</span><br><span class=\"line\">    links:</span><br><span class=\"line\">      - mysql:mysql</span><br></pre></td></tr></table></figure>\n\n<p>Reported Error:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yours_mysql     | 2023-11-07 13:33:44+00:00 [Note] [Entrypoint]: Switching to dedicated user &#x27;mysql&#x27;</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:44+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.44-1.el7 started.</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:44+00:00 [ERROR] [Entrypoint]: mysqld failed while attempting to check config</span><br><span class=\"line\">yours_mysql     |       command was: mysqld --verbose --help --log-bin-index=/tmp/tmp.5snRuPe4br</span><br><span class=\"line\">yours_mysql     |       mysqld: Can&#x27;t read dir of &#x27;/etc/mysql/conf.d/&#x27; (Errcode: 13 - Permission denied)</span><br><span class=\"line\">yours_mysql     | mysqld: [ERROR] Fatal error in defaults handling. Program aborted!</span><br><span class=\"line\">yours_mysql exited with code 1</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:57+00:00 [Note] [Entrypoint]: Switching to dedicated user &#x27;mysql&#x27;</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:57+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.44-1.el7 started.</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:57+00:00 [ERROR] [Entrypoint]: mysqld failed while attempting to check config</span><br><span class=\"line\">yours_mysql     |       command was: mysqld --verbose --help --log-bin-index=/tmp/tmp.atOD1yOw77</span><br><span class=\"line\">yours_mysql     |       mysqld: Can&#x27;t read dir of &#x27;/etc/mysql/conf.d/&#x27; (Errcode: 13 - Permission denied)</span><br><span class=\"line\">yours_mysql     | mysqld: [ERROR] Fatal error in defaults handling. Program aborted!</span><br></pre></td></tr></table></figure>\n\n<p>Resolved on 20231229[Resolved]: Updated the mapping directory for MySQL docker; reinstalled everything. Data Loss (including the shortened link data and access statistics data).</p>\n<p>The completed solution is to use the <a href=\"https://github.com/GautamGupta/YOURLS-Import-Export\">GautamGupta&#x2F;YOURLS-Import-Export</a> plugin for effortless export and import functionality.</p>\n<p>Detailed installation steps:</p>\n<ol>\n<li><a href=\"https://github.com/GautamGupta/YOURLS-Import-Export/zipball/master\">Download the zip</a>.</li>\n<li>Extract the zip.</li>\n<li>Place the YOURLS-Import-Export folder in the user&#x2F;plugins directory.</li>\n<li>Activate the plugin.</li>\n<li>Restart Docker<br><code>docker-compose -f &#39;yourls_service.yaml&#39; restart</code></li>\n</ol>\n<p>Experience: Very user-friendly; for example, the current all-link list can be exported (or backed up). In special situations, starting over from scratch (saving time).</p>\n<p>Derived Readings: <a href=\"https://github.com/YOURLS/awesome#plugins\">Plugins List</a>: This list of plugins is categorized alphabetically and can be searched for specific functionalities directly on the page.</p>\n<h2 id=\"Next-Steps\"><a href=\"#Next-Steps\" class=\"headerlink\" title=\"Next Steps\"></a>Next Steps</h2><p>Feature: Analyze specific user attribute information, such as IP addresses, GEO addresses, similar to the detailed list provided by statcounter.com</p>\n<h3 id=\"yourls-geoip-update\"><a href=\"#yourls-geoip-update\" class=\"headerlink\" title=\"yourls-geoip-update\"></a>yourls-geoip-update</h3><p>Unable to update the database.<br>Error downloading “GeoLite2-Country”. Invalid license key.</p>\n<p><img class=\"lozad\" data-src=\"https://www.evernote.com/shard/s122/sh/9cdd27f6-a8d0-42eb-8b74-72c3635ffb2b/CkXm5XGWidMRJSsB7i3iEiczTZiTUNFkt5n6EKNcq98jQLOqQjDPsshZfg/deep/0/image.png\"> Do your best; can someone correct this for me?</p>\n<p>On 20231216, attempts to update the mmdb database file in the directory .&#x2F;yourls_data20231120&#x2F;includes&#x2F;geo proved ineffective.</p>\n<ol>\n<li>Uploaded GeoLite2-City.mmdb</li>\n<li>Copied and replaced the original GeoLite2-Country.mmdb</li>\n<li>This resulted in two new 64.34MB files, up from the original 5.41MB files</li>\n<li>Todo: Observe the changes</li>\n</ol>\n<blockquote>\n<p>On 20231216, practical tests proved that there was no change. Next step:</p>\n<ol>\n<li>Download <a href=\"https://chat.carlzeng.com:4443/alecthw/mmdb_china_ip_list\">alecthw&#x2F;mmdb_china_ip_list</a> to obtain the Country.mmdb file</li>\n<li>Upload it to .&#x2F;yourls_data20231120&#x2F;includes&#x2F;geo and replace the original GeoLite2-Country.mmdb.</li>\n<li>Restart Docker, Todo: Observe the changes.</li>\n</ol>\n</blockquote>\n<h2 id=\"Advantages-and-Disadvantages\"><a href=\"#Advantages-and-Disadvantages\" class=\"headerlink\" title=\"Advantages and Disadvantages\"></a>Advantages and Disadvantages</h2><h3 id=\"Advantages-of-Yourls\"><a href=\"#Advantages-of-Yourls\" class=\"headerlink\" title=\"Advantages of Yourls\"></a>Advantages of Yourls</h3><p>Numerous plugins for flexible assembly. Plugin list: <a href=\"https://github.com/YOURLS/awesome#plugins\">YOURLS Awesome List</a>.</p>\n<h3 id=\"Disadvantages-of-Yourls\"><a href=\"#Disadvantages-of-Yourls\" class=\"headerlink\" title=\"Disadvantages of Yourls\"></a>Disadvantages of Yourls</h3><p>The statistical functionality is basic and weak, almost at a comical level.<br>The documentation is not clear and straightforward. In the case of a failed GeoIP update, how can IP data be manually uploaded to that directory? It is surprising that this information is not easily found through a search engine.</p>\n<hr>\n<h1 id=\"Docker-Installation-of-X-UI\"><a href=\"#Docker-Installation-of-X-UI\" class=\"headerlink\" title=\"Docker Installation of X-UI\"></a>Docker Installation of X-UI</h1><p>Setting up Xray panel that supports multiple users and protocols on a single port - the ultimate chimera</p>\n<p>FranzKafkaYu&#x2F;x-ui version was used, only needing to modify the above image to enwaiax&#x2F;x-ui:alpha-zh. As the telegram bot was temporarily not in use, the default was switched back to <a href=\"https://github.com/vaxilu/x-ui\">vaxilu&#x2F;x-ui</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3.9&quot;</span><br><span class=\"line\">services:</span><br><span class=\"line\">  xui:</span><br><span class=\"line\">    image: enwaiax/x-ui</span><br><span class=\"line\">    container_name: xui</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - $PWD/db/:/etc/x-ui/</span><br><span class=\"line\">      - $PWD/cert/:/root/cert/</span><br><span class=\"line\">    restart: unless-stopped</span><br><span class=\"line\">    network_mode: host</span><br></pre></td></tr></table></figure>\n\n<p>A new directory was created, and the above configuration was added to x-ui.yaml<br><code>docker-compose -f x-ui.yaml up</code></p>\n<p><a href=\"https://www.amadues.link/archives/dockerda-jian-jie-dian-vless-ws-tls-web\">https://www.amadues.link/archives/dockerda-jian-jie-dian-vless-ws-tls-web</a><br>Following the solution of docker-compose.yaml: <a href=\"https://hostloc.com/thread-1108468-1-1.html\">https://hostloc.com/thread-1108468-1-1.html</a><br>Following the configuration: <a href=\"https://iwanlab.com/npm-xui/\">https://iwanlab.com/npm-xui/</a><br>Related video: <a href=\"https://www.youtube.com/watch?v=V3nsDicSMBc\">https://www.youtube.com/watch?v=V3nsDicSMBc</a></p>\n<p>To be tested:<br><code>vless://39fde2d2-c88c-4bea-d491-fb6990d49741@vmess.carlzeng.com:17866?type=ws&amp;security=none&amp;path=%2Fgugu#gugugee</code></p>\n<p>On-premises configurations helped in viewing and editing the settings: <a href=\"http://192.168.6.116:54321/fk/xui/\">http://192.168.6.116:54321/fk/xui/</a><br>Not successful…awaiting more client connection tests, waiting for rescue.</p>\n<p>Potential Resources:</p>\n<div class=\"tabs\" id=\"source\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#source-1\">Source 1</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"source-1\"><p>To be continued…</p></div></div></div>\n","more":"<div class=\"note success\"><p>December 30, 2023: Escaping the clutches of the MySQL database, embracing its branch, MariaDB.</p>\n<p>Reason: In the event of an unexpected power failure, MySQL reported errors when Docker was started, which could not be resolved. In comparison, MariaDB provides a better solution.</p>\n</div>\n\n<img class=\"lozad\" data-src=\"https://www.evernote.com/shard/s122/sh/da92cf63-633f-4527-800e-0c6360c55eac/hQ1AvljDYWbfCVIJtDV8YmhOlX9tUiGxUde88Fthy09LJZmfcf5yPozqCw/deep/0/image.png\">\n\n<h1 id=\"Purpose\"><a href=\"#Purpose\" class=\"headerlink\" title=\"Purpose\"></a>Purpose</h1><p>This is a URL shortening service that enables you to run a URL shortening service on your own server. Its features include complete control over your data, including statistics, analysis, and the ability to install various plugins. It also allows for the management of links related to Clash.</p>\n<p>Existing online URL shortening solutions often come with obvious drawbacks, some of which involve hidden and specific redirections.</p>\n<h2 id=\"Existing-URL-Shortening-Resources\"><a href=\"#Existing-URL-Shortening-Resources\" class=\"headerlink\" title=\"Existing URL Shortening Resources\"></a>Existing URL Shortening Resources</h2><p><a href=\"https://www.sina.lt/\">Short Links</a><br>- <a href=\"https://t.hk.uy/b5kg\">https://t.hk.uy/b5kg</a><br>- <a href=\"https://netlify.carlzeng.com/\">https://netlify.carlzeng.com</a> currently does not support the domain name you entered. Use this URL to shorten: <a href=\"https://sage-halva-bac054.netlify.app/\">https://sage-halva-bac054.netlify.app</a><br>- <a href=\"https://t.hk.uy/b6qy\">https://t.hk.uy/b6qy</a></p>\n<p><a href=\"https://goo.su/lang/zh\">Easily Shorten Links</a><br>- <a href=\"https://goo.su/BwRaE1T\">https://goo.su/BwRaE1T</a><br>- <a href=\"https://goo.su/prTA5T5\">https://goo.su/prTA5T5</a></p>\n<p><a href=\"https://www.ifreesite.com/shorturl/\">URL Shortener</a><br>- <a href=\"https://tinyurl.com/yurgh2fm\">https://tinyurl.com/yurgh2fm</a></p>\n<p><a href=\"https://www.dwz.lc/\">Traditional Free URL Shortening Tool</a><br>- <a href=\"http://s8u.cn/HIG7o\">http://s8u.cn/HIG7o</a><br>- Elegant, but unable to accept: first redirects to a link, then restores the original URL.</p>\n<p>Change of Perspective:<br>Use your own domain name for shorter ‘Nname’;<br>Setting up your own URL shortening service</p>\n<h1 id=\"Implementation-Details-and-Process-Notes\"><a href=\"#Implementation-Details-and-Process-Notes\" class=\"headerlink\" title=\"Implementation Details and Process Notes\"></a>Implementation Details and Process Notes</h1><h2 id=\"Visual-Guide\"><a href=\"#Visual-Guide\" class=\"headerlink\" title=\"Visual Guide\"></a>Visual Guide</h2><p>[Fun Docker Project] Setting up your own URL Shortening Service—YOURLS in 10 minutes](<a href=\"https://iwanlab.com/docker-compose-install-yourls/\">https://iwanlab.com/docker-compose-install-yourls/</a>)<br>[Server] How to Set Up Your Own Private Short URL Service Using Docker](<a href=\"https://www.hellosanta.com.tw/knowledge/category-38/post-219\">https://www.hellosanta.com.tw/knowledge/category-38/post-219</a>)</p>\n<h2 id=\"Process-Issues-Encountered-and-Solutions\"><a href=\"#Process-Issues-Encountered-and-Solutions\" class=\"headerlink\" title=\"Process, Issues Encountered, and Solutions\"></a>Process, Issues Encountered, and Solutions</h2><p>In the ‘bt’ directory, a docker-compose template was created,<br><code>docker-compose -f yours.yml up</code><br>Then, a firewall rule was added to allow traffic through port 8200</p>\n<p>After adding a firewall rule, it was impossible to connect to the ‘bt’ panel</p>\n<p>Setting up your own URL shortening service</p>\n<p><a href=\"https://www.cnblogs.com/CyLee/p/16152673.html\">Old Version</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3.5&quot;</span><br><span class=\"line\">services:</span><br><span class=\"line\"></span><br><span class=\"line\">  mysql:</span><br><span class=\"line\">    image: mysql:5.7.42   # If incorrect database configuration occurs, or there is a failure to connect to the database with the message: &quot;PDOException: SQLSTATE[HY000] [1045] Access denied for user &#x27;yourls&#x27;@&#x27;yourls_service.yourls_default&#x27; (using password: YES)&quot;, changing 5.7.22 to 5.7 may resolve it</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - MYSQL_ROOT_PASSWORD=my-secret-pw</span><br><span class=\"line\">      - MYSQL_DATABASE=yourls</span><br><span class=\"line\">      - MYSQL_USER=yourls</span><br><span class=\"line\">      - MYSQL_PASSWORD=yourls</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./mysql/db/:/var/lib/mysql</span><br><span class=\"line\">      - ./mysql/conf/:/etc/mysql/conf.d # Caution: It is important to note that the original author added a &quot;.d&quot; character (probably due to automatic tab input in debian), which caused troubleshooting effort for half an hour before successful resolution</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    container_name: yourls_mysql # This naming convention helps avoid problems with duplicate names when there are multiple Docker instances, and it provides clear documentation</span><br><span class=\"line\">  </span><br><span class=\"line\">  yourls:</span><br><span class=\"line\">    image: yourls</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;8200:80&quot;</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      YOURLS_DB_HOST: mysql</span><br><span class=\"line\">      YOURLS_DB_USER: admin</span><br><span class=\"line\">      YOURLS_DB_PASS: admin</span><br><span class=\"line\">      YOURLS_DB_NAME: yourls</span><br><span class=\"line\">      YOURLS_USER: admin      # Choose your own username</span><br><span class=\"line\">      YOURLS_PASS: 123admin@@      # Choose your own login password</span><br><span class=\"line\">      YOURLS_SITE: https://c.carlzeng.com:4443  # Replace with your own domain and ensure that Nginx Proxy Manager points to this address</span><br><span class=\"line\">      YOURLS_HOURS_OFFSET: 8</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./yourls_data/:/var/www/html   </span><br><span class=\"line\">    container_name: yourls_service</span><br><span class=\"line\">    links:</span><br><span class=\"line\">      - mysql:mysql</span><br></pre></td></tr></table></figure>\n\n<p>Reported Error:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yours_mysql     | 2023-11-07 13:33:44+00:00 [Note] [Entrypoint]: Switching to dedicated user &#x27;mysql&#x27;</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:44+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.44-1.el7 started.</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:44+00:00 [ERROR] [Entrypoint]: mysqld failed while attempting to check config</span><br><span class=\"line\">yours_mysql     |       command was: mysqld --verbose --help --log-bin-index=/tmp/tmp.5snRuPe4br</span><br><span class=\"line\">yours_mysql     |       mysqld: Can&#x27;t read dir of &#x27;/etc/mysql/conf.d/&#x27; (Errcode: 13 - Permission denied)</span><br><span class=\"line\">yours_mysql     | mysqld: [ERROR] Fatal error in defaults handling. Program aborted!</span><br><span class=\"line\">yours_mysql exited with code 1</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:57+00:00 [Note] [Entrypoint]: Switching to dedicated user &#x27;mysql&#x27;</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:57+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.44-1.el7 started.</span><br><span class=\"line\">yours_mysql     | 2023-11-07 13:33:57+00:00 [ERROR] [Entrypoint]: mysqld failed while attempting to check config</span><br><span class=\"line\">yours_mysql     |       command was: mysqld --verbose --help --log-bin-index=/tmp/tmp.atOD1yOw77</span><br><span class=\"line\">yours_mysql     |       mysqld: Can&#x27;t read dir of &#x27;/etc/mysql/conf.d/&#x27; (Errcode: 13 - Permission denied)</span><br><span class=\"line\">yours_mysql     | mysqld: [ERROR] Fatal error in defaults handling. Program aborted!</span><br></pre></td></tr></table></figure>\n\n<p>Resolved on 20231229[Resolved]: Updated the mapping directory for MySQL docker; reinstalled everything. Data Loss (including the shortened link data and access statistics data).</p>\n<p>The completed solution is to use the <a href=\"https://github.com/GautamGupta/YOURLS-Import-Export\">GautamGupta&#x2F;YOURLS-Import-Export</a> plugin for effortless export and import functionality.</p>\n<p>Detailed installation steps:</p>\n<ol>\n<li><a href=\"https://github.com/GautamGupta/YOURLS-Import-Export/zipball/master\">Download the zip</a>.</li>\n<li>Extract the zip.</li>\n<li>Place the YOURLS-Import-Export folder in the user&#x2F;plugins directory.</li>\n<li>Activate the plugin.</li>\n<li>Restart Docker<br><code>docker-compose -f &#39;yourls_service.yaml&#39; restart</code></li>\n</ol>\n<p>Experience: Very user-friendly; for example, the current all-link list can be exported (or backed up). In special situations, starting over from scratch (saving time).</p>\n<p>Derived Readings: <a href=\"https://github.com/YOURLS/awesome#plugins\">Plugins List</a>: This list of plugins is categorized alphabetically and can be searched for specific functionalities directly on the page.</p>\n<h2 id=\"Next-Steps\"><a href=\"#Next-Steps\" class=\"headerlink\" title=\"Next Steps\"></a>Next Steps</h2><p>Feature: Analyze specific user attribute information, such as IP addresses, GEO addresses, similar to the detailed list provided by statcounter.com</p>\n<h3 id=\"yourls-geoip-update\"><a href=\"#yourls-geoip-update\" class=\"headerlink\" title=\"yourls-geoip-update\"></a>yourls-geoip-update</h3><p>Unable to update the database.<br>Error downloading “GeoLite2-Country”. Invalid license key.</p>\n<p><img class=\"lozad\" data-src=\"https://www.evernote.com/shard/s122/sh/9cdd27f6-a8d0-42eb-8b74-72c3635ffb2b/CkXm5XGWidMRJSsB7i3iEiczTZiTUNFkt5n6EKNcq98jQLOqQjDPsshZfg/deep/0/image.png\"> Do your best; can someone correct this for me?</p>\n<p>On 20231216, attempts to update the mmdb database file in the directory .&#x2F;yourls_data20231120&#x2F;includes&#x2F;geo proved ineffective.</p>\n<ol>\n<li>Uploaded GeoLite2-City.mmdb</li>\n<li>Copied and replaced the original GeoLite2-Country.mmdb</li>\n<li>This resulted in two new 64.34MB files, up from the original 5.41MB files</li>\n<li>Todo: Observe the changes</li>\n</ol>\n<blockquote>\n<p>On 20231216, practical tests proved that there was no change. Next step:</p>\n<ol>\n<li>Download <a href=\"https://chat.carlzeng.com:4443/alecthw/mmdb_china_ip_list\">alecthw&#x2F;mmdb_china_ip_list</a> to obtain the Country.mmdb file</li>\n<li>Upload it to .&#x2F;yourls_data20231120&#x2F;includes&#x2F;geo and replace the original GeoLite2-Country.mmdb.</li>\n<li>Restart Docker, Todo: Observe the changes.</li>\n</ol>\n</blockquote>\n<h2 id=\"Advantages-and-Disadvantages\"><a href=\"#Advantages-and-Disadvantages\" class=\"headerlink\" title=\"Advantages and Disadvantages\"></a>Advantages and Disadvantages</h2><h3 id=\"Advantages-of-Yourls\"><a href=\"#Advantages-of-Yourls\" class=\"headerlink\" title=\"Advantages of Yourls\"></a>Advantages of Yourls</h3><p>Numerous plugins for flexible assembly. Plugin list: <a href=\"https://github.com/YOURLS/awesome#plugins\">YOURLS Awesome List</a>.</p>\n<h3 id=\"Disadvantages-of-Yourls\"><a href=\"#Disadvantages-of-Yourls\" class=\"headerlink\" title=\"Disadvantages of Yourls\"></a>Disadvantages of Yourls</h3><p>The statistical functionality is basic and weak, almost at a comical level.<br>The documentation is not clear and straightforward. In the case of a failed GeoIP update, how can IP data be manually uploaded to that directory? It is surprising that this information is not easily found through a search engine.</p>\n<hr>\n<h1 id=\"Docker-Installation-of-X-UI\"><a href=\"#Docker-Installation-of-X-UI\" class=\"headerlink\" title=\"Docker Installation of X-UI\"></a>Docker Installation of X-UI</h1><p>Setting up Xray panel that supports multiple users and protocols on a single port - the ultimate chimera</p>\n<p>FranzKafkaYu&#x2F;x-ui version was used, only needing to modify the above image to enwaiax&#x2F;x-ui:alpha-zh. As the telegram bot was temporarily not in use, the default was switched back to <a href=\"https://github.com/vaxilu/x-ui\">vaxilu&#x2F;x-ui</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3.9&quot;</span><br><span class=\"line\">services:</span><br><span class=\"line\">  xui:</span><br><span class=\"line\">    image: enwaiax/x-ui</span><br><span class=\"line\">    container_name: xui</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - $PWD/db/:/etc/x-ui/</span><br><span class=\"line\">      - $PWD/cert/:/root/cert/</span><br><span class=\"line\">    restart: unless-stopped</span><br><span class=\"line\">    network_mode: host</span><br></pre></td></tr></table></figure>\n\n<p>A new directory was created, and the above configuration was added to x-ui.yaml<br><code>docker-compose -f x-ui.yaml up</code></p>\n<p><a href=\"https://www.amadues.link/archives/dockerda-jian-jie-dian-vless-ws-tls-web\">https://www.amadues.link/archives/dockerda-jian-jie-dian-vless-ws-tls-web</a><br>Following the solution of docker-compose.yaml: <a href=\"https://hostloc.com/thread-1108468-1-1.html\">https://hostloc.com/thread-1108468-1-1.html</a><br>Following the configuration: <a href=\"https://iwanlab.com/npm-xui/\">https://iwanlab.com/npm-xui/</a><br>Related video: <a href=\"https://www.youtube.com/watch?v=V3nsDicSMBc\">https://www.youtube.com/watch?v=V3nsDicSMBc</a></p>\n<p>To be tested:<br><code>vless://39fde2d2-c88c-4bea-d491-fb6990d49741@vmess.carlzeng.com:17866?type=ws&amp;security=none&amp;path=%2Fgugu#gugugee</code></p>\n<p>On-premises configurations helped in viewing and editing the settings: <a href=\"http://192.168.6.116:54321/fk/xui/\">http://192.168.6.116:54321/fk/xui/</a><br>Not successful…awaiting more client connection tests, waiting for rescue.</p>\n<p>Potential Resources:</p>\n<div class=\"tabs\" id=\"source\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#source-1\">Source 1</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"source-1\"><p>To be continued…</p></div></div></div>","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"docker-compose","path":"api/tags/docker-compose.json"},{"name":"docker","path":"api/tags/docker.json"},{"name":"NPM","path":"api/tags/NPM.json"},{"name":"debian","path":"api/tags/debian.json"},{"name":"URL Shortening","path":"api/tags/URL Shortening.json"},{"name":"YOURLS","path":"api/tags/YOURLS.json"},{"name":"Link Shortening","path":"api/tags/Link Shortening.json"}]}