{"title":"Accelerating Docker Pull or Docker-compose Pulling Images - GitHub Source","slug":"加速Docker-Pull或者docker-compose拉取镜像-适用github源","date":"2023-12-26T15:15:34.000Z","updated":"2023-12-31T01:09:55.636Z","comments":true,"path":"api/articles/加速Docker-Pull或者docker-compose拉取镜像-适用github源.json","excerpt":" [Figure] Augmenting Speed for GitHub Docker Sources","covers":null,"content":"<img class=\"lozad\" data-src=\"\">\n\n<p>Augmenting Speed for GitHub Docker Sources</p>\n<span id=\"more\"></span>\n\n<p>Downloading zlib (from GitHub) is quite laborious, as the speed is exceptionally slow.</p>\n<p>I came across a remarkable article: <a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#Setting-up-a-proxy-for-docker\">Speeding up Docker Pull</a></p>\n<h1 id=\"Its-Purpose\"><a href=\"#Its-Purpose\" class=\"headerlink\" title=\"Its Purpose\"></a>Its Purpose</h1><p>To accelerate GitHub’s docker sources, for instance:</p>\n<p>ghcr.io&#x2F;zlib-searcher&#x2F;zlib-searcher:latest</p>\n<p>ghcr.io&#x2F;puzzithinker&#x2F;zlib-searcher:master</p>\n<h1 id=\"How-to-Use\"><a href=\"#How-to-Use\" class=\"headerlink\" title=\"How to Use\"></a>How to Use</h1><ol>\n<li>Configuring http-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTP_PROXY=http://192.168.1.1:7890&quot;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>Configuring https-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTPS_PROXY=http://192.168.1.1:7890&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">This setting is challenging. It took me about half an hour of struggle and constant monitoring of the UI of clash.meta to determine whether the docker pull process was actually utilizing the proxy. Once the settings were correct, the speed indeed skyrocketed <span class=\"keyword\">in</span> an instant...</span></span><br></pre></td></tr></table></figure>\n\n<ol>\n<li><p>Restarting the Service</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl daemon-reload</span><br><span class=\"line\">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Monitoring to Ensure the Proxy Settings are Operative</p>\n</li>\n</ol>\n<h1 id=\"Related-Content\"><a href=\"#Related-Content\" class=\"headerlink\" title=\"Related Content\"></a>Related Content</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.top:3/appsearch?q=docker\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n<h1 id=\"Source-of-Inspiration\"><a href=\"#Source-of-Inspiration\" class=\"headerlink\" title=\"Source of Inspiration\"></a>Source of Inspiration</h1><p><a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#Setting-up-a-proxy-for-docker\">https://zu1k.com/posts/coding/speedup-docker-pull/#Setting-up-a-proxy-for-docker</a></p>\n<h1 id=\"If-the-Docker-repository-for-the-image-source-is-deleted\"><a href=\"#If-the-Docker-repository-for-the-image-source-is-deleted\" class=\"headerlink\" title=\"If the Docker repository for the image source is deleted\"></a>If the Docker repository for the image source is deleted</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You will need to save the Docker image as a tar file:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o &lt;path for generated tar file&gt; &lt;image name&gt;</span><br><span class=\"line\">Then copy your image to a new system with regular file transfer tools such as cp, scp, or rsync (preferred for big files). After that you will have to load the image into Docker:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker load -i &lt;path to image tar file&gt;</span><br><span class=\"line\">You should add filename (not just directory) with -o, for example:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o c:/myfile.tar centos:16</span><br><span class=\"line\">PS: You may need to sudo all commands.</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository\">https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository</a></p>\n","more":"<p>Downloading zlib (from GitHub) is quite laborious, as the speed is exceptionally slow.</p>\n<p>I came across a remarkable article: <a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#Setting-up-a-proxy-for-docker\">Speeding up Docker Pull</a></p>\n<h1 id=\"Its-Purpose\"><a href=\"#Its-Purpose\" class=\"headerlink\" title=\"Its Purpose\"></a>Its Purpose</h1><p>To accelerate GitHub’s docker sources, for instance:</p>\n<p>ghcr.io&#x2F;zlib-searcher&#x2F;zlib-searcher:latest</p>\n<p>ghcr.io&#x2F;puzzithinker&#x2F;zlib-searcher:master</p>\n<h1 id=\"How-to-Use\"><a href=\"#How-to-Use\" class=\"headerlink\" title=\"How to Use\"></a>How to Use</h1><ol>\n<li>Configuring http-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class=\"line\">vim /etc/systemd/system/docker.service.d/http-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTP_PROXY=http://192.168.1.1:7890&quot;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>Configuring https-proxy.conf</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=&quot;HTTPS_PROXY=http://192.168.1.1:7890&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">This setting is challenging. It took me about half an hour of struggle and constant monitoring of the UI of clash.meta to determine whether the docker pull process was actually utilizing the proxy. Once the settings were correct, the speed indeed skyrocketed <span class=\"keyword\">in</span> an instant...</span></span><br></pre></td></tr></table></figure>\n\n<ol>\n<li><p>Restarting the Service</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl daemon-reload</span><br><span class=\"line\">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Monitoring to Ensure the Proxy Settings are Operative</p>\n</li>\n</ol>\n<h1 id=\"Related-Content\"><a href=\"#Related-Content\" class=\"headerlink\" title=\"Related Content\"></a>Related Content</h1><iframe style=\"box-shadow: 0px 0px 20px -10px;\" src=\"https://query.carlzeng.top:3/appsearch?q=docker\" frameborder=\"0\" scrolling=\"auto\" width=\"100%\" height=\"500\"></iframe>\n\n<h1 id=\"Source-of-Inspiration\"><a href=\"#Source-of-Inspiration\" class=\"headerlink\" title=\"Source of Inspiration\"></a>Source of Inspiration</h1><p><a href=\"https://zu1k.com/posts/coding/speedup-docker-pull/#Setting-up-a-proxy-for-docker\">https://zu1k.com/posts/coding/speedup-docker-pull/#Setting-up-a-proxy-for-docker</a></p>\n<h1 id=\"If-the-Docker-repository-for-the-image-source-is-deleted\"><a href=\"#If-the-Docker-repository-for-the-image-source-is-deleted\" class=\"headerlink\" title=\"If the Docker repository for the image source is deleted\"></a>If the Docker repository for the image source is deleted</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You will need to save the Docker image as a tar file:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o &lt;path for generated tar file&gt; &lt;image name&gt;</span><br><span class=\"line\">Then copy your image to a new system with regular file transfer tools such as cp, scp, or rsync (preferred for big files). After that you will have to load the image into Docker:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker load -i &lt;path to image tar file&gt;</span><br><span class=\"line\">You should add filename (not just directory) with -o, for example:</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; docker save -o c:/myfile.tar centos:16</span><br><span class=\"line\">PS: You may need to sudo all commands.</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository\">https://stackoverflow.com/questions/23935141/how-to-copy-docker-images-from-one-host-to-another-without-using-a-repository</a></p>","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","path":"api/tags/Docker.json"},{"name":"docker-compose","path":"api/tags/docker-compose.json"}]}