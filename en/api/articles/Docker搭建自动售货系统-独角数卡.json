{"title":"Dockeræ­å»ºè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡","slug":"Dockeræ­å»ºè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡","date":"2023-11-20T08:54:57.000Z","updated":"2024-10-25T14:42:55.562Z","comments":true,"path":"api/articles/Dockeræ­å»ºè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡.json","excerpt":" [Figure] è‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡ dujiaoka","covers":["https://www.evernote.com/shard/s122/sh/28cd0f84-7b75-402b-a78b-0fdbc30e7615/0Vihl8lVbSwR84f1sWlHCWkZdwVZjcmThrHc-x0gAzbTvCrzNM1ztoXh0g/deep/0/image.png"],"content":"<img class=\"lozad\" data-src=\"https://www.evernote.com/shard/s122/sh/28cd0f84-7b75-402b-a78b-0fdbc30e7615/0Vihl8lVbSwR84f1sWlHCWkZdwVZjcmThrHc-x0gAzbTvCrzNM1ztoXh0g/deep/0/image.png\">\nè‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡ dujiaoka\n<span id=\"more\"></span>\n\n<h1 id=\"æœ‰ä»€ä¹ˆç”¨\"><a href=\"#æœ‰ä»€ä¹ˆç”¨\" class=\"headerlink\" title=\"æœ‰ä»€ä¹ˆç”¨\"></a>æœ‰ä»€ä¹ˆç”¨</h1><p>è‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡<br>å°è¯•æŒ‰æ•™æå’Œè§†é¢‘æ­å»ºå¤±è´¥äº†ï¼ˆè¯¦è§ç« èŠ‚ï¼šæ­å»ºå¤±è´¥çš„å†å²è®°å½•ï¼‰ï¼Œ<br>é¼“èµ·å‹‡æ°”ï¼Œé‡æ–°é€‰ç”¨æ–°çš„æ–¹æ¡ˆï¼š<a href=\"https://blog.dov.moe/posts/49102/\">https://blog.dov.moe/posts/49102/</a></p>\n<p>ä¸¾ä¸ªğŸŒ°ä¾‹å­ï¼š<a href=\"https://dovshop.net/\">https://dovshop.net/</a></p>\n<p><a href=\"https://ayangshop.com/buy/38\">https://ayangshop.com/buy/38</a></p>\n<div class=\"note danger\"><p>ç”±äºæœ¬äººæ— æ³•è§£å†³ï¼Œåä»£ä»¥åçš„é¡µé¢ä¸­é“¾æ¥æ²¡æœ‰è‡ªåŠ¨æºå¸¦ç«¯å£å¥½é—®é¢˜ã€‚æ”¾å¼ƒä½¿ç”¨ã€‚</p>\n</div>\n\n<h1 id=\"å®ç°æ–¹æ³•\"><a href=\"#å®ç°æ–¹æ³•\" class=\"headerlink\" title=\"å®ç°æ–¹æ³•\"></a>å®ç°æ–¹æ³•</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /www/server/panel/data/compose/dujiaoka/template</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir Shop &amp;&amp; cd Shop</span><br><span class=\"line\">mkdir storage uploads</span><br><span class=\"line\">chmod 777 storage uploads</span><br><span class=\"line\">â—æ³¨æ„æ­¤å¤„æ–‡ä»¶å¤¹æƒé™ä¸€å®šè¦ç»™ï¼</span><br><span class=\"line\"></span><br><span class=\"line\">chmod -R 777 env.conf</span><br><span class=\"line\"># é‡è¦æ­¥éª¤</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  faka:</span><br><span class=\"line\">    image: ghcr.io/apocalypsor/dujiaoka:latest</span><br><span class=\"line\">    <span class=\"comment\"># å›½å†…æœåŠ¡å™¨å¯ä»¥ç”¨ hkccr.ccs.tencentyun.com/apocalypsor/dujiaoka:latest</span></span><br><span class=\"line\">    container_name: faka</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">        <span class=\"comment\"># - INSTALL=false</span></span><br><span class=\"line\">        - <span class=\"attr\">INSTALL</span>=<span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"comment\"># - MODIFY=true</span></span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./env.conf:/dujiaoka/.env</span><br><span class=\"line\">      - ./uploads:/dujiaoka/public/uploads</span><br><span class=\"line\">      - ./storage:/dujiaoka/storage</span><br><span class=\"line\">      - ./start-hook.sh:/dujiaoka/start-hook.sh</span><br><span class=\"line\">      <span class=\"comment\"># ç½‘ç«™å›¾æ ‡ 32X32 favicon.ico 4kbï¼Œé»˜è®¤æ¨¡ç‰ˆåªéœ€ç¬¬ä¸€å¤„ï¼Œå…¶ä»–æ¨¡ç‰ˆéœ€è¦ç¬¬äºŒå¤„</span></span><br><span class=\"line\">\t  <span class=\"comment\">#- ./favicon.ico:/dujiaoka/public/favicon.ico:ro</span></span><br><span class=\"line\">\t  <span class=\"comment\">#- ./favicon.ico:/dujiaoka/public/assets/style/favicon.ico:ro</span></span><br><span class=\"line\">\t  <span class=\"comment\"># é»˜è®¤å•†å“å›¾ç‰‡ 512x512 default.jpg 18kbï¼ˆç½‘ç«™ LOGO å…±äº«æ­¤å›¾ï¼Œä¸åå°è‡ªå®šä¹‰ LOGO å’Œå•†å“å›¾ç‰‡ä¸å†²çªï¼‰</span></span><br><span class=\"line\">\t  <span class=\"comment\"># - ./default.png:/dujiaoka/public/assets/common/images/default.jpg:ro</span></span><br><span class=\"line\">\t  <span class=\"comment\"># Luna ä¸»é¢˜ç½‘ç«™èƒŒæ™¯ 1920x1224 background.png 198kb</span></span><br><span class=\"line\">\t  <span class=\"comment\">#- ./background.png:/dujiaoka/public/assets/luna/img/background.png:ro</span></span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 4444:80</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\"> </span><br><span class=\"line\">  db:</span><br><span class=\"line\">    image: mariadb:focal</span><br><span class=\"line\">    container_name: faka-data</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_ROOT_PASSWORD</span>=mariadb</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_DATABASE</span>=dujiaoka</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_USER</span>=dujiaoka</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_PASSWORD</span>=dujiaokapassword</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./data:/var/lib/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:alpine</span><br><span class=\"line\">    container_name: faka-redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–è¾‘ .env æ–‡ä»¶</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">APP_NAME</span>=Carlçš„å°åº—</span><br><span class=\"line\"><span class=\"attr\">APP_ENV</span>=local</span><br><span class=\"line\"><span class=\"attr\">APP_KEY</span>=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\"><span class=\"attr\">APP_DEBUG</span>=<span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">APP_URL</span>=http://<span class=\"number\">192.168</span>.<span class=\"number\">6.116</span>:<span class=\"number\">4444</span></span><br><span class=\"line\"><span class=\"comment\">#ADMIN_HTTPS=true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">LOG_CHANNEL</span>=stack</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ•°æ®åº“é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">DB_CONNECTION</span>=mysql</span><br><span class=\"line\"><span class=\"attr\">DB_HOST</span>=db</span><br><span class=\"line\"><span class=\"attr\">DB_PORT</span>=<span class=\"number\">3306</span></span><br><span class=\"line\"><span class=\"attr\">DB_DATABASE</span>=dujiaoka</span><br><span class=\"line\"><span class=\"attr\">DB_USERNAME</span>=dujiaoka</span><br><span class=\"line\"><span class=\"attr\">DB_PASSWORD</span>=dujiaokapassword</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># redis é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">REDIS_HOST</span>=redis</span><br><span class=\"line\"><span class=\"attr\">REDIS_PASSWORD</span>=</span><br><span class=\"line\"><span class=\"attr\">REDIS_PORT</span>=<span class=\"number\">6379</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">BROADCAST_DRIVER</span>=log</span><br><span class=\"line\"><span class=\"attr\">SESSION_DRIVER</span>=file</span><br><span class=\"line\"><span class=\"attr\">SESSION_LIFETIME</span>=<span class=\"number\">120</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¼“å­˜é…ç½®</span></span><br><span class=\"line\"><span class=\"comment\"># file ä¸ºç£ç›˜æ–‡ä»¶  redis ä¸ºå†…å­˜çº§åˆ«</span></span><br><span class=\"line\"><span class=\"comment\"># redis ä¸ºå†…å­˜éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">CACHE_DRIVER</span>=redis</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</span></span><br><span class=\"line\"><span class=\"comment\"># sync ä¸ºåŒæ­¥  redis ä¸ºå¼‚æ­¥</span></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨ redis å¼‚æ­¥éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">QUEUE_CONNECTION</span>=redis</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åå°è¯­è¨€</span></span><br><span class=\"line\"><span class=\"comment\">## zh_CN ç®€ä½“ä¸­æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">## zh_TW ç¹ä½“ä¸­æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">## en    è‹±æ–‡</span></span><br><span class=\"line\"><span class=\"attr\">DUJIAO_ADMIN_LANGUAGE</span>=zh_CN</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åå°ç™»å½•åœ°å€</span></span><br><span class=\"line\"><span class=\"attr\">ADMIN_ROUTE_PREFIX</span>=/admin</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ç›´æ— æ³•ä¸‹è½½æˆåŠŸâ€¦â€¦<br>ä¿®æ”¹ä½¿ç”¨ï¼šstilleshan&#x2F;dujiaoka</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose+å¦‚ä½•ä½¿ç”¨ä»£ç†æé€Ÿ</span><br><span class=\"line\">\t\thttps://neucrack.com/p/286</span><br><span class=\"line\">\tworkaourndï¼šæ‰‹åŠ¨è®©OpenClashä¸åœåœ¨çº¿ï¼ˆä¸åœ¨çº¿å°±é‡æ–°åˆ·æ–°å–è·å–æœ€æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ç»ˆäºä¸‹è½½æˆåŠŸåï¼Œå¯åŠ¨å¤±è´¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting &quot;/www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico&quot; to rootfs at &quot;/dujiaoka/public/favicon.ico&quot;: mount /www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico:/dujiaoka/public/favicon.ico (via /proc/self/fd/6), flags: 0x5001: not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type</span><br></pre></td></tr></table></figure>\n<p>æ³¨é‡Šæ‰é‚£å‡ ä¸ªè‡ªå®šä¹‰çš„æ–‡ä»¶æ˜ å°„ï¼Œå°±å¥½äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">faka        | The environment file is invalid!</span><br><span class=\"line\">faka        | Failed to parse dotenv file due to unexpected whitespace. Failed at [Carl Shop].</span><br></pre></td></tr></table></figure>\n<p>è¿”å›ä¿®æ”¹æŠŠå‰ååŠ ä¸Šå¼•å·ã€‚</p>\n<p>ä¿®æ”¹äº†ç«¯å£æ˜ å°„å‡º4444åï¼Œé”™è¯¯ï¼š<br>500<br>Server Error</p>\n<p>â—æ³¨æ„ç¯å¢ƒå˜é‡å¦‚æœå†™çš„ä¸å¯¹å¯èƒ½å¯¼è‡´ 500ï¼Œå¯ä»¥å¼€ APP_DEBUG&#x3D;true çœ‹çœ‹å…·ä½“æ˜¯å“ªé‡Œå†™é”™äº†ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   throw new RuntimeException(&#x27;The only supported ciphers are AES-128-CBC and AES-256-CBC with the correct key lengths.&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">è§£å†³åŠæ³•ï¼šä¿®æ”¹APP_KEY=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\">--------------</span><br><span class=\"line\"></span><br><span class=\"line\">file_put_contents(/dujiaoka/.env): failed to open stream: Permission denied</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æœ¬åœ°è®¿é—®æˆåŠŸï¼š<a href=\"http://192.168.6.116:4444/\">http://192.168.6.116:4444</a></p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://hub.docker.com/r/stilleshan/dujiaoka\">https://hub.docker.com/r/stilleshan/dujiaoka</a><br><a href=\"https://hub.docker.com/r/jiangjuhong/dujiaoka\">https://hub.docker.com/r/jiangjuhong/dujiaoka</a></p>\n<h2 id=\"æ­é…frpc\"><a href=\"#æ­é…frpc\" class=\"headerlink\" title=\"æ­é…frpc\"></a>æ­é…frpc</h2><p>20231203 NPMåä»£å¤±è´¥ï¼Œå‡ å‘¨åï¼›ç»ˆäºæ‰¾åˆ°è§£å†³æ–¹æ¡ˆäº†ï¼šå‘ç°å¯ä»¥ç”¨frpcåä»£å‡ºå»å°±å¥½</p>\n<p>é…ç½®å®Œæˆfrpc -c frpc.iniï¼Œ å¯æ˜¯ä¾æ—§æ˜¯ç‚¹å‡»çš„é“¾æ¥æ²¡æœ‰æºå¸¦ç«¯å£å·ï¼›éå¸¸éƒé—·</p>\n<hr>\n<hr>\n<h1 id=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"><a href=\"#æ­å»ºå¤±è´¥çš„å†å²è®°å½•\" class=\"headerlink\" title=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"></a>æ­å»ºå¤±è´¥çš„å†å²è®°å½•</h1><p>ç‹¬è§’æ•°å¡<br>å¼€æºå¼ç«™é•¿è‡ªåŠ¨åŒ–å”®è´§è§£å†³æ–¹æ¡ˆã€é«˜æ•ˆã€ç¨³å®šã€å¿«é€Ÿï¼</p>\n<p>å¾’æ‰‹æ­å»ºç‹¬è§’æ•°å‘å¡ç½‘ç«™ ç»è¥è‡ªå·±çš„å°åº—ï¼ - å…­æœˆ 26, 2023<br><a href=\"https://kejilion.blogspot.com/2023/06/blog-post_26.html\">https://kejilion.blogspot.com/2023/06/blog-post_26.html</a></p>\n<p>é…ç½®docker-compose<br><a href=\"https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml\">https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml</a></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;3.8&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nginx:</span><br><span class=\"line\">    image: nginx:1.22</span><br><span class=\"line\">    container_name: nginx</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 882:80</span><br><span class=\"line\">      - 4444:443      </span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./nginx.conf:/etc/nginx/nginx.conf</span><br><span class=\"line\">      - ./certs:/etc/nginx/certs      </span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  php:</span><br><span class=\"line\">    image: php:7.4.33-fpm</span><br><span class=\"line\">    container_name: php</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  mysql:</span><br><span class=\"line\">    image: mysql:5.7.42</span><br><span class=\"line\">    container_name: mysql</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./mysql:/var/lib/mysql</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_ROOT_PASSWORD</span>=webroot</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_DATABASE</span>=web</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_USER</span>=carlZeng</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_PASSWORD</span>=carlZengYYDS</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:latest</span><br><span class=\"line\">    container_name: redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n<p>ä¿®æ”¹äº†ç‹¬è§’æ•°å¡çš„ç«¯å£</p>\n<p>ç”³è¯·è¯ä¹¦, ä¸‹è½½è¯ä¹¦;</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ç›´æ¥å»NPMä¸­ä¸‹è½½è¯ä¹¦è§£å‹ç¼©åé‡å‘½åæ”¾åˆ°debiançš„ç›®å½•ï¼š</span><br><span class=\"line\">/home/web/certs</span><br><span class=\"line\">    key.pem</span><br><span class=\"line\">    cert.pem</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p>ç»§ç»­é…ç½®nginx.conf</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections 1024<span class=\"comment\">;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    include       /etc/nginx/mime.types<span class=\"comment\">;</span></span><br><span class=\"line\">    default_type  application/octet-stream<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on<span class=\"comment\">;</span></span><br><span class=\"line\">    keepalive_timeout  65<span class=\"comment\">;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    client_max_body_size 1000m<span class=\"comment\">;  </span></span><br><span class=\"line\">    <span class=\"comment\">#ä¸Šä¼ é™åˆ¶å‚æ•°1Gä»¥å†…æ–‡ä»¶å¯ä¸Šä¼ </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># HTTP server</span></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80<span class=\"comment\">;</span></span><br><span class=\"line\">        server_name shop.carlzeng.com<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Redirect all HTTP requests to HTTPS</span></span><br><span class=\"line\">        return 301 https://$host$request_uri<span class=\"comment\">;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># HTTPS server</span></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443 ssl http2<span class=\"comment\">;</span></span><br><span class=\"line\">        server_name shop.carlzeng.com<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># http2 on;</span></span><br><span class=\"line\">            </span><br><span class=\"line\">        ssl_certificate /etc/nginx/certs/cert.pem<span class=\"comment\">;</span></span><br><span class=\"line\">        ssl_certificate_key /etc/nginx/certs/key.pem<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        root /var/www/html/dujiaoka/public/<span class=\"comment\">;</span></span><br><span class=\"line\">        index index.php<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        try_files $uri $uri/ /index.php?$query_string<span class=\"comment\">;    </span></span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># PHP-FPM configuration</span></span><br><span class=\"line\">        location ~ \\.php$ &#123;</span><br><span class=\"line\">            fastcgi_pass php:9000<span class=\"comment\">;</span></span><br><span class=\"line\">            fastcgi_index index.php<span class=\"comment\">;</span></span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name<span class=\"comment\">;</span></span><br><span class=\"line\">            include fastcgi_params<span class=\"comment\">;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>cd &#x2F;home&#x2F;web&#x2F;html &amp;&amp; wget <a href=\"https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz\">https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz</a> &amp;&amp; apt install -y tar &amp;&amp; tar -zxvf 2.0.6-antibody.tar.gz &amp;&amp; rm 2.0.6-antibody.tar.gz</p>\n<p>å®‰è£…PHPæ‰©å±•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec php apt update &amp;&amp; docker exec php apt install -y libmariadb-dev-compat libmariadb-dev libzip-dev libmagickwand-dev imagemagick</span><br><span class=\"line\"></span><br><span class=\"line\">å¡æ­»åœ¨è¿™ä¸€æ­¥ï¼Œåˆ†è§£å¦‚ä¸‹ï¼š</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev-compat</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev</span><br><span class=\"line\">    docker exec php apt install -y libzip-dev</span><br><span class=\"line\">    docker exec php apt install -y libmagickwand-dev</span><br><span class=\"line\">        libmagickwand-dev is already the newest version (8:6.9.11.60+dfsg-1.3+deb11u1).</span><br><span class=\"line\">    docker exec php apt install -y imagemagick</span><br><span class=\"line\">        Build process completed successfully</span><br><span class=\"line\">        Installing &#x27;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#x27;</span><br><span class=\"line\">        install ok: channel://pecl.php.net/redis-6.0.2</span><br><span class=\"line\">        configuration option &quot;php_ini&quot; is not set to php.ini location</span><br><span class=\"line\">        You should add &quot;extension=redis.so&quot; to php.ini</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">docker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœç™»å½•æ—¶æŠ¥é”™å†ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œè§£é™¤HTTPSé™åˆ¶</p>\n<p>sed -i â€˜s&#x2F;ADMIN_HTTPS&#x3D;false&#x2F;ADMIN_HTTPS&#x3D;true&#x2F;gâ€™ &#x2F;home&#x2F;web&#x2F;html&#x2F;dujiaoka&#x2F;.env</p>\n<p>é”™è¯¯ä»¥åŠè§£å†³åŠæ³•<br>ä¸åŒæ—¶æœŸå†ç½‘é¡µé¡µé¢ï¼Œç‚¹å‡»å®‰è£…åå‡ºç°çš„é”™è¯¯</p>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><pre><code>è§£å†³ï¼šä¿®æ”¹äº†nginx.confï¼Œç¡®ä¿80å’Œ443ç«¯å£ï¼ˆdockerä¸­çš„ç«¯å£å ç”¨ï¼Œé»˜è®¤å³å¯ï¼‰\nç¡®è®¤äº†php dockerä¸­çš„PHPæ‰©å±•ï¼Œç¡®ä¿æ‰€æœ‰æ’ä»¶éƒ½å®‰è£…æˆåŠŸ\n</code></pre>\n<h3 id=\"Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\"><a href=\"#Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\" class=\"headerlink\" title=\"Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known\"></a>Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known</h3><pre><code>è§£å†³ï¼šsed -i &#39;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#39; /home/web/html/dujiaoka/.env\næ ¸æŸ¥äº†php dockerä¸­ å®‰è£…PHPæ‹“å±•éƒ¨åˆ†äºredisç›¸å…³çš„ï¼›\ndocker-php-ext-redis.iniï¼ˆå·²åŒ…å«å†…å®¹ï¼šextension=redis.soï¼‰\n\nåŸæ¥æ˜¯redis å†™æˆäº†radisï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h3 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)</h3><pre><code>è§£å†³ï¼šMySQLç”¨æˆ·åå¡«å†™é”™è¯¯ï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">è§£å†³ï¼š</span><br><span class=\"line\">æ£€æµ‹ï¼šdocker exec -it php php -i |grep mysqlnd  æ’æŸ¥æ˜¯å¦å¯ç”¨äº†mysqlé©±åŠ¨</span><br><span class=\"line\">    mysqlnd</span><br><span class=\"line\">    mysqlnd =&gt; enabled</span><br><span class=\"line\">    Version =&gt; mysqlnd 7.4.3</span><br><span class=\"line\"></span><br><span class=\"line\">docker exec -it php /bin/bash</span><br><span class=\"line\">docker-php-ext-install pdo pdo_mysql</span><br><span class=\"line\">docker-compose restart php</span><br><span class=\"line\"></span><br><span class=\"line\">è¿™ä¸ªå¥½åƒæ²¡æœ‰è¢«æ°¸ä¹…ä¿å­˜ä½ï¼Œè¿™å¯¼è‡´æ¯æ¬¡docker-compose restart phpéƒ½ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯,</span><br><span class=\"line\">æŒ‰ç…§ä¸Šé¢è§£å†³å¥½ä»¥åï¼Œç´§æ¥ç€å°±æ˜¯ä¸‹é¢è¿™ä¸ªRedisé”™è¯¯</span><br><span class=\"line\"></span><br><span class=\"line\">è¿™æ¬¡æ˜¯ä¿®æ­£åï¼Œæœ€åæ˜¯é€šè¿‡docker restart php è§£å†³äº†é”™è¯¯</span><br><span class=\"line\">æµ‹è¯• docker-compose restart ä¼šä¸ä¼šæŠŠæ•°æ®åœ¨ç»§ç»­ç ´åäº†ï¼Œé‡æ–°æ‹‰å–ï¼Ÿ</span><br><span class=\"line\">    ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼ é‚£ä¸‹ä¸€æ¬¡æ€ä¹ˆåŠï¼Ÿç»§ç»­å¦‚æ­¤ä¿®å¤å³å¯</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\"><a href=\"#Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\" class=\"headerlink\" title=\"Please make sure the PHP Redis extension is installed and enabled.\"></a>Please make sure the PHP Redis extension is installed and enabled.</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it php /bin/bash</span><br><span class=\"line\">pecl install redis</span><br><span class=\"line\">    checking for igbinary includes... configure: error: Cannot find igbinary.h</span><br><span class=\"line\">        ERROR: `/tmp/pear/temp/redis/configure --with-php-config=/usr/local/bin/php-config --enable-redis-igbinary=yes --enable-redis-lzf=yes --enable-redis-zstd=yes --enable-redis-msgpack=yes --enable-redis-lz4=yes --with-liblz4&#x27; failed</span><br><span class=\"line\">Build process completed successfully</span><br><span class=\"line\">Installing &#x27;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#x27;</span><br><span class=\"line\">install ok: channel://pecl.php.net/redis-6.0.2</span><br><span class=\"line\">configuration option &quot;php_ini&quot; is not set to php.ini location</span><br><span class=\"line\">You should add &quot;extension=redis.so&quot; to php.ini</span><br><span class=\"line\"></span><br><span class=\"line\">è§£å†³ï¼šdocker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br><span class=\"line\">è§£å†³åˆ†è§£ï¼Œå¹¶é€ä¸€ç¡®è®¤æ‰§è¡ŒæˆåŠŸ</span><br><span class=\"line\">    docker exec -it php /bin/bash</span><br><span class=\"line\">        docker-php-ext-install pdo_mysql zip bcmath gd intl opcache</span><br><span class=\"line\">        pecl install redis</span><br><span class=\"line\">        sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br><span class=\"line\">åœ¨ bash ä¸‹ï¼Œä¸€ä¸€æ‰§è¡Œï¼Œæ£€æŸ¥ç»“æœ</span><br><span class=\"line\"></span><br><span class=\"line\">æœ€åï¼Œéœ€è¦docker-compose restart</span><br><span class=\"line\">ä¹‹å‰éƒ½æ˜¯é‡å¯phpå®¹å™¨docker restart php æ— æ³•è§£å†³é—®é¢˜ã€‚éœ€è¦çš„æ˜¯ï¼šdocker-compose restart</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"0-error\"><a href=\"#0-error\" class=\"headerlink\" title=\"0 error\"></a>0 error</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å®‰è£…æˆåŠŸå redirect https://192.168.6.116:4444/admin/auth/login</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">åå°ç™»å½•å‡ºç°0erræˆ–è€…å…¶ä»–ç™»å½•å¼‚å¸¸é—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯å¼€å¯äº†httpsè€Œåå°æ²¡æœ‰å¼€å¯ï¼ŒæŠŠä¸‹é¢çš„<span class=\"literal\">false</span>æ”¹ä¸º<span class=\"literal\">true</span>å³å¯</span></span><br><span class=\"line\">ADMIN_HTTPS=false</span><br><span class=\"line\">è§£å†³ï¼šsed -i &#x27;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#x27; /home/web/html/dujiaoka/.env</span><br><span class=\"line\"></span><br><span class=\"line\">æˆåŠŸäº†ï¼Œæœ¬åœ°å±€åŸŸç½‘å¯è®¿é—®ã€‚</span><br><span class=\"line\">ä¸‹ä¸€æ­¥æ˜¯ä¸ºä½•æ— æ³•NPMåä»£https://192.168.6.116:4444</span><br></pre></td></tr></table></figure>\n\n\n<h4 id=\"outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\"><a href=\"#outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\" class=\"headerlink\" title=\"[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError\"></a>[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError</h4><pre><code>Call to undefined function App\\Service\\bcmul()\nhttps://192.168.6.116:4444/create-order\n</code></pre>\n<h4 id=\"outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-com-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"><a href=\"#outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-com-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\" class=\"headerlink\" title=\"[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ https://buy.carlzeng.com:4443/ å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"></a>[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ <a href=\"https://buy.carlzeng.com:4443/\">https://buy.carlzeng.com:4443/</a> å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦</h4><h4 id=\"é‡å‘½åinstall-lock-é‡è£…\"><a href=\"#é‡å‘½åinstall-lock-é‡è£…\" class=\"headerlink\" title=\"é‡å‘½åinstall.lock é‡è£…\"></a>é‡å‘½åinstall.lock é‡è£…</h4><pre><code>é‡è£…åæ•°æ®é‡æ–°é…ç½®ï¼Œå¯¼è‡´è®¾ç½®çš„å•†å“ç­‰ç­‰å…¨éƒ¨æ¸…é›¶ï¼›ä¸Šé¢é—®é¢˜å¾…æµ‹è¯•\nURLè‡ªåŠ¨æºå¸¦ç«¯å£ï¼Œæ²¡æœ‰è§£å†³ã€‚\n</code></pre>\n<p>â€‹    </p>\n<h1 id=\"Debian-Manual\"><a href=\"#Debian-Manual\" class=\"headerlink\" title=\"Debian Manual\"></a>Debian Manual</h1><h2 id=\"å†™åœ¨å‰é¢\"><a href=\"#å†™åœ¨å‰é¢\" class=\"headerlink\" title=\"å†™åœ¨å‰é¢\"></a>å†™åœ¨å‰é¢</h2><ul>\n<li>æ­¤æ•™ç¨‹ä¸“ä¸ºæœ‰æ´ç™–çš„å®å®ä»¬å‡†å¤‡ã€‚ä¸ä½¿ç”¨ä»»ä½•ä¸€é”®å®‰è£…è„šæœ¬ã€‚é¢æ¿å…šå¯ä»¥é€€æ•£äº†ï¼ï¼</li>\n<li>æœ¬äººæµ‹è¯•ç¯å¢ƒæ˜¯ Debian 11 å…¶ä»–çš„æ²¡æµ‹è¯•ã€‚</li>\n</ul>\n<h2 id=\"æ‰‹åŠ¨å®‰è£…lnmp\"><a href=\"#æ‰‹åŠ¨å®‰è£…lnmp\" class=\"headerlink\" title=\"æ‰‹åŠ¨å®‰è£…lnmp\"></a>æ‰‹åŠ¨å®‰è£…lnmp</h2><ul>\n<li>æ›´æ–°æº</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt update  </span><br><span class=\"line\">apt upgrade</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®‰è£…Nginx<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install nginx</span><br></pre></td></tr></table></figure></li>\n<li>å®‰è£…Mariadb<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install mariadb-server</span><br></pre></td></tr></table></figure></li>\n<li>é…ç½®Mariadb<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql_secure_installation</span><br></pre></td></tr></table></figure>\næ ¹æ®æç¤ºæ“ä½œå³å¯ã€‚</li>\n<li>åˆ›å»ºæ•°æ®åº“<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mariadb</span><br></pre></td></tr></table></figure>\nä¹‹åä¼šæ˜¾ç¤º<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection <span class=\"built_in\">id</span> is 74</span><br><span class=\"line\">Server version: 10.3.15-MariaDB-1 Debian 10</span><br><span class=\"line\">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> <span class=\"built_in\">help</span>. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure>\næ¥ä¸‹æ¥è¾“å…¥å‘½ä»¤ <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> DATABASE [è¿™é‡Œæ›¿æ¢ä¸ºæ•°æ®åº“å] ;</span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">ON</span> [è¿™é‡Œæ›¿æ¢ä¸ºæ•°æ®åº“å].<span class=\"operator\">*</span> <span class=\"keyword\">TO</span> <span class=\"string\">&#x27;[è¿™é‡Œæ›¿æ¢ä¸ºç”¨æˆ·å]&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> IDENTIFIED <span class=\"keyword\">BY</span> <span class=\"string\">&#x27;[è¿™é‡Œæ›¿æ¢ä¸ºå¯†ç ]&#x27;</span> <span class=\"keyword\">WITH</span> <span class=\"keyword\">GRANT</span> OPTION;</span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\">EXIT</span><br></pre></td></tr></table></figure></li>\n<li>å®‰è£…PHP7.4<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install php php-fpm php-mysql php-gd php-zip php-opcache php-curl php-mbstring php-intl php-dom php-bcmath php-redis php-fileinfo</span><br></pre></td></tr></table></figure></li>\n<li>å®‰è£…redis<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install redis</span><br></pre></td></tr></table></figure></li>\n<li>å¯ç”¨å‡½æ•°<br><code>nano /etc/php/7.4/fpm/php.ini</code>,<code>ctrl+w</code> æœç´¢ <code>putenv</code>ï¼Œ<code>proc_open</code>ï¼Œ<code>pcntl_signal</code>ï¼Œ<code>pcntl_alarm</code> åœ¨<code>disable_functions</code> ä¸€è¡Œ æœ‰å°±å»æ‰ã€‚<br>ä¹‹å <code>/etc/init.d/php7.4-fpm reload</code></li>\n</ul>\n<h2 id=\"ä¸‹è½½æºä»£ç \"><a href=\"#ä¸‹è½½æºä»£ç \" class=\"headerlink\" title=\"ä¸‹è½½æºä»£ç \"></a>ä¸‹è½½æºä»£ç </h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /var/www/dujiaoka</span><br><span class=\"line\">apt install git</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/assimon/dujiaoka.git </span><br><span class=\"line\"><span class=\"built_in\">chmod</span> 777 -R /var/www/dujiaoka</span><br></pre></td></tr></table></figure>\n<h2 id=\"é…ç½®-nginx\"><a href=\"#é…ç½®-nginx\" class=\"headerlink\" title=\"é…ç½® nginx\"></a>é…ç½® nginx</h2><ul>\n<li>å‡è®¾ä½ çš„åŸŸåæ˜¯ï¼š<code>domain.com</code></li>\n<li>å‡è®¾ä½ çš„ç½‘ç«™ç›®å½•æ˜¯ï¼š<code>/home/wwwroot/dujiaoka</code></li>\n<li>é…ç½®æ–‡ä»¶çš„å­˜æ”¾ç›®å½•æ˜¯ï¼š<code>/usr/local/nginx/conf/vhost</code></li>\n<li>æŒ‰ä¸‹æ–‡æ•™ç¨‹é…ç½®æ—¶ï¼Œæ³¨æ„ä¿®æ”¹æ¼”ç¤ºé…ç½®ä¸­çš„åŸŸåå’Œç›®å½•</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nano /etc/nginx/sites-enabled/dujiaoka </span><br></pre></td></tr></table></figure>\n<p>ä½ å¯ä»¥å‚è€ƒæˆ‘çš„é…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">\tlisten [::]:80;</span><br><span class=\"line\">        server_name domain.com ;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> 301 https://$server_name<span class=\"variable\">$request_uri</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        listen 443 ssl http2;</span><br><span class=\"line\">\tlisten [::]:443 ssl http2;</span><br><span class=\"line\">        server_name domain.com ;</span><br><span class=\"line\">        index index.html index.htm index.php default.html default.htm default.php;</span><br><span class=\"line\">        root  /var/www/dujiaoka/public;</span><br><span class=\"line\">        ssl_certificate /etc/nginx/sslcert/cert.crt;</span><br><span class=\"line\">        ssl_certificate_key /etc/nginx/sslcert/key.key;</span><br><span class=\"line\">        <span class=\"comment\"># openssl dhparam -out /usr/local/nginx/conf/ssl/dhparam.pem 2048</span></span><br><span class=\"line\">        <span class=\"comment\">#ssl_dhparam /usr/local/nginx/conf/ssl/dhparam.pem;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">    try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.php?<span class=\"variable\">$query_string</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">        <span class=\"comment\">#error_page   404   /404.html;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Deny access to PHP files in specific directory</span></span><br><span class=\"line\">        <span class=\"comment\">#location ~ /(wp-content|uploads|wp-includes|images)/.*\\.php$ &#123; deny all; &#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ [^/]\\.php(/|$)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          </span><br><span class=\"line\">            fastcgi_pass  unix:/var/run/php/php7.4-fpm.sock;</span><br><span class=\"line\">           </span><br><span class=\"line\">            include snippets/fastcgi-php.conf;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            expires      30d;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ .*\\.(js|css)?$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            expires      12h;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ /.well-known &#123;</span><br><span class=\"line\">            allow all;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ /\\.</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            deny all;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        access_log off;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>åœ¨ <code>/etc/nginx/sslcert/</code> ä¸Šä¼ ä½ çš„httpsè¯ä¹¦ ä¹‹å <code>nginx -t</code> æ²¡æœ‰æŠ¥é”™å°±é‡å¯nginx <code>/etc/init.d/nginx restart</code></p>\n<h2 id=\"composer-å®‰è£…\"><a href=\"#composer-å®‰è£…\" class=\"headerlink\" title=\"composer å®‰è£…\"></a>composer å®‰è£…</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /var/www/dujiaoka</span><br><span class=\"line\">php -r <span class=\"string\">&quot;copy(&#x27;https://getcomposer.org/installer&#x27;, &#x27;composer-setup.php&#x27;);&quot;</span></span><br><span class=\"line\">php composer-setup.php</span><br><span class=\"line\">php -r <span class=\"string\">&quot;unlink(&#x27;composer-setup.php&#x27;);&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">mv</span> composer.phar /usr/local/bin/composer</span><br><span class=\"line\">adduser user</span><br><span class=\"line\">su user</span><br><span class=\"line\">composer install</span><br><span class=\"line\">composer update</span><br><span class=\"line\">su</span><br></pre></td></tr></table></figure>\n<h2 id=\"è®¿é—®å®‰è£…é¡µé¢\"><a href=\"#è®¿é—®å®‰è£…é¡µé¢\" class=\"headerlink\" title=\"è®¿é—®å®‰è£…é¡µé¢\"></a>è®¿é—®å®‰è£…é¡µé¢</h2><p>è®¿é—®ä½ çš„åŸŸåï¼Œè¿›è¡Œå®‰è£…</p>\n<ul>\n<li>MySQL æ•°æ®åº“åï¼š<code>dujiaoka</code></li>\n<li>MySQl å¯†ç ï¼š<code>ä½ è®¾ç½®çš„å¯†ç </code></li>\n<li>Redis å¯†ç ï¼š<code>æ— éœ€å¡«å†™</code></li>\n<li>ç½‘ç«™URLï¼šä½ çš„åŸŸåï¼Œå¦‚ <code>https://domain.com</code></li>\n</ul>\n<p>##ç¼–è¾‘é…ç½®æ–‡ä»¶</p>\n<p>ç¼–è¾‘ <code>/var/www/dujiaoka/.env</code></p>\n<ul>\n<li>å°† <code>APP_DEBUG=true</code> æ”¹ä¸º <code>APP_DEBUG=false</code></li>\n<li>å¦èµ·ä¸€è¡Œï¼Œæ·»åŠ  <code>ADMIN_HTTPS=true</code></li>\n<li>å°è¯•ç™»å…¥åå°ã€‚å¦‚æœæç¤º <code>0 error</code> ï¼Œåˆ·æ–°é¡µé¢å³å¯</li>\n</ul>\n<h2 id=\"é…ç½®-Supervisor\"><a href=\"#é…ç½®-Supervisor\" class=\"headerlink\" title=\"é…ç½® Supervisor\"></a>é…ç½® Supervisor</h2><p>å…ˆå®‰è£…</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install supervisor</span><br></pre></td></tr></table></figure>\n<p>åˆ›å»ºé…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nano /etc/supervisor/conf.d/dujiaoka.conf</span><br></pre></td></tr></table></figure>\n<p>å†™å…¥é…ç½®æ–‡ä»¶</p>\n<ul>\n<li>æ³¨æ„ä¿®æ”¹ç½‘ç«™ç›®å½•<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[program:laravel-worker]</span><br><span class=\"line\">process_name=%(program_name)s_%(process_num)02d</span><br><span class=\"line\"><span class=\"built_in\">command</span>=php /home/wwwroot/dujiaoka/artisan queue:work</span><br><span class=\"line\">autostart=<span class=\"literal\">true</span></span><br><span class=\"line\">autorestart=<span class=\"literal\">true</span></span><br><span class=\"line\">user=www</span><br><span class=\"line\">numprocs=1</span><br><span class=\"line\">redirect_stderr=<span class=\"literal\">true</span></span><br><span class=\"line\">stdout_logfile=/home/wwwlogs/worker.log</span><br></pre></td></tr></table></figure>\nå¯åŠ¨<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">supervisorctl reread</span><br><span class=\"line\">supervisorctl update</span><br><span class=\"line\">supervisorctl start laravel-worker:*</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"å‚è€ƒæ¥æº\"><a href=\"#å‚è€ƒæ¥æº\" class=\"headerlink\" title=\"å‚è€ƒæ¥æº\"></a>å‚è€ƒæ¥æº</h2><p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mariadb-php-lemp-stack-on-debian-10\">https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mariadb-php-lemp-stack-on-debian-10</a><br><a href=\"https://github.com/assimon/dujiaoka/wiki/2.x_linux_install\">https://github.com/assimon/dujiaoka/wiki/2.x_linux_install</a></p>\n<h1 id=\"dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka\"><a href=\"#dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka\" class=\"headerlink\" title=\"dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka\"></a>dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name kmfaka -itd -v /volume1/docker/kamifaka:/usr/src/app/public  -p 9200:8000 baiyuetribe/kamifaka:latest</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">    <span class=\"attr\">kamifaka:</span></span><br><span class=\"line\">        <span class=\"attr\">container_name:</span> <span class=\"string\">kmfaka</span></span><br><span class=\"line\">        <span class=\"attr\">stdin_open:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"attr\">tty:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"attr\">volumes:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"string\">./:/usr/src/app/public</span></span><br><span class=\"line\">        <span class=\"attr\">ports:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"number\">4445</span><span class=\"string\">:8000</span></span><br><span class=\"line\">        <span class=\"attr\">image:</span> <span class=\"string\">baiyuetribe/kamifaka:latest</span></span><br><span class=\"line\">        <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<p>åå°åœ°å€ipåœ°å€:9200&#x2F;adminã€‚é»˜è®¤ç®¡ç†å‘˜è´¦å·<a href=\"mailto:&#x61;&#x64;&#109;&#105;&#110;&#64;&#x71;&#113;&#46;&#x63;&#x6f;&#109;\">&#x61;&#x64;&#109;&#105;&#110;&#64;&#x71;&#113;&#46;&#x63;&#x6f;&#109;</a>ï¼Œå¯†ç ï¼š123456ã€‚</p>\n<p>Reference</p>\n<p><a href=\"https://www.youtube.com/watch?v=UF24A3h2x3I\">NASç”¨dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka</a></p>\n<p><a href=\"http://dacongyun.com/archives/635595.html\">çƒæ¨èä¸€ä¸ªå‘å¡ç¨‹åºï¼Œé™¤äº†ç‹¬è§’é£é“ƒè”æ</a></p>\n","more":"<h1 id=\"æœ‰ä»€ä¹ˆç”¨\"><a href=\"#æœ‰ä»€ä¹ˆç”¨\" class=\"headerlink\" title=\"æœ‰ä»€ä¹ˆç”¨\"></a>æœ‰ä»€ä¹ˆç”¨</h1><p>è‡ªåŠ¨å”®è´§ç³»ç»Ÿ-ç‹¬è§’æ•°å¡<br>å°è¯•æŒ‰æ•™æå’Œè§†é¢‘æ­å»ºå¤±è´¥äº†ï¼ˆè¯¦è§ç« èŠ‚ï¼šæ­å»ºå¤±è´¥çš„å†å²è®°å½•ï¼‰ï¼Œ<br>é¼“èµ·å‹‡æ°”ï¼Œé‡æ–°é€‰ç”¨æ–°çš„æ–¹æ¡ˆï¼š<a href=\"https://blog.dov.moe/posts/49102/\">https://blog.dov.moe/posts/49102/</a></p>\n<p>ä¸¾ä¸ªğŸŒ°ä¾‹å­ï¼š<a href=\"https://dovshop.net/\">https://dovshop.net/</a></p>\n<p><a href=\"https://ayangshop.com/buy/38\">https://ayangshop.com/buy/38</a></p>\n<div class=\"note danger\"><p>ç”±äºæœ¬äººæ— æ³•è§£å†³ï¼Œåä»£ä»¥åçš„é¡µé¢ä¸­é“¾æ¥æ²¡æœ‰è‡ªåŠ¨æºå¸¦ç«¯å£å¥½é—®é¢˜ã€‚æ”¾å¼ƒä½¿ç”¨ã€‚</p>\n</div>\n\n<h1 id=\"å®ç°æ–¹æ³•\"><a href=\"#å®ç°æ–¹æ³•\" class=\"headerlink\" title=\"å®ç°æ–¹æ³•\"></a>å®ç°æ–¹æ³•</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /www/server/panel/data/compose/dujiaoka/template</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir Shop &amp;&amp; cd Shop</span><br><span class=\"line\">mkdir storage uploads</span><br><span class=\"line\">chmod 777 storage uploads</span><br><span class=\"line\">â—æ³¨æ„æ­¤å¤„æ–‡ä»¶å¤¹æƒé™ä¸€å®šè¦ç»™ï¼</span><br><span class=\"line\"></span><br><span class=\"line\">chmod -R 777 env.conf</span><br><span class=\"line\"># é‡è¦æ­¥éª¤</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &quot;3&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  faka:</span><br><span class=\"line\">    image: ghcr.io/apocalypsor/dujiaoka:latest</span><br><span class=\"line\">    <span class=\"comment\"># å›½å†…æœåŠ¡å™¨å¯ä»¥ç”¨ hkccr.ccs.tencentyun.com/apocalypsor/dujiaoka:latest</span></span><br><span class=\"line\">    container_name: faka</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">        <span class=\"comment\"># - INSTALL=false</span></span><br><span class=\"line\">        - <span class=\"attr\">INSTALL</span>=<span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"comment\"># - MODIFY=true</span></span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./env.conf:/dujiaoka/.env</span><br><span class=\"line\">      - ./uploads:/dujiaoka/public/uploads</span><br><span class=\"line\">      - ./storage:/dujiaoka/storage</span><br><span class=\"line\">      - ./start-hook.sh:/dujiaoka/start-hook.sh</span><br><span class=\"line\">      <span class=\"comment\"># ç½‘ç«™å›¾æ ‡ 32X32 favicon.ico 4kbï¼Œé»˜è®¤æ¨¡ç‰ˆåªéœ€ç¬¬ä¸€å¤„ï¼Œå…¶ä»–æ¨¡ç‰ˆéœ€è¦ç¬¬äºŒå¤„</span></span><br><span class=\"line\">\t  <span class=\"comment\">#- ./favicon.ico:/dujiaoka/public/favicon.ico:ro</span></span><br><span class=\"line\">\t  <span class=\"comment\">#- ./favicon.ico:/dujiaoka/public/assets/style/favicon.ico:ro</span></span><br><span class=\"line\">\t  <span class=\"comment\"># é»˜è®¤å•†å“å›¾ç‰‡ 512x512 default.jpg 18kbï¼ˆç½‘ç«™ LOGO å…±äº«æ­¤å›¾ï¼Œä¸åå°è‡ªå®šä¹‰ LOGO å’Œå•†å“å›¾ç‰‡ä¸å†²çªï¼‰</span></span><br><span class=\"line\">\t  <span class=\"comment\"># - ./default.png:/dujiaoka/public/assets/common/images/default.jpg:ro</span></span><br><span class=\"line\">\t  <span class=\"comment\"># Luna ä¸»é¢˜ç½‘ç«™èƒŒæ™¯ 1920x1224 background.png 198kb</span></span><br><span class=\"line\">\t  <span class=\"comment\">#- ./background.png:/dujiaoka/public/assets/luna/img/background.png:ro</span></span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 4444:80</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\"> </span><br><span class=\"line\">  db:</span><br><span class=\"line\">    image: mariadb:focal</span><br><span class=\"line\">    container_name: faka-data</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_ROOT_PASSWORD</span>=mariadb</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_DATABASE</span>=dujiaoka</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_USER</span>=dujiaoka</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_PASSWORD</span>=dujiaokapassword</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./data:/var/lib/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:alpine</span><br><span class=\"line\">    container_name: faka-redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–è¾‘ .env æ–‡ä»¶</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">APP_NAME</span>=Carlçš„å°åº—</span><br><span class=\"line\"><span class=\"attr\">APP_ENV</span>=local</span><br><span class=\"line\"><span class=\"attr\">APP_KEY</span>=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\"><span class=\"attr\">APP_DEBUG</span>=<span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">APP_URL</span>=http://<span class=\"number\">192.168</span>.<span class=\"number\">6.116</span>:<span class=\"number\">4444</span></span><br><span class=\"line\"><span class=\"comment\">#ADMIN_HTTPS=true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">LOG_CHANNEL</span>=stack</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ•°æ®åº“é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">DB_CONNECTION</span>=mysql</span><br><span class=\"line\"><span class=\"attr\">DB_HOST</span>=db</span><br><span class=\"line\"><span class=\"attr\">DB_PORT</span>=<span class=\"number\">3306</span></span><br><span class=\"line\"><span class=\"attr\">DB_DATABASE</span>=dujiaoka</span><br><span class=\"line\"><span class=\"attr\">DB_USERNAME</span>=dujiaoka</span><br><span class=\"line\"><span class=\"attr\">DB_PASSWORD</span>=dujiaokapassword</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># redis é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">REDIS_HOST</span>=redis</span><br><span class=\"line\"><span class=\"attr\">REDIS_PASSWORD</span>=</span><br><span class=\"line\"><span class=\"attr\">REDIS_PORT</span>=<span class=\"number\">6379</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">BROADCAST_DRIVER</span>=log</span><br><span class=\"line\"><span class=\"attr\">SESSION_DRIVER</span>=file</span><br><span class=\"line\"><span class=\"attr\">SESSION_LIFETIME</span>=<span class=\"number\">120</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¼“å­˜é…ç½®</span></span><br><span class=\"line\"><span class=\"comment\"># file ä¸ºç£ç›˜æ–‡ä»¶  redis ä¸ºå†…å­˜çº§åˆ«</span></span><br><span class=\"line\"><span class=\"comment\"># redis ä¸ºå†…å­˜éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">CACHE_DRIVER</span>=redis</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</span></span><br><span class=\"line\"><span class=\"comment\"># sync ä¸ºåŒæ­¥  redis ä¸ºå¼‚æ­¥</span></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨ redis å¼‚æ­¥éœ€è¦å®‰è£…å¥½ redis æœåŠ¡ç«¯å¹¶é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">QUEUE_CONNECTION</span>=redis</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åå°è¯­è¨€</span></span><br><span class=\"line\"><span class=\"comment\">## zh_CN ç®€ä½“ä¸­æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">## zh_TW ç¹ä½“ä¸­æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">## en    è‹±æ–‡</span></span><br><span class=\"line\"><span class=\"attr\">DUJIAO_ADMIN_LANGUAGE</span>=zh_CN</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åå°ç™»å½•åœ°å€</span></span><br><span class=\"line\"><span class=\"attr\">ADMIN_ROUTE_PREFIX</span>=/admin</span><br></pre></td></tr></table></figure>\n\n<p>ä¸€ç›´æ— æ³•ä¸‹è½½æˆåŠŸâ€¦â€¦<br>ä¿®æ”¹ä½¿ç”¨ï¼šstilleshan&#x2F;dujiaoka</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose+å¦‚ä½•ä½¿ç”¨ä»£ç†æé€Ÿ</span><br><span class=\"line\">\t\thttps://neucrack.com/p/286</span><br><span class=\"line\">\tworkaourndï¼šæ‰‹åŠ¨è®©OpenClashä¸åœåœ¨çº¿ï¼ˆä¸åœ¨çº¿å°±é‡æ–°åˆ·æ–°å–è·å–æœ€æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼‰</span><br></pre></td></tr></table></figure>\n\n<p>ç»ˆäºä¸‹è½½æˆåŠŸåï¼Œå¯åŠ¨å¤±è´¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting &quot;/www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico&quot; to rootfs at &quot;/dujiaoka/public/favicon.ico&quot;: mount /www/server/panel/data/compose/dujiaoka/template/Shop/favicon.ico:/dujiaoka/public/favicon.ico (via /proc/self/fd/6), flags: 0x5001: not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type</span><br></pre></td></tr></table></figure>\n<p>æ³¨é‡Šæ‰é‚£å‡ ä¸ªè‡ªå®šä¹‰çš„æ–‡ä»¶æ˜ å°„ï¼Œå°±å¥½äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">faka        | The environment file is invalid!</span><br><span class=\"line\">faka        | Failed to parse dotenv file due to unexpected whitespace. Failed at [Carl Shop].</span><br></pre></td></tr></table></figure>\n<p>è¿”å›ä¿®æ”¹æŠŠå‰ååŠ ä¸Šå¼•å·ã€‚</p>\n<p>ä¿®æ”¹äº†ç«¯å£æ˜ å°„å‡º4444åï¼Œé”™è¯¯ï¼š<br>500<br>Server Error</p>\n<p>â—æ³¨æ„ç¯å¢ƒå˜é‡å¦‚æœå†™çš„ä¸å¯¹å¯èƒ½å¯¼è‡´ 500ï¼Œå¯ä»¥å¼€ APP_DEBUG&#x3D;true çœ‹çœ‹å…·ä½“æ˜¯å“ªé‡Œå†™é”™äº†ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   throw new RuntimeException(&#x27;The only supported ciphers are AES-128-CBC and AES-256-CBC with the correct key lengths.&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">è§£å†³åŠæ³•ï¼šä¿®æ”¹APP_KEY=base64:hDVkYhfkUjaePiaI1tcBT7G8bh2A8RQxwWIGkq7BO18=</span><br><span class=\"line\">--------------</span><br><span class=\"line\"></span><br><span class=\"line\">file_put_contents(/dujiaoka/.env): failed to open stream: Permission denied</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>æœ¬åœ°è®¿é—®æˆåŠŸï¼š<a href=\"http://192.168.6.116:4444/\">http://192.168.6.116:4444</a></p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://hub.docker.com/r/stilleshan/dujiaoka\">https://hub.docker.com/r/stilleshan/dujiaoka</a><br><a href=\"https://hub.docker.com/r/jiangjuhong/dujiaoka\">https://hub.docker.com/r/jiangjuhong/dujiaoka</a></p>\n<h2 id=\"æ­é…frpc\"><a href=\"#æ­é…frpc\" class=\"headerlink\" title=\"æ­é…frpc\"></a>æ­é…frpc</h2><p>20231203 NPMåä»£å¤±è´¥ï¼Œå‡ å‘¨åï¼›ç»ˆäºæ‰¾åˆ°è§£å†³æ–¹æ¡ˆäº†ï¼šå‘ç°å¯ä»¥ç”¨frpcåä»£å‡ºå»å°±å¥½</p>\n<p>é…ç½®å®Œæˆfrpc -c frpc.iniï¼Œ å¯æ˜¯ä¾æ—§æ˜¯ç‚¹å‡»çš„é“¾æ¥æ²¡æœ‰æºå¸¦ç«¯å£å·ï¼›éå¸¸éƒé—·</p>\n<hr>\n<hr>\n<h1 id=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"><a href=\"#æ­å»ºå¤±è´¥çš„å†å²è®°å½•\" class=\"headerlink\" title=\"æ­å»ºå¤±è´¥çš„å†å²è®°å½•\"></a>æ­å»ºå¤±è´¥çš„å†å²è®°å½•</h1><p>ç‹¬è§’æ•°å¡<br>å¼€æºå¼ç«™é•¿è‡ªåŠ¨åŒ–å”®è´§è§£å†³æ–¹æ¡ˆã€é«˜æ•ˆã€ç¨³å®šã€å¿«é€Ÿï¼</p>\n<p>å¾’æ‰‹æ­å»ºç‹¬è§’æ•°å‘å¡ç½‘ç«™ ç»è¥è‡ªå·±çš„å°åº—ï¼ - å…­æœˆ 26, 2023<br><a href=\"https://kejilion.blogspot.com/2023/06/blog-post_26.html\">https://kejilion.blogspot.com/2023/06/blog-post_26.html</a></p>\n<p>é…ç½®docker-compose<br><a href=\"https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml\">https://github.com/kejilion/docker/blob/main/LNMP-docker-compose.yml</a></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;3.8&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nginx:</span><br><span class=\"line\">    image: nginx:1.22</span><br><span class=\"line\">    container_name: nginx</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 882:80</span><br><span class=\"line\">      - 4444:443      </span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./nginx.conf:/etc/nginx/nginx.conf</span><br><span class=\"line\">      - ./certs:/etc/nginx/certs      </span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  php:</span><br><span class=\"line\">    image: php:7.4.33-fpm</span><br><span class=\"line\">    container_name: php</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./html:/var/www/html</span><br><span class=\"line\"></span><br><span class=\"line\">  mysql:</span><br><span class=\"line\">    image: mysql:5.7.42</span><br><span class=\"line\">    container_name: mysql</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./mysql:/var/lib/mysql</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_ROOT_PASSWORD</span>=webroot</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_DATABASE</span>=web</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_USER</span>=carlZeng</span><br><span class=\"line\">      - <span class=\"attr\">MYSQL_PASSWORD</span>=carlZengYYDS</span><br><span class=\"line\"></span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    image: redis:latest</span><br><span class=\"line\">    container_name: redis</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./redis:/data</span><br></pre></td></tr></table></figure>\n<p>ä¿®æ”¹äº†ç‹¬è§’æ•°å¡çš„ç«¯å£</p>\n<p>ç”³è¯·è¯ä¹¦, ä¸‹è½½è¯ä¹¦;</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ç›´æ¥å»NPMä¸­ä¸‹è½½è¯ä¹¦è§£å‹ç¼©åé‡å‘½åæ”¾åˆ°debiançš„ç›®å½•ï¼š</span><br><span class=\"line\">/home/web/certs</span><br><span class=\"line\">    key.pem</span><br><span class=\"line\">    cert.pem</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p>ç»§ç»­é…ç½®nginx.conf</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections 1024<span class=\"comment\">;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    include       /etc/nginx/mime.types<span class=\"comment\">;</span></span><br><span class=\"line\">    default_type  application/octet-stream<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on<span class=\"comment\">;</span></span><br><span class=\"line\">    keepalive_timeout  65<span class=\"comment\">;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    client_max_body_size 1000m<span class=\"comment\">;  </span></span><br><span class=\"line\">    <span class=\"comment\">#ä¸Šä¼ é™åˆ¶å‚æ•°1Gä»¥å†…æ–‡ä»¶å¯ä¸Šä¼ </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># HTTP server</span></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80<span class=\"comment\">;</span></span><br><span class=\"line\">        server_name shop.carlzeng.com<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Redirect all HTTP requests to HTTPS</span></span><br><span class=\"line\">        return 301 https://$host$request_uri<span class=\"comment\">;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># HTTPS server</span></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443 ssl http2<span class=\"comment\">;</span></span><br><span class=\"line\">        server_name shop.carlzeng.com<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># http2 on;</span></span><br><span class=\"line\">            </span><br><span class=\"line\">        ssl_certificate /etc/nginx/certs/cert.pem<span class=\"comment\">;</span></span><br><span class=\"line\">        ssl_certificate_key /etc/nginx/certs/key.pem<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        root /var/www/html/dujiaoka/public/<span class=\"comment\">;</span></span><br><span class=\"line\">        index index.php<span class=\"comment\">;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        try_files $uri $uri/ /index.php?$query_string<span class=\"comment\">;    </span></span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># PHP-FPM configuration</span></span><br><span class=\"line\">        location ~ \\.php$ &#123;</span><br><span class=\"line\">            fastcgi_pass php:9000<span class=\"comment\">;</span></span><br><span class=\"line\">            fastcgi_index index.php<span class=\"comment\">;</span></span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name<span class=\"comment\">;</span></span><br><span class=\"line\">            include fastcgi_params<span class=\"comment\">;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>cd &#x2F;home&#x2F;web&#x2F;html &amp;&amp; wget <a href=\"https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz\">https://ghproxy.com/https://github.com/assimon/dujiaoka/releases/download/2.0.6/2.0.6-antibody.tar.gz</a> &amp;&amp; apt install -y tar &amp;&amp; tar -zxvf 2.0.6-antibody.tar.gz &amp;&amp; rm 2.0.6-antibody.tar.gz</p>\n<p>å®‰è£…PHPæ‰©å±•</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec php apt update &amp;&amp; docker exec php apt install -y libmariadb-dev-compat libmariadb-dev libzip-dev libmagickwand-dev imagemagick</span><br><span class=\"line\"></span><br><span class=\"line\">å¡æ­»åœ¨è¿™ä¸€æ­¥ï¼Œåˆ†è§£å¦‚ä¸‹ï¼š</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev-compat</span><br><span class=\"line\">    docker exec php apt install -y libmariadb-dev</span><br><span class=\"line\">    docker exec php apt install -y libzip-dev</span><br><span class=\"line\">    docker exec php apt install -y libmagickwand-dev</span><br><span class=\"line\">        libmagickwand-dev is already the newest version (8:6.9.11.60+dfsg-1.3+deb11u1).</span><br><span class=\"line\">    docker exec php apt install -y imagemagick</span><br><span class=\"line\">        Build process completed successfully</span><br><span class=\"line\">        Installing &#x27;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#x27;</span><br><span class=\"line\">        install ok: channel://pecl.php.net/redis-6.0.2</span><br><span class=\"line\">        configuration option &quot;php_ini&quot; is not set to php.ini location</span><br><span class=\"line\">        You should add &quot;extension=redis.so&quot; to php.ini</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">docker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœç™»å½•æ—¶æŠ¥é”™å†ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œè§£é™¤HTTPSé™åˆ¶</p>\n<p>sed -i â€˜s&#x2F;ADMIN_HTTPS&#x3D;false&#x2F;ADMIN_HTTPS&#x3D;true&#x2F;gâ€™ &#x2F;home&#x2F;web&#x2F;html&#x2F;dujiaoka&#x2F;.env</p>\n<p>é”™è¯¯ä»¥åŠè§£å†³åŠæ³•<br>ä¸åŒæ—¶æœŸå†ç½‘é¡µé¡µé¢ï¼Œç‚¹å‡»å®‰è£…åå‡ºç°çš„é”™è¯¯</p>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><pre><code>è§£å†³ï¼šä¿®æ”¹äº†nginx.confï¼Œç¡®ä¿80å’Œ443ç«¯å£ï¼ˆdockerä¸­çš„ç«¯å£å ç”¨ï¼Œé»˜è®¤å³å¯ï¼‰\nç¡®è®¤äº†php dockerä¸­çš„PHPæ‰©å±•ï¼Œç¡®ä¿æ‰€æœ‰æ’ä»¶éƒ½å®‰è£…æˆåŠŸ\n</code></pre>\n<h3 id=\"Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\"><a href=\"#Redisé…ç½®é”™è¯¯-php-network-getaddresses-getaddrinfo-failed-Name-or-service-not-known\" class=\"headerlink\" title=\"Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known\"></a>Redisé…ç½®é”™è¯¯ :php_network_getaddresses: getaddrinfo failed: Name or service not known</h3><pre><code>è§£å†³ï¼šsed -i &#39;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#39; /home/web/html/dujiaoka/.env\næ ¸æŸ¥äº†php dockerä¸­ å®‰è£…PHPæ‹“å±•éƒ¨åˆ†äºredisç›¸å…³çš„ï¼›\ndocker-php-ext-redis.iniï¼ˆå·²åŒ…å«å†…å®¹ï¼šextension=redis.soï¼‰\n\nåŸæ¥æ˜¯redis å†™æˆäº†radisï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h3 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-SQLSTATE-HY000-1045-Access-denied-for-user-â€˜carlZEngâ€˜-â€™172-24-0-5â€™-using-password-YES-SQL-select-1-limit-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :SQLSTATE[HY000] [1045] Access denied for user â€˜carlZEngâ€˜@â€™172.24.0.5â€™ (using password: YES) (SQL: select 1 limit 1)</h3><pre><code>è§£å†³ï¼šMySQLç”¨æˆ·åå¡«å†™é”™è¯¯ï¼Œçº æ­£åé‡è¯•\n</code></pre>\n<h4 id=\"æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\"><a href=\"#æ•°æ®åº“é…ç½®é”™è¯¯-could-not-find-driver-SQL-select-1-limit-1-1\" class=\"headerlink\" title=\"æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)\"></a>æ•°æ®åº“é…ç½®é”™è¯¯ :could not find driver (SQL: select 1 limit 1)</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">è§£å†³ï¼š</span><br><span class=\"line\">æ£€æµ‹ï¼šdocker exec -it php php -i |grep mysqlnd  æ’æŸ¥æ˜¯å¦å¯ç”¨äº†mysqlé©±åŠ¨</span><br><span class=\"line\">    mysqlnd</span><br><span class=\"line\">    mysqlnd =&gt; enabled</span><br><span class=\"line\">    Version =&gt; mysqlnd 7.4.3</span><br><span class=\"line\"></span><br><span class=\"line\">docker exec -it php /bin/bash</span><br><span class=\"line\">docker-php-ext-install pdo pdo_mysql</span><br><span class=\"line\">docker-compose restart php</span><br><span class=\"line\"></span><br><span class=\"line\">è¿™ä¸ªå¥½åƒæ²¡æœ‰è¢«æ°¸ä¹…ä¿å­˜ä½ï¼Œè¿™å¯¼è‡´æ¯æ¬¡docker-compose restart phpéƒ½ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯,</span><br><span class=\"line\">æŒ‰ç…§ä¸Šé¢è§£å†³å¥½ä»¥åï¼Œç´§æ¥ç€å°±æ˜¯ä¸‹é¢è¿™ä¸ªRedisé”™è¯¯</span><br><span class=\"line\"></span><br><span class=\"line\">è¿™æ¬¡æ˜¯ä¿®æ­£åï¼Œæœ€åæ˜¯é€šè¿‡docker restart php è§£å†³äº†é”™è¯¯</span><br><span class=\"line\">æµ‹è¯• docker-compose restart ä¼šä¸ä¼šæŠŠæ•°æ®åœ¨ç»§ç»­ç ´åäº†ï¼Œé‡æ–°æ‹‰å–ï¼Ÿ</span><br><span class=\"line\">    ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼ é‚£ä¸‹ä¸€æ¬¡æ€ä¹ˆåŠï¼Ÿç»§ç»­å¦‚æ­¤ä¿®å¤å³å¯</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\"><a href=\"#Please-make-sure-the-PHP-Redis-extension-is-installed-and-enabled\" class=\"headerlink\" title=\"Please make sure the PHP Redis extension is installed and enabled.\"></a>Please make sure the PHP Redis extension is installed and enabled.</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it php /bin/bash</span><br><span class=\"line\">pecl install redis</span><br><span class=\"line\">    checking for igbinary includes... configure: error: Cannot find igbinary.h</span><br><span class=\"line\">        ERROR: `/tmp/pear/temp/redis/configure --with-php-config=/usr/local/bin/php-config --enable-redis-igbinary=yes --enable-redis-lzf=yes --enable-redis-zstd=yes --enable-redis-msgpack=yes --enable-redis-lz4=yes --with-liblz4&#x27; failed</span><br><span class=\"line\">Build process completed successfully</span><br><span class=\"line\">Installing &#x27;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/redis.so&#x27;</span><br><span class=\"line\">install ok: channel://pecl.php.net/redis-6.0.2</span><br><span class=\"line\">configuration option &quot;php_ini&quot; is not set to php.ini location</span><br><span class=\"line\">You should add &quot;extension=redis.so&quot; to php.ini</span><br><span class=\"line\"></span><br><span class=\"line\">è§£å†³ï¼šdocker exec php docker-php-ext-install pdo_mysql zip bcmath gd intl opcache &amp;&amp; docker exec php pecl install redis &amp;&amp; docker exec php sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br><span class=\"line\">è§£å†³åˆ†è§£ï¼Œå¹¶é€ä¸€ç¡®è®¤æ‰§è¡ŒæˆåŠŸ</span><br><span class=\"line\">    docker exec -it php /bin/bash</span><br><span class=\"line\">        docker-php-ext-install pdo_mysql zip bcmath gd intl opcache</span><br><span class=\"line\">        pecl install redis</span><br><span class=\"line\">        sh -c &#x27;echo &quot;extension=redis.so&quot; &gt; /usr/local/etc/php/conf.d/docker-php-ext-redis.ini&#x27;</span><br><span class=\"line\">åœ¨ bash ä¸‹ï¼Œä¸€ä¸€æ‰§è¡Œï¼Œæ£€æŸ¥ç»“æœ</span><br><span class=\"line\"></span><br><span class=\"line\">æœ€åï¼Œéœ€è¦docker-compose restart</span><br><span class=\"line\">ä¹‹å‰éƒ½æ˜¯é‡å¯phpå®¹å™¨docker restart php æ— æ³•è§£å†³é—®é¢˜ã€‚éœ€è¦çš„æ˜¯ï¼šdocker-compose restart</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"0-error\"><a href=\"#0-error\" class=\"headerlink\" title=\"0 error\"></a>0 error</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å®‰è£…æˆåŠŸå redirect https://192.168.6.116:4444/admin/auth/login</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">åå°ç™»å½•å‡ºç°0erræˆ–è€…å…¶ä»–ç™»å½•å¼‚å¸¸é—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯å¼€å¯äº†httpsè€Œåå°æ²¡æœ‰å¼€å¯ï¼ŒæŠŠä¸‹é¢çš„<span class=\"literal\">false</span>æ”¹ä¸º<span class=\"literal\">true</span>å³å¯</span></span><br><span class=\"line\">ADMIN_HTTPS=false</span><br><span class=\"line\">è§£å†³ï¼šsed -i &#x27;s/ADMIN_HTTPS=false/ADMIN_HTTPS=true/g&#x27; /home/web/html/dujiaoka/.env</span><br><span class=\"line\"></span><br><span class=\"line\">æˆåŠŸäº†ï¼Œæœ¬åœ°å±€åŸŸç½‘å¯è®¿é—®ã€‚</span><br><span class=\"line\">ä¸‹ä¸€æ­¥æ˜¯ä¸ºä½•æ— æ³•NPMåä»£https://192.168.6.116:4444</span><br></pre></td></tr></table></figure>\n\n\n<h4 id=\"outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\"><a href=\"#outstanding-åˆ›å»ºè®¢å•å‡ºé”™-Symfony-Component-Debug-Exception-FatalThrowableError\" class=\"headerlink\" title=\"[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError\"></a>[outstanding]åˆ›å»ºè®¢å•å‡ºé”™ Symfony\\Component\\Debug\\Exception\\FatalThrowableError</h4><pre><code>Call to undefined function App\\Service\\bcmul()\nhttps://192.168.6.116:4444/create-order\n</code></pre>\n<h4 id=\"outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-com-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"><a href=\"#outstanding-npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ-https-buy-carlzeng-com-4443-å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥-æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ-buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\" class=\"headerlink\" title=\"[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ https://buy.carlzeng.com:4443/ å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦\"></a>[outstanding]npmæ›´æ¢äºŒçº§åŸŸåååä»£æˆåŠŸ <a href=\"https://buy.carlzeng.com:4443/\">https://buy.carlzeng.com:4443/</a> å¯¼è‡´é—®é¢˜ï¼šæ‰€æœ‰çš„å›¾ç‰‡é‚£äº›æŒ‡å‘çš„é“¾æ¥ æ²¡æœ‰åŠ ç«¯å£å·ï¼Œå¯¼è‡´å›¾ç‰‡å…¨éƒ¨å¤±æ•ˆ, buyé“¾æ¥ä¹Ÿæ²¡æœ‰ç«¯å£å·â€¦</h4><h4 id=\"é‡å‘½åinstall-lock-é‡è£…\"><a href=\"#é‡å‘½åinstall-lock-é‡è£…\" class=\"headerlink\" title=\"é‡å‘½åinstall.lock é‡è£…\"></a>é‡å‘½åinstall.lock é‡è£…</h4><pre><code>é‡è£…åæ•°æ®é‡æ–°é…ç½®ï¼Œå¯¼è‡´è®¾ç½®çš„å•†å“ç­‰ç­‰å…¨éƒ¨æ¸…é›¶ï¼›ä¸Šé¢é—®é¢˜å¾…æµ‹è¯•\nURLè‡ªåŠ¨æºå¸¦ç«¯å£ï¼Œæ²¡æœ‰è§£å†³ã€‚\n</code></pre>\n<p>â€‹    </p>\n<h1 id=\"Debian-Manual\"><a href=\"#Debian-Manual\" class=\"headerlink\" title=\"Debian Manual\"></a>Debian Manual</h1><h2 id=\"å†™åœ¨å‰é¢\"><a href=\"#å†™åœ¨å‰é¢\" class=\"headerlink\" title=\"å†™åœ¨å‰é¢\"></a>å†™åœ¨å‰é¢</h2><ul>\n<li>æ­¤æ•™ç¨‹ä¸“ä¸ºæœ‰æ´ç™–çš„å®å®ä»¬å‡†å¤‡ã€‚ä¸ä½¿ç”¨ä»»ä½•ä¸€é”®å®‰è£…è„šæœ¬ã€‚é¢æ¿å…šå¯ä»¥é€€æ•£äº†ï¼ï¼</li>\n<li>æœ¬äººæµ‹è¯•ç¯å¢ƒæ˜¯ Debian 11 å…¶ä»–çš„æ²¡æµ‹è¯•ã€‚</li>\n</ul>\n<h2 id=\"æ‰‹åŠ¨å®‰è£…lnmp\"><a href=\"#æ‰‹åŠ¨å®‰è£…lnmp\" class=\"headerlink\" title=\"æ‰‹åŠ¨å®‰è£…lnmp\"></a>æ‰‹åŠ¨å®‰è£…lnmp</h2><ul>\n<li>æ›´æ–°æº</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt update  </span><br><span class=\"line\">apt upgrade</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å®‰è£…Nginx<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install nginx</span><br></pre></td></tr></table></figure></li>\n<li>å®‰è£…Mariadb<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install mariadb-server</span><br></pre></td></tr></table></figure></li>\n<li>é…ç½®Mariadb<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql_secure_installation</span><br></pre></td></tr></table></figure>\næ ¹æ®æç¤ºæ“ä½œå³å¯ã€‚</li>\n<li>åˆ›å»ºæ•°æ®åº“<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mariadb</span><br></pre></td></tr></table></figure>\nä¹‹åä¼šæ˜¾ç¤º<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection <span class=\"built_in\">id</span> is 74</span><br><span class=\"line\">Server version: 10.3.15-MariaDB-1 Debian 10</span><br><span class=\"line\">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> <span class=\"built_in\">help</span>. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure>\næ¥ä¸‹æ¥è¾“å…¥å‘½ä»¤ <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> DATABASE [è¿™é‡Œæ›¿æ¢ä¸ºæ•°æ®åº“å] ;</span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">ON</span> [è¿™é‡Œæ›¿æ¢ä¸ºæ•°æ®åº“å].<span class=\"operator\">*</span> <span class=\"keyword\">TO</span> <span class=\"string\">&#x27;[è¿™é‡Œæ›¿æ¢ä¸ºç”¨æˆ·å]&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> IDENTIFIED <span class=\"keyword\">BY</span> <span class=\"string\">&#x27;[è¿™é‡Œæ›¿æ¢ä¸ºå¯†ç ]&#x27;</span> <span class=\"keyword\">WITH</span> <span class=\"keyword\">GRANT</span> OPTION;</span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\">EXIT</span><br></pre></td></tr></table></figure></li>\n<li>å®‰è£…PHP7.4<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install php php-fpm php-mysql php-gd php-zip php-opcache php-curl php-mbstring php-intl php-dom php-bcmath php-redis php-fileinfo</span><br></pre></td></tr></table></figure></li>\n<li>å®‰è£…redis<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install redis</span><br></pre></td></tr></table></figure></li>\n<li>å¯ç”¨å‡½æ•°<br><code>nano /etc/php/7.4/fpm/php.ini</code>,<code>ctrl+w</code> æœç´¢ <code>putenv</code>ï¼Œ<code>proc_open</code>ï¼Œ<code>pcntl_signal</code>ï¼Œ<code>pcntl_alarm</code> åœ¨<code>disable_functions</code> ä¸€è¡Œ æœ‰å°±å»æ‰ã€‚<br>ä¹‹å <code>/etc/init.d/php7.4-fpm reload</code></li>\n</ul>\n<h2 id=\"ä¸‹è½½æºä»£ç \"><a href=\"#ä¸‹è½½æºä»£ç \" class=\"headerlink\" title=\"ä¸‹è½½æºä»£ç \"></a>ä¸‹è½½æºä»£ç </h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /var/www/dujiaoka</span><br><span class=\"line\">apt install git</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/assimon/dujiaoka.git </span><br><span class=\"line\"><span class=\"built_in\">chmod</span> 777 -R /var/www/dujiaoka</span><br></pre></td></tr></table></figure>\n<h2 id=\"é…ç½®-nginx\"><a href=\"#é…ç½®-nginx\" class=\"headerlink\" title=\"é…ç½® nginx\"></a>é…ç½® nginx</h2><ul>\n<li>å‡è®¾ä½ çš„åŸŸåæ˜¯ï¼š<code>domain.com</code></li>\n<li>å‡è®¾ä½ çš„ç½‘ç«™ç›®å½•æ˜¯ï¼š<code>/home/wwwroot/dujiaoka</code></li>\n<li>é…ç½®æ–‡ä»¶çš„å­˜æ”¾ç›®å½•æ˜¯ï¼š<code>/usr/local/nginx/conf/vhost</code></li>\n<li>æŒ‰ä¸‹æ–‡æ•™ç¨‹é…ç½®æ—¶ï¼Œæ³¨æ„ä¿®æ”¹æ¼”ç¤ºé…ç½®ä¸­çš„åŸŸåå’Œç›®å½•</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nano /etc/nginx/sites-enabled/dujiaoka </span><br></pre></td></tr></table></figure>\n<p>ä½ å¯ä»¥å‚è€ƒæˆ‘çš„é…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">\tlisten [::]:80;</span><br><span class=\"line\">        server_name domain.com ;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> 301 https://$server_name<span class=\"variable\">$request_uri</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        listen 443 ssl http2;</span><br><span class=\"line\">\tlisten [::]:443 ssl http2;</span><br><span class=\"line\">        server_name domain.com ;</span><br><span class=\"line\">        index index.html index.htm index.php default.html default.htm default.php;</span><br><span class=\"line\">        root  /var/www/dujiaoka/public;</span><br><span class=\"line\">        ssl_certificate /etc/nginx/sslcert/cert.crt;</span><br><span class=\"line\">        ssl_certificate_key /etc/nginx/sslcert/key.key;</span><br><span class=\"line\">        <span class=\"comment\"># openssl dhparam -out /usr/local/nginx/conf/ssl/dhparam.pem 2048</span></span><br><span class=\"line\">        <span class=\"comment\">#ssl_dhparam /usr/local/nginx/conf/ssl/dhparam.pem;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">    try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.php?<span class=\"variable\">$query_string</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">        <span class=\"comment\">#error_page   404   /404.html;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Deny access to PHP files in specific directory</span></span><br><span class=\"line\">        <span class=\"comment\">#location ~ /(wp-content|uploads|wp-includes|images)/.*\\.php$ &#123; deny all; &#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ [^/]\\.php(/|$)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          </span><br><span class=\"line\">            fastcgi_pass  unix:/var/run/php/php7.4-fpm.sock;</span><br><span class=\"line\">           </span><br><span class=\"line\">            include snippets/fastcgi-php.conf;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            expires      30d;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ .*\\.(js|css)?$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            expires      12h;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ /.well-known &#123;</span><br><span class=\"line\">            allow all;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ /\\.</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            deny all;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        access_log off;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>åœ¨ <code>/etc/nginx/sslcert/</code> ä¸Šä¼ ä½ çš„httpsè¯ä¹¦ ä¹‹å <code>nginx -t</code> æ²¡æœ‰æŠ¥é”™å°±é‡å¯nginx <code>/etc/init.d/nginx restart</code></p>\n<h2 id=\"composer-å®‰è£…\"><a href=\"#composer-å®‰è£…\" class=\"headerlink\" title=\"composer å®‰è£…\"></a>composer å®‰è£…</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /var/www/dujiaoka</span><br><span class=\"line\">php -r <span class=\"string\">&quot;copy(&#x27;https://getcomposer.org/installer&#x27;, &#x27;composer-setup.php&#x27;);&quot;</span></span><br><span class=\"line\">php composer-setup.php</span><br><span class=\"line\">php -r <span class=\"string\">&quot;unlink(&#x27;composer-setup.php&#x27;);&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">mv</span> composer.phar /usr/local/bin/composer</span><br><span class=\"line\">adduser user</span><br><span class=\"line\">su user</span><br><span class=\"line\">composer install</span><br><span class=\"line\">composer update</span><br><span class=\"line\">su</span><br></pre></td></tr></table></figure>\n<h2 id=\"è®¿é—®å®‰è£…é¡µé¢\"><a href=\"#è®¿é—®å®‰è£…é¡µé¢\" class=\"headerlink\" title=\"è®¿é—®å®‰è£…é¡µé¢\"></a>è®¿é—®å®‰è£…é¡µé¢</h2><p>è®¿é—®ä½ çš„åŸŸåï¼Œè¿›è¡Œå®‰è£…</p>\n<ul>\n<li>MySQL æ•°æ®åº“åï¼š<code>dujiaoka</code></li>\n<li>MySQl å¯†ç ï¼š<code>ä½ è®¾ç½®çš„å¯†ç </code></li>\n<li>Redis å¯†ç ï¼š<code>æ— éœ€å¡«å†™</code></li>\n<li>ç½‘ç«™URLï¼šä½ çš„åŸŸåï¼Œå¦‚ <code>https://domain.com</code></li>\n</ul>\n<p>##ç¼–è¾‘é…ç½®æ–‡ä»¶</p>\n<p>ç¼–è¾‘ <code>/var/www/dujiaoka/.env</code></p>\n<ul>\n<li>å°† <code>APP_DEBUG=true</code> æ”¹ä¸º <code>APP_DEBUG=false</code></li>\n<li>å¦èµ·ä¸€è¡Œï¼Œæ·»åŠ  <code>ADMIN_HTTPS=true</code></li>\n<li>å°è¯•ç™»å…¥åå°ã€‚å¦‚æœæç¤º <code>0 error</code> ï¼Œåˆ·æ–°é¡µé¢å³å¯</li>\n</ul>\n<h2 id=\"é…ç½®-Supervisor\"><a href=\"#é…ç½®-Supervisor\" class=\"headerlink\" title=\"é…ç½® Supervisor\"></a>é…ç½® Supervisor</h2><p>å…ˆå®‰è£…</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install supervisor</span><br></pre></td></tr></table></figure>\n<p>åˆ›å»ºé…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nano /etc/supervisor/conf.d/dujiaoka.conf</span><br></pre></td></tr></table></figure>\n<p>å†™å…¥é…ç½®æ–‡ä»¶</p>\n<ul>\n<li>æ³¨æ„ä¿®æ”¹ç½‘ç«™ç›®å½•<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[program:laravel-worker]</span><br><span class=\"line\">process_name=%(program_name)s_%(process_num)02d</span><br><span class=\"line\"><span class=\"built_in\">command</span>=php /home/wwwroot/dujiaoka/artisan queue:work</span><br><span class=\"line\">autostart=<span class=\"literal\">true</span></span><br><span class=\"line\">autorestart=<span class=\"literal\">true</span></span><br><span class=\"line\">user=www</span><br><span class=\"line\">numprocs=1</span><br><span class=\"line\">redirect_stderr=<span class=\"literal\">true</span></span><br><span class=\"line\">stdout_logfile=/home/wwwlogs/worker.log</span><br></pre></td></tr></table></figure>\nå¯åŠ¨<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">supervisorctl reread</span><br><span class=\"line\">supervisorctl update</span><br><span class=\"line\">supervisorctl start laravel-worker:*</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"å‚è€ƒæ¥æº\"><a href=\"#å‚è€ƒæ¥æº\" class=\"headerlink\" title=\"å‚è€ƒæ¥æº\"></a>å‚è€ƒæ¥æº</h2><p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mariadb-php-lemp-stack-on-debian-10\">https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mariadb-php-lemp-stack-on-debian-10</a><br><a href=\"https://github.com/assimon/dujiaoka/wiki/2.x_linux_install\">https://github.com/assimon/dujiaoka/wiki/2.x_linux_install</a></p>\n<h1 id=\"dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka\"><a href=\"#dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka\" class=\"headerlink\" title=\"dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka\"></a>dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name kmfaka -itd -v /volume1/docker/kamifaka:/usr/src/app/public  -p 9200:8000 baiyuetribe/kamifaka:latest</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">    <span class=\"attr\">kamifaka:</span></span><br><span class=\"line\">        <span class=\"attr\">container_name:</span> <span class=\"string\">kmfaka</span></span><br><span class=\"line\">        <span class=\"attr\">stdin_open:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"attr\">tty:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"attr\">volumes:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"string\">./:/usr/src/app/public</span></span><br><span class=\"line\">        <span class=\"attr\">ports:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"number\">4445</span><span class=\"string\">:8000</span></span><br><span class=\"line\">        <span class=\"attr\">image:</span> <span class=\"string\">baiyuetribe/kamifaka:latest</span></span><br><span class=\"line\">        <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br></pre></td></tr></table></figure>\n\n<hr>\n<p>åå°åœ°å€ipåœ°å€:9200&#x2F;adminã€‚é»˜è®¤ç®¡ç†å‘˜è´¦å·<a href=\"mailto:&#x61;&#x64;&#109;&#105;&#110;&#64;&#x71;&#113;&#46;&#x63;&#x6f;&#109;\">&#x61;&#x64;&#109;&#105;&#110;&#64;&#x71;&#113;&#46;&#x63;&#x6f;&#109;</a>ï¼Œå¯†ç ï¼š123456ã€‚</p>\n<p>Reference</p>\n<p><a href=\"https://www.youtube.com/watch?v=UF24A3h2x3I\">NASç”¨dockeréƒ¨ç½²ä½°é˜…å‘å¡å¡å¯†å‘å¡ç³»ç»Ÿkamifaka</a></p>\n<p><a href=\"http://dacongyun.com/archives/635595.html\">çƒæ¨èä¸€ä¸ªå‘å¡ç¨‹åºï¼Œé™¤äº†ç‹¬è§’é£é“ƒè”æ</a></p>","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"docker","path":"api/tags/docker.json"},{"name":"NPM","path":"api/tags/NPM.json"},{"name":"debian","path":"api/tags/debian.json"},{"name":"docker-compose","path":"api/tags/docker-compose.json"},{"name":"å®¶å®½","path":"api/tags/å®¶å®½.json"},{"name":"è‡ªåŠ¨å”®è´§ç³»ç»Ÿ","path":"api/tags/è‡ªåŠ¨å”®è´§ç³»ç»Ÿ.json"},{"name":"ç‹¬è§’æ•°å¡","path":"api/tags/ç‹¬è§’æ•°å¡.json"}]}